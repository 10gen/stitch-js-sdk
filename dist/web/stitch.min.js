!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("stitch",[],t):"object"==typeof exports?exports.stitch=t():e.stitch=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=16)}([function(e,t,n){"use strict";function r(e,t){var n=t.serviceName,r=void 0===n?e.serviceName:n,i=t.action,o=t.args,s=e.client;if(!s)throw new Error("Service has no client");return s.executeServiceFunction(r,i,o)}function i(e){return encodeURIComponent(s.btoa(JSON.stringify(e)))}Object.defineProperty(t,"__esModule",{value:!0}),t.uriEncodeObject=t.serviceResponse=void 0;var o=n(13),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o);t.serviceResponse=r,t.uriEncodeObject=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.USER_AUTH_KEY="_stitch_ua",t.REFRESH_TOKEN_KEY="_stitch_rt",t.DEVICE_ID_KEY="_stitch_did",t.STATE_KEY="_stitch_state",t.USER_AUTH_COOKIE_NAME="stitch_ua",t.STITCH_ERROR_KEY="_stitch_error",t.STITCH_LINK_KEY="_stitch_link",t.USER_LOGGED_IN_PT_KEY="_stitch_pt",t.STITCH_REDIRECT_PROVIDER="_stitch_rp",t.DEFAULT_ACCESS_TOKEN_EXPIRE_WITHIN_SECS=10,t.APP_CLIENT_CODEC={accessToken:"access_token",refreshToken:"refresh_token",deviceId:"device_id",userId:"user_id"},t.ADMIN_CLIENT_CODEC={accessToken:"access_token",refreshToken:"refresh_token",deviceId:"device_id",userId:"user_id"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeFetchArgs=t.checkStatus=t.SDK_VERSION=t.DEFAULT_STITCH_SERVER_URL=t.ADMIN_CLIENT_TYPE=t.APP_CLIENT_TYPE=t.JSONTYPE=void 0;var r=n(3),i=t.JSONTYPE="application/json",o=(t.APP_CLIENT_TYPE="app",t.ADMIN_CLIENT_TYPE="admin",t.DEFAULT_STITCH_SERVER_URL="https://stitch.mongodb.com","unknown");o="3.10.0";t.SDK_VERSION=o,t.checkStatus=function(e){if(e.status>=200&&e.status<300)return e;if(e.headers.get("Content-Type")===i)return e.json().then(function(t){var n=new r.StitchError(t.error,t.error_code);return n.response=e,n.json=t,Promise.reject(n)});var t=new Error(e.statusText);return t.response=e,Promise.reject(t)},t.makeFetchArgs=function(e,t,n){var r={method:e,headers:{Accept:i,"Content-Type":i}};return n&&n.credentials&&(r.credentials=n.credentials),t&&(r.body=t),r.cors=!0,r}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this),this.message=e,this.name=this.constructor.name,void 0!==t&&(this.code=t)};s.prototype=Object.create(Error.prototype);var u=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),t}(s);t.StitchError=u,t.ErrAuthProviderNotFound="AuthProviderNotFound",t.ErrInvalidSession="InvalidSession",t.ErrUnauthorized="Unauthorized"},function(e,t,n){"use strict";(function(e){function r(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=o.prototype):(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,n){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return s(this,e,t,n)}function s(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?h(e,t,n,r):"string"==typeof t?c(e,t,n):p(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function a(e,t,n,r){return u(t),t<=0?i(e,t):void 0!==n?"string"==typeof r?i(e,t).fill(n,r):i(e,t).fill(n):i(e,t)}function f(e,t){if(u(t),e=i(e,t<0?0:0|d(t)),!o.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function c(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!o.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|g(t,n);e=i(e,r);var s=e.write(t,n);return s!==r&&(e=e.slice(0,s)),e}function l(e,t){var n=t.length<0?0:0|d(t.length);e=i(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function h(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),o.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=o.prototype):e=l(e,t),e}function p(e,t){if(o.isBuffer(t)){var n=0|d(t.length);return e=i(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||H(t.length)?i(e,0):l(e,t);if("Buffer"===t.type&&Z(t.data))return l(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function d(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function _(e){return+e!=e&&(e=0),o.alloc(+e)}function g(e,t){if(o.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return J(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return X(e).length;default:if(r)return J(e).length;t=(""+t).toLowerCase(),r=!0}}function y(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,n);case"utf8":case"utf-8":return B(this,t,n);case"ascii":return P(this,t,n);case"latin1":case"binary":return D(this,t,n);case"base64":return w(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function b(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,i);if("number"==typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,r,i){function o(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}var s=1,u=e.length,a=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,u/=2,a/=2,n/=2}var f;if(i){var c=-1;for(f=n;f<u;f++)if(o(e,f)===o(t,-1===c?0:f-c)){if(-1===c&&(c=f),f-c+1===a)return c*s}else-1!==c&&(f-=f-c),c=-1}else for(n+a>u&&(n=u-a),f=n;f>=0;f--){for(var l=!0,h=0;h<a;h++)if(o(e,f+h)!==o(t,h)){l=!1;break}if(l)return f}return-1}function S(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var u=parseInt(t.substr(2*s,2),16);if(isNaN(u))return s;e[n+s]=u}return s}function E(e,t,n,r){return q(J(t,e.length-n),e,n,r)}function O(e,t,n,r){return q(K(t),e,n,r)}function N(e,t,n,r){return O(e,t,n,r)}function A(e,t,n,r){return q(X(t),e,n,r)}function T(e,t,n,r){return q(V(t,e.length-n),e,n,r)}function w(e,t,n){return 0===t&&n===e.length?G.fromByteArray(e):G.fromByteArray(e.slice(t,n))}function B(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o=e[i],s=null,u=o>239?4:o>223?3:o>191?2:1;if(i+u<=n){var a,f,c,l;switch(u){case 1:o<128&&(s=o);break;case 2:a=e[i+1],128==(192&a)&&(l=(31&o)<<6|63&a)>127&&(s=l);break;case 3:a=e[i+1],f=e[i+2],128==(192&a)&&128==(192&f)&&(l=(15&o)<<12|(63&a)<<6|63&f)>2047&&(l<55296||l>57343)&&(s=l);break;case 4:a=e[i+1],f=e[i+2],c=e[i+3],128==(192&a)&&128==(192&f)&&128==(192&c)&&(l=(15&o)<<18|(63&a)<<12|(63&f)<<6|63&c)>65535&&l<1114112&&(s=l)}}null===s?(s=65533,u=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),i+=u}return I(r)}function I(e){var t=e.length;if(t<=Q)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Q));return n}function P(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function D(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function R(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=F(e[o]);return i}function x(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function $(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function C(e,t,n,r,i,s){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function k(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function U(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function j(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function M(e,t,n,r,i){return i||j(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),W.write(e,t,n,r,23,4),n+4}function L(e,t,n,r,i){return i||j(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),W.write(e,t,n,r,52,8),n+8}function Y(e){if(e=z(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function z(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function J(e,t){t=t||1/0;for(var n,r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function K(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function V(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function X(e){return G.toByteArray(Y(e))}function q(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function H(e){return e!==e}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var G=n(25),W=n(30),Z=n(31);t.Buffer=o,t.SlowBuffer=_,t.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=r(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,n){return s(null,e,t,n)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,n){return a(null,e,t,n)},o.allocUnsafe=function(e){return f(null,e)},o.allocUnsafeSlow=function(e){return f(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,s=Math.min(n,r);i<s;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Z(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=o.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},o.byteLength=g,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)b(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?B(this,0,e):y.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,n,r,i){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var s=i-r,u=n-t,a=Math.min(s,u),f=this.slice(r,i),c=e.slice(t,n),l=0;l<a;++l)if(f[l]!==c[l]){s=f[l],u=c[l];break}return s<u?-1:u<s?1:0},o.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},o.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},o.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},o.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return S(this,e,t,n);case"utf8":case"utf-8":return E(this,e,t,n);case"ascii":return O(this,e,t,n);case"latin1":case"binary":return N(this,e,t,n);case"base64":return A(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Q=4096;o.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r;if(o.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=o.prototype;else{var i=t-e;r=new o(i,void 0);for(var s=0;s<i;++s)r[s]=this[s+e]}return r},o.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||$(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},o.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||$(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},o.prototype.readUInt8=function(e,t){return t||$(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||$(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||$(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||$(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||$(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||$(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},o.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||$(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||$(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||$(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(e,t){t||$(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(e,t){return t||$(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||$(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||$(e,4,this.length),W.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||$(e,4,this.length),W.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||$(e,8,this.length),W.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||$(e,8,this.length),W.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){C(this,e,t,n,Math.pow(2,8*n)-1,0)}var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},o.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){C(this,e,t,n,Math.pow(2,8*n)-1,0)}var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},o.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):k(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):k(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):U(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);C(this,e,t,n,i-1,-i)}var o=0,s=1,u=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===u&&0!==this[t+o-1]&&(u=1),this[t+o]=(e/s>>0)-u&255;return t+n},o.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);C(this,e,t,n,i-1,-i)}var o=n-1,s=1,u=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===u&&0!==this[t+o+1]&&(u=1),this[t+o]=(e/s>>0)-u&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):k(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):k(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):U(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||C(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,n){return M(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return M(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,s=r-n;if(this===e&&n<t&&t<r)for(i=s-1;i>=0;--i)e[i+t]=this[i+n];else if(s<1e3||!o.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+s),t);return s},o.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var s;if("number"==typeof e)for(s=t;s<n;++s)this[s]=e;else{var u=o.isBuffer(e)?e:J(new o(e,r).toString()),a=u.length;for(s=0;s<n-t;++s)this[s+t]=u[s%a]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,n(11))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){var n,r,o,s,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},f=Object.create(e),l=d.DEFAULT_STITCH_SERVER_URL;u.baseUrl&&(l=u.baseUrl),f.clientAppID=t,f.authUrl=t?l+"/api/client/v2.0/app/"+t+"/auth":l+"/api/admin/v3.0/auth",f.rootURLsByAPIVersion=(s={},i(s,m.v1,(n={},i(n,m.API_TYPE_PUBLIC,l+"/api/public/v1.0"),i(n,m.API_TYPE_CLIENT,l+"/api/client/v1.0"),i(n,m.API_TYPE_PRIVATE,l+"/api/private/v1.0"),i(n,m.API_TYPE_APP,t?l+"/api/client/v1.0/app/"+t:l+"/api/public/v1.0"),n)),i(s,m.v2,(r={},i(r,m.API_TYPE_PUBLIC,l+"/api/public/v2.0"),i(r,m.API_TYPE_CLIENT,l+"/api/client/v2.0"),i(r,m.API_TYPE_PRIVATE,l+"/api/private/v2.0"),i(r,m.API_TYPE_APP,t?l+"/api/client/v2.0/app/"+t:l+"/api/public/v2.0"),r)),i(s,m.v3,(o={},i(o,m.API_TYPE_PUBLIC,l+"/api/public/v3.0"),i(o,m.API_TYPE_CLIENT,l+"/api/client/v3.0"),i(o,m.API_TYPE_APP,t?l+"/api/client/v3.0/app/"+t:l+"/api/admin/v3.0"),o)),s);var h={codec:c.APP_CLIENT_CODEC,storage:u.storage};return u.storageType&&(h.storageType=u.storageType),u.platform&&(h.platform=u.platform),u.authCodec&&(h.codec=u.authCodec),u.requestOrigin&&(h.requestOrigin=u.requestOrigin),a.AuthFactory.create(f,f.authUrl,h).then(function(e){return f.auth=e,Promise.all([f.auth.handleRedirect(),f.auth.handleCookie()])}).then(function(){return f})}Object.defineProperty(t,"__esModule",{value:!0}),t.StitchClient=t.StitchClientFactory=t.fetcher=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.newStitchClient=s;var a=n(14),f=n(8),c=n(1),l=n(20),h=r(l),p=n(2),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(p),_=n(6),g=r(_),y=n(37),b=r(y),v=n(3),m=n(9),S=t.fetcher=function(){return"undefined"==typeof fetch?n(10):fetch},E=(t.StitchClientFactory=function(){function e(){throw o(this,e),new v.StitchError("StitchClient can only be made from the StitchClientFactory.create function")}return u(e,null,[{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s(E.prototype,e,t)}}]),e}(),t.StitchClient=function(){function e(){o(this,e);var t=this.constructor.name;throw new v.StitchError(t+" can only be made from the "+t+"Factory.create function")}return u(e,[{key:"login",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return void 0===e||void 0===t?this.authenticate(f.PROVIDER_TYPE_ANON,n):this.authenticate("userpass",Object.assign({username:e,password:t},n))}},{key:"register",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.auth.provider("userpass").register(e,t,n)}},{key:"linkWithProvider",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isAuthenticated())throw new v.StitchError("Must be authenticated to link an account");return this.auth.provider(e).authenticate(n,!0).then(function(){return t.authedId()})}},{key:"authenticate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=function(){return t.auth.provider(e).authenticate(n).then(function(){return t.authedId()})};return this.isAuthenticated()?e===f.PROVIDER_TYPE_ANON&&this.auth.getLoggedInProviderType()===f.PROVIDER_TYPE_ANON?Promise.resolve(this.auth.authedId):this.logout().then(function(){return r()}):r()}},{key:"logout",value:function(){var e=this;return this._do("/auth/session","DELETE",{refreshOnFailure:!1,useRefreshToken:!0,rootURL:this.rootURLsByAPIVersion[m.v2][m.API_TYPE_CLIENT]}).then(function(){return e.auth.clear()},function(){return e.auth.clear()})}},{key:"authError",value:function(){return this.auth.error()}},{key:"userProfile",value:function(){return this._do("/auth/profile","GET",{rootURL:this.rootURLsByAPIVersion[m.v2][m.API_TYPE_CLIENT]}).then(function(e){return e.json()})}},{key:"isAuthenticated",value:function(){return!!this.authedId()}},{key:"authedId",value:function(){return this.auth.authedId}},{key:"service",value:function(t,n){if(this.constructor!==e)throw new v.StitchError("`service` is a factory method, do not use `new`");if(!h.default.hasOwnProperty(t))throw new v.StitchError("Invalid service type specified: "+t);return new(0,h.default[t])(this,n)}},{key:"executeFunction",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this._doFunctionCall({name:e,arguments:n})}},{key:"executeServiceFunction",value:function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._doFunctionCall({service:e,name:t,arguments:r})}},{key:"_doFunctionCall",value:function(e){var t=function(e){return g.default.parse(e,{relaxed:!0})};return this._do("/functions/call","POST",{body:function(e){return g.default.stringify(e,{strict:!0})}(e)}).then(function(e){return e.text()}).then(function(e){return t(e)})}},{key:"doSessionPost",value:function(){return this._do("/auth/session","POST",{refreshOnFailure:!1,useRefreshToken:!0,rootURL:this.rootURLsByAPIVersion[m.v2][m.API_TYPE_CLIENT]}).then(function(e){return e.json()})}},{key:"getApiKeys",value:function(){return this._do("/auth/api_keys","GET",{rootURL:this.rootURLsByAPIVersion[m.v2][m.API_TYPE_CLIENT],useRefreshToken:!0}).then(function(e){return e.json()})}},{key:"createApiKey",value:function(e){return this._do("/auth/api_keys","POST",{rootURL:this.rootURLsByAPIVersion[m.v2][m.API_TYPE_CLIENT],useRefreshToken:!0,body:JSON.stringify({name:e})}).then(function(e){return e.json()})}},{key:"getApiKeyByID",value:function(e){return this._do("/auth/api_keys/"+e,"GET",{rootURL:this.rootURLsByAPIVersion[m.v2][m.API_TYPE_CLIENT],useRefreshToken:!0}).then(function(e){return e.json()})}},{key:"deleteApiKeyByID",value:function(e){return this._do("/auth/api_keys/"+e,"DELETE",{rootURL:this.rootURLsByAPIVersion[m.v2][m.API_TYPE_CLIENT],useRefreshToken:!0})}},{key:"enableApiKeyByID",value:function(e){return this._do("/auth/api_keys/"+e+"/enable","PUT",{rootURL:this.rootURLsByAPIVersion[m.v2][m.API_TYPE_CLIENT],useRefreshToken:!0})}},{key:"disableApiKeyByID",value:function(e){return this._do("/auth/api_keys/"+e+"/disable","PUT",{rootURL:this.rootURLsByAPIVersion[m.v2][m.API_TYPE_CLIENT],useRefreshToken:!0})}},{key:"_fetch",value:function(e,t,n,r,i){var o=this;return S()(e,t).then(function(e){if(e.status>=200&&e.status<300)return Promise.resolve(e);if(e.headers.get("Content-Type")===d.JSONTYPE)return e.json().then(function(t){if("error_code"in t&&t.error_code===v.ErrInvalidSession)return i.refreshOnFailure?o.auth.refreshToken().then(function(){return i.refreshOnFailure=!1,o._do(n,r,i)}):o.auth.clear().then(function(){var n=new v.StitchError(t.error,t.error_code);throw n.response=e,n.json=t,n});var s=new v.StitchError(t.error,t.error_code);return s.response=e,s.json=t,Promise.reject(s)});var t=new Error(e.statusText);return t.response=e,Promise.reject(t)})}},{key:"_fetchArgs",value:function(e,t,n){var r=this.rootURLsByAPIVersion[n.apiVersion][n.apiType],i=""+r+e;n.rootURL&&(i=""+n.rootURL+e);var o=d.makeFetchArgs(t,n.body,n);return n.headers&&Object.assign(o.headers,n.headers),n.queryParams&&(i=i+"?"+b.default.stringify(n.queryParams)),n.multipart&&delete o.headers["Content-Type"],{url:i,fetchArgs:o}}},{key:"_do",value:function(e,t,n){n=Object.assign({},{refreshOnFailure:!0,useRefreshToken:!1,apiVersion:m.v2,apiType:m.API_TYPE_APP,rootURL:void 0},n);var r=this._fetchArgs(e,t,n),i=r.url,o=r.fetchArgs;if(n.noAuth)return this._fetch(i,o,e,t,n);if(!this.isAuthenticated())return Promise.reject(new v.StitchError("Must auth first",v.ErrUnauthorized));this.auth.requestOrigin&&(o.headers["X-STITCH-Request-Origin"]=this.auth.requestOrigin);var s=n.useRefreshToken?this.auth.getRefreshToken():this.auth.getAccessToken();return o.headers.Authorization="Bearer "+s,this._fetch(i,o,e,t,n)}},{key:"type",get:function(){return d.APP_CLIENT_TYPE}}]),e}())},function(e,t,n){"use strict";(function(r){var i,o,s,u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(r,a){"object"===u(t)&&void 0!==e?e.exports=a(n(7)):(o=[n(7)],i=a,void 0!==(s="function"==typeof i?i.apply(t,o):i)&&(e.exports=s))}(0,function(e){function t(e){var t=Number(e).toString(16);return 1===t.length?"0"+t:t}function n(e){return{$binary:{base64:r.isBuffer(e.buffer)?e.buffer.toString("base64"):r.from(e.buffer).toString("base64"),subType:t(e.sub_type)}}}function i(e,t){var n=t.$binary.subType?parseInt(t.$binary.subType,16):0,i=new r(t.$binary.base64,"base64");return new e.Binary(i,n)}function o(e){return e.scope?{$code:e.code,$scope:e.scope}:{$code:e.code}}function s(e,t){return new e.Code(t.$code,t.$scope)}function a(e){var t={$ref:e.collection,$id:e.oid};return e.db&&(t.$db=e.db),t=Object.assign(t,e.fields)}function f(e,t){var n=Object.assign({},t);return["$ref","$id","$db"].forEach(function(e){return delete n[e]}),new e.DBRef(t.$ref,t.$id,t.$db,n)}function c(e){return{$numberDecimal:e.toString()}}function l(e,t){return new e.Decimal128.fromString(t.$numberDecimal)}function h(e,t){return t&&t.relaxed&&isFinite(e.value)?e.value:{$numberDouble:e.value.toString()}}function p(e,t,n){return n&&n.relaxed?parseFloat(t.$numberDouble):new e.Double(parseFloat(t.$numberDouble))}function d(e,t){return t&&t.relaxed?e.value:{$numberInt:e.value.toString()}}function _(e,t,n){return n&&n.relaxed?parseInt(t.$numberInt,10):new e.Int32(t.$numberInt)}function g(e,t){return t&&t.relaxed?e.toNumber():{$numberLong:e.toString()}}function y(e,t,n){var r=e.Long.fromString(t.$numberLong);return n&&n.relaxed?r.toNumber():r}function b(){return{$maxKey:1}}function v(e){return new e.MaxKey}function m(){return{$minKey:1}}function S(e){return new e.MinKey}function E(e){return e.toHexString?{$oid:e.toHexString()}:{$oid:e.toString("hex")}}function O(e,t){return new e.ObjectID(t.$oid)}function N(e){return{$regularExpression:{pattern:e.pattern,options:e.options}}}function A(e,t){return new e.BSONRegExp(t.$regularExpression.pattern,t.$regularExpression.options.split("").sort().join(""))}function T(e){return{$symbol:e.value}}function w(e,t){return new e.Symbol(t.$symbol)}function B(e){return{$timestamp:{t:e.high_,i:e.low_}}}function I(e,t){return new e.Timestamp(t.$timestamp.i,t.$timestamp.t)}function P(e){Z.forEach(function(t){if(!e[t])throw new Error("passed in module does not contain all BSON types required")}),W=e}function D(e,t,n,r){if("number"==typeof n){if(Math.floor(n)===n){var i=n>=ne&&n<=te,o=n>=ie&&n<=re;if(i)return r.strict?new W.Int32(n):n;if(o)return r.strict?new W.Long.fromNumber(n):n}return new W.Double(n)}if(null==n||"object"!==(void 0===n?"undefined":G(n)))return n;if(n.$undefined)return null;for(var s=Object.keys(n).filter(function(e){return e.startsWith("$")&&null!=n[e]}),u=0;u<s.length;u++){var a=Q[s[u]];if(a)return a.fromExtendedJSON(W,n,r)}if(null!=n.$date){var f=n.$date,c=new Date;return"string"==typeof f?c.setTime(Date.parse(f)):f instanceof W.Long?c.setTime(f.toNumber()):"number"==typeof f&&r.relaxed&&c.setTime(f),c}if(null!=n.$code){if(n.$scope)var l=D(e,null,n.$scope);return Object.assign({},n).$scope=l,H.Code.fromExtendedJSON(W,n)}if(null!=n.$ref||null!=n.$dbPointer){var h=n.$ref?n:n.$dbPointer;if(h instanceof W.DBRef)return h;var p=Object.keys(h).filter(function(e){return e.startsWith("$")}),d=!0;if(p.forEach(function(e){-1===["$ref","$id","$db"].indexOf(e)&&(d=!1)}),d)return H.DBRef.fromExtendedJSON(W,h)}return n}function R(e,t){return e.map(function(e){return $(e,t)})}function x(e){var t=e.toISOString();return 0!==e.getUTCMilliseconds()?t:t.slice(0,-5)+"Z"}function $(e,t){if(Array.isArray(e))return R(e,t);if(void 0===e)return null;if(e instanceof Date){var n=e.getTime(),r=n>-1&&n<2534023188e5;return t.relaxed&&r?{$date:x(e)}:{$date:{$numberLong:e.getTime().toString()}}}if("number"==typeof e&&!t.relaxed){if(Math.floor(e)===e){var i=e>=ne&&e<=te,o=e>=ie&&e<=re;if(i)return{$numberInt:e.toString()};if(o)return{$numberLong:e.toString()}}return{$numberDouble:e.toString()}}return null!=e&&"object"===(void 0===e?"undefined":G(e))?C(e,t):e}function C(e,t){if(null==e||"object"!==(void 0===e?"undefined":G(e)))throw new Error("not an object instance");if(e._bsontype&&-1!==Z.indexOf(e._bsontype)){if("Code"===e._bsontype&&e.scope){var n=C(e.scope,t),r=Object.assign({},e,{scope:n});return H.Code.toExtendedJSON(r,t)}if("DBRef"===e._bsontype&&e.oid){var i=C(e.oid,t),o=Object.assign({},e,{oid:i});return H.DBRef.toExtendedJSON(o,t)}return H[e._bsontype].toExtendedJSON(e,t)}var s={};for(var u in e){var a=e[u];if(Array.isArray(a))s[u]=R(a,t);else if(null!=a&&a._bsontype&&-1!==Z.indexOf(a._bsontype))if("Code"===a._bsontype&&a.scope){var f=C(a.scope,t),c=Object.assign({},a,{scope:f});s[u]=H.Code.toExtendedJSON(c,t)}else if("DBRef"===a._bsontype&&a.oid){var l=C(a.oid,t),h=Object.assign({},a,{oid:l});s[u]=H.DBRef.toExtendedJSON(h,t)}else s[u]=H[a._bsontype].toExtendedJSON(a,t);else a instanceof Date?s[u]=$(a,t):null!=a&&"object"===(void 0===a?"undefined":G(a))&&(s[u]=C(a,t));if(s[u]=$(a,t),a instanceof RegExp){var p=a.flags;void 0===p&&(p=a.toString().match(/[gimuy]*$/)[0]),s[u]=H.BSONRegExp.toExtendedJSON({pattern:a.source,options:p})}}return s}e=e&&e.hasOwnProperty("default")?e.default:e;var k={toExtendedJSON:n,fromExtendedJSON:i},U={toExtendedJSON:o,fromExtendedJSON:s},j={toExtendedJSON:a,fromExtendedJSON:f},M={toExtendedJSON:c,fromExtendedJSON:l},L={toExtendedJSON:h,fromExtendedJSON:p},Y={toExtendedJSON:d,fromExtendedJSON:_},z={toExtendedJSON:g,fromExtendedJSON:y},F={toExtendedJSON:b,fromExtendedJSON:v},J={toExtendedJSON:m,fromExtendedJSON:S},K={toExtendedJSON:E,fromExtendedJSON:O},V={toExtendedJSON:N,fromExtendedJSON:A},X={toExtendedJSON:T,fromExtendedJSON:w},q={toExtendedJSON:B,fromExtendedJSON:I},H={Binary:k,Code:U,DBRef:j,Decimal128:M,Double:L,Int32:Y,Long:z,MaxKey:F,MinKey:J,ObjectID:K,BSONRegExp:V,Symbol:X,Timestamp:q},G="function"==typeof Symbol&&"symbol"===u(Symbol.iterator)?function(e){return void 0===e?"undefined":u(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":u(e)},W=e,Z=["Binary","Code","DBRef","Decimal128","Double","Int32","Long","MaxKey","MinKey","ObjectID","BSONRegExp","Symbol","Timestamp"];P(W);var Q={$oid:H.ObjectID,$binary:H.Binary,$symbol:H.Symbol,$numberInt:H.Int32,$numberDecimal:H.Decimal128,$numberDouble:H.Double,$numberLong:H.Long,$minKey:H.MinKey,$maxKey:H.MaxKey,$regularExpression:H.BSONRegExp,$timestamp:H.Timestamp},ee=function(e,t){var n=this;return t=t||{relaxed:!1},"boolean"==typeof t.relaxed&&(t.strict=!t.relaxed),"boolean"==typeof t.strict&&(t.relaxed=!t.strict),JSON.parse(e,function(e,r){return D(n,e,r,t)})},te=2147483647,ne=-2147483648,re=0x8000000000000000,ie=-0x8000000000000000;return{parse:ee,stringify:function(e,t,n,r){var i={};null!=r&&"object"===(void 0===r?"undefined":G(r))?i=r:null!=n&&"object"===(void 0===n?"undefined":G(n))?(i=n,n=0):null!=t&&"object"===(void 0===t?"undefined":G(t))&&(i=t,t=null);var o=Array.isArray(e)?R(e,i):C(e,i);return JSON.stringify(o,t,n)},setBSONModule:P,BSON:W}})}).call(t,n(4).Buffer)},function(module,exports,__webpack_require__){"use strict";(function(global,Buffer){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function createCommonjsModule(e,t){return t={exports:{}},e(t,t.exports),t.exports}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return void 0===e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof2(e)})(e)}function _classCallCheck$1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$1(e,t,n){return t&&_defineProperties$1(e.prototype,t),n&&_defineProperties$1(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function normalizedFunctionString(e){return e.toString().replace("function(","function (")}function insecureRandomBytes(e){for(var t=new Uint8Array(e),n=0;n<e;++n)t[n]=Math.floor(256*Math.random());return t}function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function nextTick(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)}function Item(e,t){this.fun=e,this.array=t}function noop(){}function binding(e){throw new Error("process.binding is not supported")}function cwd(){return"/"}function chdir(e){throw new Error("process.chdir is not supported")}function umask(){return 0}function hrtime(e){var t=.001*performanceNow.call(performance),n=Math.floor(t),r=Math.floor(t%1*1e9);return e&&(n-=e[0],(r-=e[1])<0&&(n--,r+=1e9)),[n,r]}function uptime(){return(new Date-startTime)/1e3}function _typeof$1(e){return(_typeof$1="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return void 0===e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof2(e)})(e)}function format(e){if(!isString(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(inspect(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,i=r.length,o=String(e).replace(formatRegExp,function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),s=r[n];n<i;s=r[++n])isNull(s)||!isObject(s)?o+=" "+s:o+=" "+inspect(s);return o}function deprecate(e,t){function n(){return r||(console.error(t),r=!0),e.apply(this,arguments)}if(isUndefined(global.process))return function(){return deprecate(e,t).apply(this,arguments)};var r=!1;return n}function debuglog(e){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!debugs[e])if(new RegExp("\\b"+e+"\\b","i").test(debugEnviron)){debugs[e]=function(){var t=format.apply(null,arguments);console.error("%s %d: %s",e,0,t)}}else debugs[e]=function(){};return debugs[e]}function inspect(e,t){var n={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),isBoolean(t)?n.showHidden=t:t&&_extend(n,t),isUndefined(n.showHidden)&&(n.showHidden=!1),isUndefined(n.depth)&&(n.depth=2),isUndefined(n.colors)&&(n.colors=!1),isUndefined(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=stylizeWithColor),formatValue(n,e,n.depth)}function stylizeWithColor(e,t){var n=inspect.styles[t];return n?"["+inspect.colors[n][0]+"m"+e+"["+inspect.colors[n][1]+"m":e}function stylizeNoColor(e,t){return e}function arrayToHash(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function formatValue(e,t,n){if(e.customInspect&&t&&isFunction(t.inspect)&&t.inspect!==inspect&&(!t.constructor||t.constructor.prototype!==t)){var r=t.inspect(n,e);return isString(r)||(r=formatValue(e,r,n)),r}var i=formatPrimitive(e,t);if(i)return i;var o=Object.keys(t),s=arrayToHash(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),isError(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return formatError(t);if(0===o.length){if(isFunction(t)){var u=t.name?": "+t.name:"";return e.stylize("[Function"+u+"]","special")}if(isRegExp(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(isDate(t))return e.stylize(Date.prototype.toString.call(t),"date");if(isError(t))return formatError(t)}var a="",f=!1,c=["{","}"];if(isArray(t)&&(f=!0,c=["[","]"]),isFunction(t)){a=" [Function"+(t.name?": "+t.name:"")+"]"}if(isRegExp(t)&&(a=" "+RegExp.prototype.toString.call(t)),isDate(t)&&(a=" "+Date.prototype.toUTCString.call(t)),isError(t)&&(a=" "+formatError(t)),0===o.length&&(!f||0==t.length))return c[0]+a+c[1];if(n<0)return isRegExp(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var l;return l=f?formatArray(e,t,n,s,o):o.map(function(r){return formatProperty(e,t,n,s,r,f)}),e.seen.pop(),reduceToSingleString(l,a,c)}function formatPrimitive(e,t){if(isUndefined(t))return e.stylize("undefined","undefined");if(isString(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return isNumber(t)?e.stylize(""+t,"number"):isBoolean(t)?e.stylize(""+t,"boolean"):isNull(t)?e.stylize("null","null"):void 0}function formatError(e){return"["+Error.prototype.toString.call(e)+"]"}function formatArray(e,t,n,r,i){for(var o=[],s=0,u=t.length;s<u;++s)hasOwnProperty(t,String(s))?o.push(formatProperty(e,t,n,r,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(formatProperty(e,t,n,r,i,!0))}),o}function formatProperty(e,t,n,r,i,o){var s,u,a;if(a=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},a.get?u=a.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):a.set&&(u=e.stylize("[Setter]","special")),hasOwnProperty(r,i)||(s="["+i+"]"),u||(e.seen.indexOf(a.value)<0?(u=isNull(n)?formatValue(e,a.value,null):formatValue(e,a.value,n-1),u.indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n"))):u=e.stylize("[Circular]","special")),isUndefined(s)){if(o&&i.match(/^\d+$/))return u;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function reduceToSingleString(e,t,n){return e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function isArray(e){return Array.isArray(e)}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNullOrUndefined(e){return null==e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isSymbol(e){return"symbol"===_typeof$1(e)}function isUndefined(e){return void 0===e}function isRegExp(e){return isObject(e)&&"[object RegExp]"===objectToString(e)}function isObject(e){return"object"===_typeof$1(e)&&null!==e}function isDate(e){return isObject(e)&&"[object Date]"===objectToString(e)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(e){return"function"==typeof e}function isPrimitive(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"===_typeof$1(e)||void 0===e}function isBuffer(e){return Buffer.isBuffer(e)}function objectToString(e){return Object.prototype.toString.call(e)}function pad(e){return e<10?"0"+e.toString(10):e.toString(10)}function timestamp$1(){var e=new Date,t=[pad(e.getHours()),pad(e.getMinutes()),pad(e.getSeconds())].join(":");return[e.getDate(),months[e.getMonth()],t].join(" ")}function log(){console.log("%s - %s",timestamp$1(),format.apply(null,arguments))}function _extend(e,t){if(!t||!isObject(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}function hasOwnProperty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function _classCallCheck$2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$2(e,t,n){return t&&_defineProperties$2(e.prototype,t),n&&_defineProperties$2(e,n),e}function convertToHex(e){return e.toString("hex")}function makeObjectIdError(e,t){var n=e[t];return new TypeError('ObjectId string "'.concat(e,'" contains invalid character "').concat(n,'" with character code (').concat(e.charCodeAt(t),"). All character codes for a non-hex string must be less than 256."))}function _classCallCheck$3(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$3(e,t,n){return t&&_defineProperties$3(e.prototype,t),n&&_defineProperties$3(e,n),e}function alphabetize(e){return e.split("").sort().join("")}function _classCallCheck$4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$4(e,t,n){return t&&_defineProperties$4(e.prototype,t),n&&_defineProperties$4(e,n),e}function _classCallCheck$5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$5(e,t,n){return t&&_defineProperties$5(e.prototype,t),n&&_defineProperties$5(e,n),e}function _classCallCheck$6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$6(e,t,n){return t&&_defineProperties$6(e.prototype,t),n&&_defineProperties$6(e,n),e}function isDigit(e){return!isNaN(parseInt(e,10))}function divideu128(e){var t=long_1.fromNumber(1e9),n=long_1.fromNumber(0);if(!(e.parts[0]||e.parts[1]||e.parts[2]||e.parts[3]))return{quotient:e,rem:n};for(var r=0;r<=3;r++)n=n.shiftLeft(32),n=n.add(new long_1(e.parts[r],0)),e.parts[r]=n.div(t).low,n=n.modulo(t);return{quotient:e,rem:n}}function multiply64x2(e,t){if(!e&&!t)return{high:long_1.fromNumber(0),low:long_1.fromNumber(0)};var n=e.shiftRightUnsigned(32),r=new long_1(e.getLowBits(),0),i=t.shiftRightUnsigned(32),o=new long_1(t.getLowBits(),0),s=n.multiply(i),u=n.multiply(o),a=r.multiply(i),f=r.multiply(o);return s=s.add(u.shiftRightUnsigned(32)),u=new long_1(u.getLowBits(),0).add(a).add(f.shiftRightUnsigned(32)),s=s.add(u.shiftRightUnsigned(32)),f=u.shiftLeft(32).add(new long_1(f.getLowBits(),0)),{high:s,low:f}}function lessThan(e,t){var n=e.high>>>0,r=t.high>>>0;if(n<r)return!0;if(n===r){if(e.low>>>0<t.low>>>0)return!0}return!1}function invalidErr(e,t){throw new TypeError('"'.concat(e,'" is not a valid Decimal128 string - ').concat(t))}function Decimal128(e){this.bytes=e}function _classCallCheck$7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$7(e,t,n){return t&&_defineProperties$7(e.prototype,t),n&&_defineProperties$7(e,n),e}function _classCallCheck$8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$8(e,t,n){return t&&_defineProperties$8(e.prototype,t),n&&_defineProperties$8(e,n),e}function _classCallCheck$9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$9(e,t,n){return t&&_defineProperties$9(e.prototype,t),n&&_defineProperties$9(e,n),e}function _classCallCheck$a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$a(e,t,n){return t&&_defineProperties$a(e.prototype,t),n&&_defineProperties$a(e,n),e}function isUint8Array(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)}function writeStringToArray(e){for(var t="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(e.length)):new Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function convertArraytoUtf8BinaryString(e,t,n){for(var r="",i=t;i<n;i++)r+=String.fromCharCode(e[i]);return r}function _typeof$2(e){return(_typeof$2="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return void 0===e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof2(e)})(e)}function deserializeValue(e,t,n,r){if("number"==typeof n){if(r.relaxed||r.legacy)return n;if(Math.floor(n)===n){if(n>=BSON_INT32_MIN&&n<=BSON_INT32_MAX)return new int_32(n);if(n>=BSON_INT64_MIN&&n<=BSON_INT64_MAX)return new long_1.fromNumber(n)}return new double_1(n)}if(null==n||"object"!==_typeof$2(n))return n;if(n.$undefined)return null;for(var i=Object.keys(n).filter(function(e){return e.startsWith("$")&&null!=n[e]}),o=0;o<i.length;o++){var s=keysToCodecs[i[o]];if(s)return s.fromExtendedJSON(n,r)}if(null!=n.$date){var u=n.$date,a=new Date;return r.legacy?"number"==typeof u?a.setTime(u):"string"==typeof u&&a.setTime(Date.parse(u)):"string"==typeof u?a.setTime(Date.parse(u)):long_1.isLong(u)?a.setTime(u.toNumber()):"number"==typeof u&&r.relaxed&&a.setTime(u),a}if(null!=n.$code){var f=Object.assign({},n);return n.$scope&&(f.$scope=deserializeValue(e,null,n.$scope)),code.fromExtendedJSON(n)}if(null!=n.$ref||null!=n.$dbPointer){var c=n.$ref?n:n.$dbPointer;if(c instanceof db_ref)return c;var l=Object.keys(c).filter(function(e){return e.startsWith("$")}),h=!0;if(l.forEach(function(e){-1===["$ref","$id","$db"].indexOf(e)&&(h=!1)}),h)return db_ref.fromExtendedJSON(c)}return n}function parse(e,t){var n=this;return t=Object.assign({},{relaxed:!0,legacy:!1},t),"boolean"==typeof t.relaxed&&(t.strict=!t.relaxed),"boolean"==typeof t.strict&&(t.relaxed=!t.strict),JSON.parse(e,function(e,r){return deserializeValue(n,e,r,t)})}function stringify(e,t,n,r){null!=n&&"object"===_typeof$2(n)&&(r=n,n=0),null==t||"object"!==_typeof$2(t)||Array.isArray(t)||(r=t,t=null,n=0),r=Object.assign({},{relaxed:!0,legacy:!1},r);var i=Array.isArray(e)?serializeArray(e,r):serializeDocument(e,r);return JSON.stringify(i,t,n)}function serialize(e,t){return t=t||{},JSON.parse(stringify(e,t))}function deserialize(e,t){return t=t||{},parse(JSON.stringify(e),t)}function serializeArray(e,t){return e.map(function(e){return serializeValue(e,t)})}function getISOString(e){var t=e.toISOString();return 0!==e.getUTCMilliseconds()?t:t.slice(0,-5)+"Z"}function serializeValue(e,t){if(Array.isArray(e))return serializeArray(e,t);if(void 0===e)return null;if(e instanceof Date){var n=e.getTime(),r=n>-1&&n<2534023188e5;return t.legacy?t.relaxed&&r?{$date:e.getTime()}:{$date:getISOString(e)}:t.relaxed&&r?{$date:getISOString(e)}:{$date:{$numberLong:e.getTime().toString()}}}if("number"==typeof e&&!t.relaxed){if(Math.floor(e)===e){var i=e>=BSON_INT32_MIN&&e<=BSON_INT32_MAX,o=e>=BSON_INT64_MIN&&e<=BSON_INT64_MAX;if(i)return{$numberInt:e.toString()};if(o)return{$numberLong:e.toString()}}return{$numberDouble:e.toString()}}if(e instanceof RegExp){var s=e.flags;void 0===s&&(s=e.toString().match(/[gimuy]*$/)[0]);return new regexp(e.source,s).toExtendedJSON(t)}return null!=e&&"object"===_typeof$2(e)?serializeDocument(e,t):e}function serializeDocument(e,t){if(null==e||"object"!==_typeof$2(e))throw new Error("not an object instance");var n=e._bsontype;if(void 0===n){var r={};for(var i in e)r[i]=serializeValue(e[i],t);return r}if("string"==typeof n){var o=e;if("function"!=typeof o.toExtendedJSON){var s=BSON_TYPE_MAPPINGS[n];if(!s)throw new TypeError("Unrecognized or invalid _bsontype: "+n);o=s(o)}return"Code"===n&&o.scope?o=new code(o.code,serializeValue(o.scope,t)):"DBRef"===n&&o.oid&&(o=new db_ref(o.collection,serializeValue(o.oid,t),o.db,o.fields)),o.toExtendedJSON(t)}throw new Error("_bsontype must be a string, but was: "+_typeof$2(n))}function validateUtf8(e,t,n){for(var r=0,i=t;i<n;i+=1){var o=e[i];if(r){if((o&FIRST_TWO_BITS)!==CONTINUING_CHAR)return!1;r-=1}else if(o&FIRST_BIT)if((o&FIRST_THREE_BITS)===TWO_BIT_CHAR)r=1;else if((o&FIRST_FOUR_BITS)===THREE_BIT_CHAR)r=2;else{if((o&FIRST_FIVE_BITS)!==FOUR_BIT_CHAR)return!1;r=3}}return!r}function deserialize$1(e,t,n){t=null==t?{}:t;var r=t&&t.index?t.index:0,i=e[r]|e[r+1]<<8|e[r+2]<<16|e[r+3]<<24;if(i<5)throw new Error("bson size must be >= 5, is ".concat(i));if(t.allowObjectSmallerThanBufferSize&&e.length<i)throw new Error("buffer length ".concat(e.length," must be >= bson size ").concat(i));if(!t.allowObjectSmallerThanBufferSize&&e.length!==i)throw new Error("buffer length ".concat(e.length," must === bson size ").concat(i));if(i+r>e.length)throw new Error("(bson size ".concat(i," + options.index ").concat(r," must be <= buffer length ").concat(Buffer$4.byteLength(e),")"));if(0!==e[r+i-1])throw new Error("One object, sized correctly, with a spot for an EOO, but the EOO isn't 0x00");return deserializeObject(e,r,t,n)}function deserializeObject(e,t,n,r){var i=null!=n.evalFunctions&&n.evalFunctions,o=null!=n.cacheFunctions&&n.cacheFunctions,s=null!=n.cacheFunctionsCrc32&&n.cacheFunctionsCrc32;if(!s)var u=null;var a=null==n.fieldsAsRaw?null:n.fieldsAsRaw,f=null!=n.raw&&n.raw,c="boolean"==typeof n.bsonRegExp&&n.bsonRegExp,l=null!=n.promoteBuffers&&n.promoteBuffers,h=null==n.promoteLongs||n.promoteLongs,p=null==n.promoteValues||n.promoteValues,d=t;if(e.length<5)throw new Error("corrupt bson message < 5 bytes long");var _=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;if(_<5||_>e.length)throw new Error("corrupt bson message");for(var g=r?[]:{},y=0;;){var b=e[t++];if(0===b)break;for(var v=t;0!==e[v]&&v<e.length;)v++;if(v>=Buffer$4.byteLength(e))throw new Error("Bad BSON Document: illegal CString");var m=r?y++:e.toString("utf8",t,v);if(t=v+1,b===constants.BSON_DATA_STRING){var S=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;if(S<=0||S>e.length-t||0!==e[t+S-1])throw new Error("bad string length in bson");if(!validateUtf8$1(e,t,t+S-1))throw new Error("Invalid UTF-8 string in BSON document");var E=e.toString("utf8",t,t+S-1);g[m]=E,t+=S}else if(b===constants.BSON_DATA_OID){var O=Buffer$4.alloc(12);e.copy(O,0,t,t+12),g[m]=new objectid(O),t+=12}else if(b===constants.BSON_DATA_INT&&!1===p)g[m]=new int_32(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24);else if(b===constants.BSON_DATA_INT)g[m]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;else if(b===constants.BSON_DATA_NUMBER&&!1===p)g[m]=new double_1(e.readDoubleLE(t)),t+=8;else if(b===constants.BSON_DATA_NUMBER)g[m]=e.readDoubleLE(t),t+=8;else if(b===constants.BSON_DATA_DATE){var N=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24,A=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;g[m]=new Date(new long_1(N,A).toNumber())}else if(b===constants.BSON_DATA_BOOLEAN){if(0!==e[t]&&1!==e[t])throw new Error("illegal boolean type value");g[m]=1===e[t++]}else if(b===constants.BSON_DATA_OBJECT){var T=t,w=e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24;if(w<=0||w>e.length-t)throw new Error("bad embedded document length in bson");g[m]=f?e.slice(t,t+w):deserializeObject(e,T,n,!1),t+=w}else if(b===constants.BSON_DATA_ARRAY){var B=t,I=e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24,P=n,D=t+I;if(a&&a[m]){P={};for(var R in n)P[R]=n[R];P.raw=!0}if(g[m]=deserializeObject(e,B,P,!0),t+=I,0!==e[t-1])throw new Error("invalid array terminator byte");if(t!==D)throw new Error("corrupted array bson")}else if(b===constants.BSON_DATA_UNDEFINED)g[m]=void 0;else if(b===constants.BSON_DATA_NULL)g[m]=null;else if(b===constants.BSON_DATA_LONG){var x=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24,$=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24,C=new long_1(x,$);g[m]=h&&!0===p&&C.lessThanOrEqual(JS_INT_MAX_LONG)&&C.greaterThanOrEqual(JS_INT_MIN_LONG)?C.toNumber():C}else if(b===constants.BSON_DATA_DECIMAL128){var k=Buffer$4.alloc(16);e.copy(k,0,t,t+16),t+=16;var U=new decimal128(k);g[m]=U.toObject?U.toObject():U}else if(b===constants.BSON_DATA_BINARY){var j=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24,M=j,L=e[t++];if(j<0)throw new Error("Negative binary type element size found");if(j>Buffer$4.byteLength(e))throw new Error("Binary type size larger than document size");if(null!=e.slice){if(L===binary.SUBTYPE_BYTE_ARRAY){if((j=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)<0)throw new Error("Negative binary type element size found for subtype 0x02");if(j>M-4)throw new Error("Binary type with subtype 0x02 contains to long binary size");if(j<M-4)throw new Error("Binary type with subtype 0x02 contains to short binary size")}g[m]=l&&p?e.slice(t,t+j):new binary(e.slice(t,t+j),L)}else{var Y="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(j)):new Array(j);if(L===binary.SUBTYPE_BYTE_ARRAY){if((j=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)<0)throw new Error("Negative binary type element size found for subtype 0x02");if(j>M-4)throw new Error("Binary type with subtype 0x02 contains to long binary size");if(j<M-4)throw new Error("Binary type with subtype 0x02 contains to short binary size")}for(v=0;v<j;v++)Y[v]=e[t+v];g[m]=l&&p?Y:new binary(Y,L)}t+=j}else if(b===constants.BSON_DATA_REGEXP&&!1===c){for(v=t;0!==e[v]&&v<e.length;)v++;if(v>=e.length)throw new Error("Bad BSON Document: illegal CString");var z=e.toString("utf8",t,v);for(t=v+1,v=t;0!==e[v]&&v<e.length;)v++;if(v>=e.length)throw new Error("Bad BSON Document: illegal CString");var F=e.toString("utf8",t,v);t=v+1;var J=new Array(F.length);for(v=0;v<F.length;v++)switch(F[v]){case"m":J[v]="m";break;case"s":J[v]="g";break;case"i":J[v]="i"}g[m]=new RegExp(z,J.join(""))}else if(b===constants.BSON_DATA_REGEXP&&!0===c){for(v=t;0!==e[v]&&v<e.length;)v++;if(v>=e.length)throw new Error("Bad BSON Document: illegal CString");var K=e.toString("utf8",t,v);for(t=v+1,v=t;0!==e[v]&&v<e.length;)v++;if(v>=e.length)throw new Error("Bad BSON Document: illegal CString");var V=e.toString("utf8",t,v);t=v+1,g[m]=new regexp(K,V)}else if(b===constants.BSON_DATA_SYMBOL){var X=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;if(X<=0||X>e.length-t||0!==e[t+X-1])throw new Error("bad string length in bson");var q=e.toString("utf8",t,t+X-1);g[m]=p?q:new symbol(q),t+=X}else if(b===constants.BSON_DATA_TIMESTAMP){var H=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24,G=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;g[m]=new timestamp(H,G)}else if(b===constants.BSON_DATA_MIN_KEY)g[m]=new min_key;else if(b===constants.BSON_DATA_MAX_KEY)g[m]=new max_key;else if(b===constants.BSON_DATA_CODE){var W=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;if(W<=0||W>e.length-t||0!==e[t+W-1])throw new Error("bad string length in bson");var Z=e.toString("utf8",t,t+W-1);if(i)if(o){var Q=s?u(Z):Z;g[m]=isolateEvalWithHash(functionCache,Q,Z,g)}else g[m]=isolateEval(Z);else g[m]=new code(Z);t+=W}else if(b===constants.BSON_DATA_CODE_W_SCOPE){var ee=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;if(ee<13)throw new Error("code_w_scope total size shorter minimum expected length");var te=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;if(te<=0||te>e.length-t||0!==e[t+te-1])throw new Error("bad string length in bson");var ne=e.toString("utf8",t,t+te-1);t+=te;var re=t,ie=e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24,oe=deserializeObject(e,re,n,!1);if(t+=ie,ee<8+ie+te)throw new Error("code_w_scope total size is to short, truncating scope");if(ee>8+ie+te)throw new Error("code_w_scope total size is to long, clips outer document");if(i){if(o){var se=s?u(ne):ne;g[m]=isolateEvalWithHash(functionCache,se,ne,g)}else g[m]=isolateEval(ne);g[m].scope=oe}else g[m]=new code(ne,oe)}else{if(b!==constants.BSON_DATA_DBPOINTER)throw new Error("Detected unknown BSON type "+b.toString(16)+' for fieldname "'+m+'", are you using the latest BSON parser?');var ue=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;if(ue<=0||ue>e.length-t||0!==e[t+ue-1])throw new Error("bad string length in bson");if(!validateUtf8$1(e,t,t+ue-1))throw new Error("Invalid UTF-8 string in BSON document");var ae=e.toString("utf8",t,t+ue-1);t+=ue;var fe=Buffer$4.alloc(12);e.copy(fe,0,t,t+12);var ce=new objectid(fe);t+=12,g[m]=new db_ref(ae,ce)}}if(_!==t-d){if(r)throw new Error("corrupt array bson");throw new Error("corrupt object bson")}var le=Object.keys(g).filter(function(e){return e.startsWith("$")}),he=!0;if(le.forEach(function(e){-1===["$ref","$id","$db"].indexOf(e)&&(he=!1)}),!he)return g;if(null!=g.$id&&null!=g.$ref){var pe=Object.assign({},g);return delete pe.$ref,delete pe.$id,delete pe.$db,new db_ref(g.$ref,g.$id,g.$db||null,pe)}return g}function isolateEvalWithHash(functionCache,hash,functionString,object){var value=null;return null==functionCache[hash]&&(eval("value = "+functionString),functionCache[hash]=value),functionCache[hash].bind(object)}function isolateEval(functionString){var value=null;return eval("value = "+functionString),value}function readIEEE754(e,t,n,r,i){var o,s,u="big"===n,a=8*i-r-1,f=(1<<a)-1,c=f>>1,l=-7,h=u?0:i-1,p=u?1:-1,d=e[t+h];for(h+=p,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+e[t+h],h+=p,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+h],h+=p,l-=8);if(0===o)o=1-c;else{if(o===f)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=c}return(d?-1:1)*s*Math.pow(2,o-r)}function writeIEEE754(e,t,n,r,i,o){var s,u,a,f="big"===r,c=8*o-i-1,l=(1<<c)-1,h=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=f?o-1:0,_=f?-1:1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(a=Math.pow(2,-s))<1&&(s--,a*=2),t+=s+h>=1?p/a:p*Math.pow(2,1-h),t*a>=2&&(s++,a/=2),s+h>=l?(u=0,s=l):s+h>=1?(u=(t*a-1)*Math.pow(2,i),s+=h):(u=t*Math.pow(2,h-1)*Math.pow(2,i),s=0)),isNaN(t)&&(u=0);i>=8;)e[n+d]=255&u,d+=_,u/=256,i-=8;for(s=s<<i|u,isNaN(t)&&(s+=8),c+=i;c>0;)e[n+d]=255&s,d+=_,s/=256,c-=8;e[n+d-_]|=128*g}function _typeof$3(e){return(_typeof$3="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return void 0===e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof2(e)})(e)}function serializeString(e,t,n,r,i){e[r++]=constants.BSON_DATA_STRING,r=r+(i?e.write(t,r,"ascii"):e.write(t,r,"utf8"))+1,e[r-1]=0;var o=e.write(n,r+4,"utf8");return e[r+3]=o+1>>24&255,e[r+2]=o+1>>16&255,e[r+1]=o+1>>8&255,e[r]=o+1&255,r=r+4+o,e[r++]=0,r}function serializeNumber(e,t,n,r,i){if(Math.floor(n)===n&&n>=constants.JS_INT_MIN&&n<=constants.JS_INT_MAX)if(n>=constants.BSON_INT32_MIN&&n<=constants.BSON_INT32_MAX){e[r++]=constants.BSON_DATA_INT;var o=i?e.write(t,r,"ascii"):e.write(t,r,"utf8");r+=o,e[r++]=0,e[r++]=255&n,e[r++]=n>>8&255,e[r++]=n>>16&255,e[r++]=n>>24&255}else if(n>=constants.JS_INT_MIN&&n<=constants.JS_INT_MAX){e[r++]=constants.BSON_DATA_NUMBER;var s=i?e.write(t,r,"ascii"):e.write(t,r,"utf8");r+=s,e[r++]=0,writeIEEE754$1(e,n,r,"little",52,8),r+=8}else{e[r++]=constants.BSON_DATA_LONG;var u=i?e.write(t,r,"ascii"):e.write(t,r,"utf8");r+=u,e[r++]=0;var a=long_1.fromNumber(n),f=a.getLowBits(),c=a.getHighBits();e[r++]=255&f,e[r++]=f>>8&255,e[r++]=f>>16&255,e[r++]=f>>24&255,e[r++]=255&c,e[r++]=c>>8&255,e[r++]=c>>16&255,e[r++]=c>>24&255}else{e[r++]=constants.BSON_DATA_NUMBER;r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,writeIEEE754$1(e,n,r,"little",52,8),r+=8}return r}function serializeNull(e,t,n,r,i){return e[r++]=constants.BSON_DATA_NULL,r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,r}function serializeBoolean(e,t,n,r,i){return e[r++]=constants.BSON_DATA_BOOLEAN,r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,e[r++]=n?1:0,r}function serializeDate(e,t,n,r,i){e[r++]=constants.BSON_DATA_DATE,r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var o=long_1.fromNumber(n.getTime()),s=o.getLowBits(),u=o.getHighBits();return e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255,e[r++]=255&u,e[r++]=u>>8&255,e[r++]=u>>16&255,e[r++]=u>>24&255,r}function serializeRegExp(e,t,n,r,i){if(e[r++]=constants.BSON_DATA_REGEXP,r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,n.source&&null!=n.source.match(regexp$1))throw Error("value "+n.source+" must not contain null bytes");return r+=e.write(n.source,r,"utf8"),e[r++]=0,n.ignoreCase&&(e[r++]=105),n.global&&(e[r++]=115),n.multiline&&(e[r++]=109),e[r++]=0,r}function serializeBSONRegExp(e,t,n,r,i){if(e[r++]=constants.BSON_DATA_REGEXP,r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,null!=n.pattern.match(regexp$1))throw Error("pattern "+n.pattern+" must not contain null bytes");return r+=e.write(n.pattern,r,"utf8"),e[r++]=0,r+=e.write(n.options.split("").sort().join(""),r,"utf8"),e[r++]=0,r}function serializeMinMax(e,t,n,r,i){return null===n?e[r++]=constants.BSON_DATA_NULL:"MinKey"===n._bsontype?e[r++]=constants.BSON_DATA_MIN_KEY:e[r++]=constants.BSON_DATA_MAX_KEY,r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,r}function serializeObjectId(e,t,n,r,i){if(e[r++]=constants.BSON_DATA_OID,r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,"string"==typeof n.id)e.write(n.id,r,"binary");else{if(!n.id||!n.id.copy)throw new TypeError("object ["+JSON.stringify(n)+"] is not a valid ObjectId");n.id.copy(e,r,0,12)}return r+12}function serializeBuffer(e,t,n,r,i){e[r++]=constants.BSON_DATA_BINARY,r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var o=n.length;return e[r++]=255&o,e[r++]=o>>8&255,e[r++]=o>>16&255,e[r++]=o>>24&255,e[r++]=constants.BSON_BINARY_SUBTYPE_DEFAULT,n.copy(e,r,0,o),r+=o}function serializeObject(e,t,n,r,i,o,s,u,a,f){for(var c=0;c<f.length;c++)if(f[c]===n)throw new Error("cyclic dependency detected");f.push(n),e[r++]=Array.isArray(n)?constants.BSON_DATA_ARRAY:constants.BSON_DATA_OBJECT,r+=a?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var l=serializeInto(e,n,i,r,o+1,s,u,f);return f.pop(),l}function serializeDecimal128(e,t,n,r,i){return e[r++]=constants.BSON_DATA_DECIMAL128,r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,n.bytes.copy(e,r,0,16),r+16}function serializeLong(e,t,n,r,i){e[r++]="Long"===n._bsontype?constants.BSON_DATA_LONG:constants.BSON_DATA_TIMESTAMP,r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var o=n.getLowBits(),s=n.getHighBits();return e[r++]=255&o,e[r++]=o>>8&255,e[r++]=o>>16&255,e[r++]=o>>24&255,e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255,r}function serializeInt32(e,t,n,r,i){return e[r++]=constants.BSON_DATA_INT,r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,e[r++]=255&n,e[r++]=n>>8&255,e[r++]=n>>16&255,e[r++]=n>>24&255,r}function serializeDouble(e,t,n,r,i){return e[r++]=constants.BSON_DATA_NUMBER,r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,writeIEEE754$1(e,n.value,r,"little",52,8),r+=8}function serializeFunction(e,t,n,r,i,o,s){e[r++]=constants.BSON_DATA_CODE,r+=s?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var u=normalizedFunctionString$1(n),a=e.write(u,r+4,"utf8")+1;return e[r]=255&a,e[r+1]=a>>8&255,e[r+2]=a>>16&255,e[r+3]=a>>24&255,r=r+4+a-1,e[r++]=0,r}function serializeCode(e,t,n,r,i,o,s,u,a){if(n.scope&&"object"===_typeof$3(n.scope)){e[r++]=constants.BSON_DATA_CODE_W_SCOPE;r+=a?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var f=r,c="string"==typeof n.code?n.code:n.code.toString();r+=4;var l=e.write(c,r+4,"utf8")+1;e[r]=255&l,e[r+1]=l>>8&255,e[r+2]=l>>16&255,e[r+3]=l>>24&255,e[r+4+l-1]=0,r=r+l+4;var h=serializeInto(e,n.scope,i,r,o+1,s,u);r=h-1;var p=h-f;e[f++]=255&p,e[f++]=p>>8&255,e[f++]=p>>16&255,e[f++]=p>>24&255,e[r++]=0}else{e[r++]=constants.BSON_DATA_CODE;r+=a?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var d=n.code.toString(),_=e.write(d,r+4,"utf8")+1;e[r]=255&_,e[r+1]=_>>8&255,e[r+2]=_>>16&255,e[r+3]=_>>24&255,r=r+4+_-1,e[r++]=0}return r}function serializeBinary(e,t,n,r,i){e[r++]=constants.BSON_DATA_BINARY,r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var o=n.value(!0),s=n.position;return n.sub_type===binary.SUBTYPE_BYTE_ARRAY&&(s+=4),e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255,e[r++]=n.sub_type,n.sub_type===binary.SUBTYPE_BYTE_ARRAY&&(s-=4,e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255),o.copy(e,r,0,n.position),r+=n.position}function serializeSymbol(e,t,n,r,i){e[r++]=constants.BSON_DATA_SYMBOL,r+=i?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var o=e.write(n.value,r+4,"utf8")+1;return e[r]=255&o,e[r+1]=o>>8&255,e[r+2]=o>>16&255,e[r+3]=o>>24&255,r=r+4+o-1,e[r++]=0,r}function serializeDBRef(e,t,n,r,i,o,s){e[r++]=constants.BSON_DATA_OBJECT,r+=s?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var u,a=r,f={$ref:n.collection||n.namespace,$id:n.oid};null!=n.db&&(f.$db=n.db),f=Object.assign(f,n.fields),u=serializeInto(e,f,!1,r,i+1,o);var c=u-a;return e[a++]=255&c,e[a++]=c>>8&255,e[a++]=c>>16&255,e[a++]=c>>24&255,u}function serializeInto(e,t,n,r,i,o,s,u){r=r||0,u=u||[],u.push(t);var a=r+4;if(Array.isArray(t))for(var f=0;f<t.length;f++){var c=""+f,l=t[f];if(l&&l.toBSON){if("function"!=typeof l.toBSON)throw new TypeError("toBSON is not a function");l=l.toBSON()}var h=_typeof$3(l);if("string"===h)a=serializeString(e,c,l,a,!0);else if("number"===h)a=serializeNumber(e,c,l,a,!0);else if("boolean"===h)a=serializeBoolean(e,c,l,a,!0);else if(l instanceof Date||isDate$1(l))a=serializeDate(e,c,l,a,!0);else if(void 0===l)a=serializeNull(e,c,l,a,!0);else if(null===l)a=serializeNull(e,c,l,a,!0);else if("ObjectId"===l._bsontype||"ObjectID"===l._bsontype)a=serializeObjectId(e,c,l,a,!0);else if(Buffer$5.isBuffer(l))a=serializeBuffer(e,c,l,a,!0);else if(l instanceof RegExp||isRegExp$1(l))a=serializeRegExp(e,c,l,a,!0);else if("object"===h&&null==l._bsontype)a=serializeObject(e,c,l,a,n,i,o,s,!0,u);else if("object"===h&&"Decimal128"===l._bsontype)a=serializeDecimal128(e,c,l,a,!0);else if("Long"===l._bsontype||"Timestamp"===l._bsontype)a=serializeLong(e,c,l,a,!0);else if("Double"===l._bsontype)a=serializeDouble(e,c,l,a,!0);else if("function"==typeof l&&o)a=serializeFunction(e,c,l,a,n,i,o,!0);else if("Code"===l._bsontype)a=serializeCode(e,c,l,a,n,i,o,s,!0);else if("Binary"===l._bsontype)a=serializeBinary(e,c,l,a,!0);else if("Symbol"===l._bsontype)a=serializeSymbol(e,c,l,a,!0);else if("DBRef"===l._bsontype)a=serializeDBRef(e,c,l,a,i,o,!0);else if("BSONRegExp"===l._bsontype)a=serializeBSONRegExp(e,c,l,a,!0);else if("Int32"===l._bsontype)a=serializeInt32(e,c,l,a,!0);else if("MinKey"===l._bsontype||"MaxKey"===l._bsontype)a=serializeMinMax(e,c,l,a,!0);else if(void 0!==l._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+l._bsontype)}else if(t instanceof map)for(var p=t.entries(),d=!1;!d;){var _=p.next();if(!(d=_.done)){var g=_.value[0],y=_.value[1],b=_typeof$3(y);if("string"==typeof g&&!ignoreKeys.has(g)){if(null!=g.match(regexp$1))throw Error("key "+g+" must not contain null bytes");if(n){if("$"===g[0])throw Error("key "+g+" must not start with '$'");if(~g.indexOf("."))throw Error("key "+g+" must not contain '.'")}}if("string"===b)a=serializeString(e,g,y,a);else if("number"===b)a=serializeNumber(e,g,y,a);else if("boolean"===b)a=serializeBoolean(e,g,y,a);else if(y instanceof Date||isDate$1(y))a=serializeDate(e,g,y,a);else if(null===y||void 0===y&&!1===s)a=serializeNull(e,g,y,a);else if("ObjectId"===y._bsontype||"ObjectID"===y._bsontype)a=serializeObjectId(e,g,y,a);else if(Buffer$5.isBuffer(y))a=serializeBuffer(e,g,y,a);else if(y instanceof RegExp||isRegExp$1(y))a=serializeRegExp(e,g,y,a);else if("object"===b&&null==y._bsontype)a=serializeObject(e,g,y,a,n,i,o,s,!1,u);else if("object"===b&&"Decimal128"===y._bsontype)a=serializeDecimal128(e,g,y,a);else if("Long"===y._bsontype||"Timestamp"===y._bsontype)a=serializeLong(e,g,y,a);else if("Double"===y._bsontype)a=serializeDouble(e,g,y,a);else if("Code"===y._bsontype)a=serializeCode(e,g,y,a,n,i,o,s);else if("function"==typeof y&&o)a=serializeFunction(e,g,y,a,n,i,o);else if("Binary"===y._bsontype)a=serializeBinary(e,g,y,a);else if("Symbol"===y._bsontype)a=serializeSymbol(e,g,y,a);else if("DBRef"===y._bsontype)a=serializeDBRef(e,g,y,a,i,o);else if("BSONRegExp"===y._bsontype)a=serializeBSONRegExp(e,g,y,a);else if("Int32"===y._bsontype)a=serializeInt32(e,g,y,a);else if("MinKey"===y._bsontype||"MaxKey"===y._bsontype)a=serializeMinMax(e,g,y,a);else if(void 0!==y._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+y._bsontype)}}else{if(t.toBSON){if("function"!=typeof t.toBSON)throw new TypeError("toBSON is not a function");if(null!=(t=t.toBSON())&&"object"!==_typeof$3(t))throw new TypeError("toBSON function did not return an object")}for(var v in t){var m=t[v];if(m&&m.toBSON){if("function"!=typeof m.toBSON)throw new TypeError("toBSON is not a function");m=m.toBSON()}var S=_typeof$3(m);if("string"==typeof v&&!ignoreKeys.has(v)){if(null!=v.match(regexp$1))throw Error("key "+v+" must not contain null bytes");if(n){if("$"===v[0])throw Error("key "+v+" must not start with '$'");if(~v.indexOf("."))throw Error("key "+v+" must not contain '.'")}}if("string"===S)a=serializeString(e,v,m,a);else if("number"===S)a=serializeNumber(e,v,m,a);else if("boolean"===S)a=serializeBoolean(e,v,m,a);else if(m instanceof Date||isDate$1(m))a=serializeDate(e,v,m,a);else if(void 0===m)!1===s&&(a=serializeNull(e,v,m,a));else if(null===m)a=serializeNull(e,v,m,a);else if("ObjectId"===m._bsontype||"ObjectID"===m._bsontype)a=serializeObjectId(e,v,m,a);else if(Buffer$5.isBuffer(m))a=serializeBuffer(e,v,m,a);else if(m instanceof RegExp||isRegExp$1(m))a=serializeRegExp(e,v,m,a);else if("object"===S&&null==m._bsontype)a=serializeObject(e,v,m,a,n,i,o,s,!1,u);else if("object"===S&&"Decimal128"===m._bsontype)a=serializeDecimal128(e,v,m,a);else if("Long"===m._bsontype||"Timestamp"===m._bsontype)a=serializeLong(e,v,m,a);else if("Double"===m._bsontype)a=serializeDouble(e,v,m,a);else if("Code"===m._bsontype)a=serializeCode(e,v,m,a,n,i,o,s);else if("function"==typeof m&&o)a=serializeFunction(e,v,m,a,n,i,o);else if("Binary"===m._bsontype)a=serializeBinary(e,v,m,a);else if("Symbol"===m._bsontype)a=serializeSymbol(e,v,m,a);else if("DBRef"===m._bsontype)a=serializeDBRef(e,v,m,a,i,o);else if("BSONRegExp"===m._bsontype)a=serializeBSONRegExp(e,v,m,a);else if("Int32"===m._bsontype)a=serializeInt32(e,v,m,a);else if("MinKey"===m._bsontype||"MaxKey"===m._bsontype)a=serializeMinMax(e,v,m,a);else if(void 0!==m._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+m._bsontype)}}u.pop(),e[a++]=0;var E=a-r;return e[r++]=255&E,e[r++]=E>>8&255,e[r++]=E>>16&255,e[r++]=E>>24&255,a}function _typeof$4(e){return(_typeof$4="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return void 0===e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof2(e)})(e)}function isDate$2(e){return"object"===_typeof$4(e)&&"[object Date]"===Object.prototype.toString.call(e)}function calculateObjectSize(e,t,n){var r=5;if(Array.isArray(e))for(var i=0;i<e.length;i++)r+=calculateElement(i.toString(),e[i],t,!0,n);else{e.toBSON&&(e=e.toBSON());for(var o in e)r+=calculateElement(o,e[o],t,!1,n)}return r}function calculateElement(e,t,n,r,i){switch(t&&t.toBSON&&(t=t.toBSON()),_typeof$4(t)){case"string":return 1+Buffer$6.byteLength(e,"utf8")+1+4+Buffer$6.byteLength(t,"utf8")+1;case"number":return Math.floor(t)===t&&t>=constants.JS_INT_MIN&&t<=constants.JS_INT_MAX&&t>=constants.BSON_INT32_MIN&&t<=constants.BSON_INT32_MAX?(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+5:(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+9;case"undefined":return r||!i?(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1:0;case"boolean":return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+2;case"object":if(null==t||"MinKey"===t._bsontype||"MaxKey"===t._bsontype)return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1;if("ObjectId"===t._bsontype||"ObjectID"===t._bsontype)return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+13;if(t instanceof Date||isDate$2(t))return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+9;if(void 0!==Buffer$6&&Buffer$6.isBuffer(t))return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+6+t.length;if("Long"===t._bsontype||"Double"===t._bsontype||"Timestamp"===t._bsontype)return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+9;if("Decimal128"===t._bsontype)return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+17;if("Code"===t._bsontype)return null!=t.scope&&Object.keys(t.scope).length>0?(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+4+4+Buffer$6.byteLength(t.code.toString(),"utf8")+1+calculateObjectSize(t.scope,n,i):(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+4+Buffer$6.byteLength(t.code.toString(),"utf8")+1;if("Binary"===t._bsontype)return t.sub_type===binary.SUBTYPE_BYTE_ARRAY?(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+(t.position+1+4+1+4):(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+(t.position+1+4+1);if("Symbol"===t._bsontype)return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+Buffer$6.byteLength(t.value,"utf8")+4+1+1;if("DBRef"===t._bsontype){var o=Object.assign({$ref:t.collection,$id:t.oid},t.fields);return null!=t.db&&(o.$db=t.db),(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+calculateObjectSize(o,n,i)}return t instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(t)?(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+Buffer$6.byteLength(t.source,"utf8")+1+(t.global?1:0)+(t.ignoreCase?1:0)+(t.multiline?1:0)+1:"BSONRegExp"===t._bsontype?(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+Buffer$6.byteLength(t.pattern,"utf8")+1+Buffer$6.byteLength(t.options,"utf8")+1:(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+calculateObjectSize(t,n,i)+1;case"function":if(t instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(t)||"[object RegExp]"===String.call(t))return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+Buffer$6.byteLength(t.source,"utf8")+1+(t.global?1:0)+(t.ignoreCase?1:0)+(t.multiline?1:0)+1;if(n&&null!=t.scope&&Object.keys(t.scope).length>0)return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+4+4+Buffer$6.byteLength(normalizedFunctionString$2(t),"utf8")+1+calculateObjectSize(t.scope,n,i);if(n)return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+4+Buffer$6.byteLength(normalizedFunctionString$2(t),"utf8")+1}return 0}function setInternalBufferSize(e){buffer$1.length<e&&(buffer$1=Buffer$8.alloc(e))}function serialize$1(e,t){t=t||{};var n="boolean"==typeof t.checkKeys&&t.checkKeys,r="boolean"==typeof t.serializeFunctions&&t.serializeFunctions,i="boolean"!=typeof t.ignoreUndefined||t.ignoreUndefined,o="number"==typeof t.minInternalBufferSize?t.minInternalBufferSize:MAXSIZE;buffer$1.length<o&&(buffer$1=Buffer$8.alloc(o));var s=serializer(buffer$1,e,n,0,0,r,i,[]),u=Buffer$8.alloc(s);return buffer$1.copy(u,0,0,u.length),u}function serializeWithBufferAndIndex(e,t,n){n=n||{};var r="boolean"==typeof n.checkKeys&&n.checkKeys,i="boolean"==typeof n.serializeFunctions&&n.serializeFunctions,o="boolean"!=typeof n.ignoreUndefined||n.ignoreUndefined,s="number"==typeof n.index?n.index:0,u=serializer(buffer$1,e,r,0,0,i,o);return buffer$1.copy(t,s,0,u),s+u-1}function deserialize$2(e,t){return e=ensure_buffer(e),deserializer(e,t)}function calculateObjectSize$1(e,t){t=t||{};var n="boolean"==typeof t.serializeFunctions&&t.serializeFunctions,r="boolean"!=typeof t.ignoreUndefined||t.ignoreUndefined;return calculate_size(e,n,r)}function deserializeStream(e,t,n,r,i,o){o=Object.assign({allowObjectSmallerThanBufferSize:!0},o),e=ensure_buffer(e);for(var s=t,u=0;u<n;u++){var a=e[s]|e[s+1]<<8|e[s+2]<<16|e[s+3]<<24;o.index=s,r[i+u]=deserializer(e,o),s+=a}return s}Object.defineProperty(exports,"__esModule",{value:!0}),exports.EJSON=exports.ObjectID=exports.setInternalBufferSize=exports.deserializeStream=exports.calculateObjectSize=exports.deserialize=exports.serializeWithBufferAndIndex=exports.serialize=exports.Decimal128=exports.BSONRegExp=exports.MaxKey=exports.MinKey=exports.Int32=exports.Double=exports.Timestamp=exports.Long=exports.ObjectId=exports.Binary=exports.DBRef=exports.BSONSymbol=exports.Code=exports.BSON_BINARY_SUBTYPE_USER_DEFINED=exports.BSON_BINARY_SUBTYPE_MD5=exports.BSON_BINARY_SUBTYPE_UUID=exports.BSON_BINARY_SUBTYPE_BYTE_ARRAY=exports.BSON_BINARY_SUBTYPE_FUNCTION=exports.BSON_BINARY_SUBTYPE_DEFAULT=exports.BSON_DATA_MAX_KEY=exports.BSON_DATA_MIN_KEY=exports.BSON_DATA_DECIMAL128=exports.BSON_DATA_LONG=exports.BSON_DATA_TIMESTAMP=exports.BSON_DATA_INT=exports.BSON_DATA_CODE_W_SCOPE=exports.BSON_DATA_SYMBOL=exports.BSON_DATA_CODE=exports.BSON_DATA_DBPOINTER=exports.BSON_DATA_REGEXP=exports.BSON_DATA_NULL=exports.BSON_DATA_DATE=exports.BSON_DATA_BOOLEAN=exports.BSON_DATA_OID=exports.BSON_DATA_UNDEFINED=exports.BSON_DATA_BINARY=exports.BSON_DATA_ARRAY=exports.BSON_DATA_OBJECT=exports.BSON_DATA_STRING=exports.BSON_DATA_NUMBER=exports.JS_INT_MIN=exports.JS_INT_MAX=exports.BSON_INT64_MIN=exports.BSON_INT64_MAX=exports.BSON_INT32_MIN=exports.BSON_INT32_MAX=void 0;var _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_long2=__webpack_require__(35),_long3=_interopRequireDefault(_long2),_buffer2=__webpack_require__(4),_buffer3=_interopRequireDefault(_buffer2),commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==global?global:"undefined"!=typeof self?self:{},map=createCommonjsModule(function(e){if(void 0!==commonjsGlobal.Map)e.exports=commonjsGlobal.Map,e.exports.Map=commonjsGlobal.Map;else{var t=function(e){this._keys=[],this._values={};for(var t=0;t<e.length;t++)if(null!=e[t]){var n=e[t],r=n[0],i=n[1];this._keys.push(r),this._values[r]={v:i,i:this._keys.length-1}}};t.prototype.clear=function(){this._keys=[],this._values={}},t.prototype.delete=function(e){var t=this._values[e];return null!=t&&(delete this._values[e],this._keys.splice(t.i,1),!0)},t.prototype.entries=function(){var e=this,t=0;return{next:function(){var n=e._keys[t++];return{value:void 0!==n?[n,e._values[n].v]:void 0,done:void 0===n}}}},t.prototype.forEach=function(e,t){t=t||this;for(var n=0;n<this._keys.length;n++){var r=this._keys[n];e.call(t,this._values[r].v,r,t)}},t.prototype.get=function(e){return this._values[e]?this._values[e].v:void 0},t.prototype.has=function(e){return null!=this._values[e]},t.prototype.keys=function(){var e=this,t=0;return{next:function(){var n=e._keys[t++];return{value:void 0!==n?n:void 0,done:void 0===n}}}},t.prototype.set=function(e,t){return this._values[e]?(this._values[e].v=t,this):(this._keys.push(e),this._values[e]={v:t,i:this._keys.length-1},this)},t.prototype.values=function(){var e=this,t=0;return{next:function(){var n=e._keys[t++];return{value:void 0!==n?e._values[n].v:void 0,done:void 0===n}}}},Object.defineProperty(t.prototype,"size",{enumerable:!0,get:function(){return this._keys.length}}),e.exports=t}}),map_1=map.Map;_long3.default.prototype.toExtendedJSON=function(e){return e&&e.relaxed?this.toNumber():{$numberLong:this.toString()}},_long3.default.fromExtendedJSON=function(e,t){var n=_long3.default.fromString(e.$numberLong);return t&&t.relaxed?n.toNumber():n},Object.defineProperty(_long3.default.prototype,"_bsontype",{value:"Long"});var long_1=_long3.default,Double=function(){function e(t){_classCallCheck(this,e),t instanceof Number&&(t=t.valueOf()),this.value=t}return _createClass(e,[{key:"valueOf",value:function(){return this.value}},{key:"toJSON",value:function(){return this.value}},{key:"toExtendedJSON",value:function(e){return e&&(e.legacy||e.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-".concat(this.value.toFixed(1))}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}}}],[{key:"fromExtendedJSON",value:function(t,n){var r=parseFloat(t.$numberDouble);return n&&n.relaxed?r:new e(r)}}]),e}();Object.defineProperty(Double.prototype,"_bsontype",{value:"Double"});var double_1=Double,Timestamp=function(e){function t(e,n){var r;return _classCallCheck$1(this,t),r=long_1.isLong(e)?_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e.low,e.high,!0)):_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n,!0)),_possibleConstructorReturn(r)}return _inherits(t,e),_createClass$1(t,[{key:"toJSON",value:function(){return{$timestamp:this.toString()}}},{key:"toExtendedJSON",value:function(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}}}],[{key:"fromInt",value:function(e){return new t(long_1.fromInt(e,!0))}},{key:"fromNumber",value:function(e){return new t(long_1.fromNumber(e,!0))}},{key:"fromBits",value:function(e,n){return new t(e,n)}},{key:"fromString",value:function(e,n){return new t(long_1.fromString(e,n,!0))}},{key:"fromExtendedJSON",value:function(e){return new t(e.$timestamp.i,e.$timestamp.t)}}]),t}(long_1);Object.defineProperty(Timestamp.prototype,"_bsontype",{value:"Timestamp"}),Timestamp.MAX_VALUE=Timestamp.MAX_UNSIGNED_VALUE;var timestamp=Timestamp,require$$0={},randomBytes=insecureRandomBytes;if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues)randomBytes=function(e){return window.crypto.getRandomValues(new Uint8Array(e))};else{try{randomBytes=require$$0.randomBytes}catch(e){}null==randomBytes&&(randomBytes=insecureRandomBytes)}var utils={normalizedFunctionString:normalizedFunctionString,randomBytes:randomBytes},cachedSetTimeout=defaultSetTimout,cachedClearTimeout=defaultClearTimeout;"function"==typeof global.setTimeout&&(cachedSetTimeout=setTimeout),"function"==typeof global.clearTimeout&&(cachedClearTimeout=clearTimeout);var queue=[],draining=!1,currentQueue,queueIndex=-1;Item.prototype.run=function(){this.fun.apply(null,this.array)};var title="browser",platform="browser",browser=!0,env={},argv=[],version="",versions={},release={},config={},on=noop,addListener=noop,once=noop,off=noop,removeListener=noop,removeAllListeners=noop,emit=noop,performance=global.performance||{},performanceNow=performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||function(){return(new Date).getTime()},startTime=new Date,process={nextTick:nextTick,title:title,browser:browser,env:env,argv:argv,version:version,versions:versions,on:on,addListener:addListener,once:once,off:off,removeListener:removeListener,removeAllListeners:removeAllListeners,emit:emit,binding:binding,cwd:cwd,chdir:chdir,umask:umask,hrtime:hrtime,platform:platform,release:release,config:config,uptime:uptime},inherits;inherits="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e};var inherits$1=inherits,formatRegExp=/%[sdj%]/g,debugs={},debugEnviron;inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],util={inherits:inherits$1,_extend:_extend,log:log,isBuffer:isBuffer,isPrimitive:isPrimitive,isFunction:isFunction,isError:isError,isDate:isDate,isObject:isObject,isRegExp:isRegExp,isUndefined:isUndefined,isSymbol:isSymbol,isString:isString,isNumber:isNumber,isNullOrUndefined:isNullOrUndefined,isNull:isNull,isBoolean:isBoolean,isArray:isArray,inspect:inspect,deprecate:deprecate,format:format,debuglog:debuglog},Buffer$1=_buffer3.default.Buffer,randomBytes$1=utils.randomBytes,deprecate$1=util.deprecate,PROCESS_UNIQUE=randomBytes$1(5),checkForHexRegExp=new RegExp("^[0-9a-fA-F]{24}$"),hasBufferType=!1;try{Buffer$1&&Buffer$1.from&&(hasBufferType=!0)}catch(e){hasBufferType=!1}for(var hexTable=[],_i=0;_i<256;_i++)hexTable[_i]=(_i<=15?"0":"")+_i.toString(16);for(var decodeLookup=[],i=0;i<10;)decodeLookup[48+i]=i++;for(;i<16;)decodeLookup[55+i]=decodeLookup[87+i]=i++;var _Buffer=Buffer$1,ObjectId=function(){function e(t){if(_classCallCheck$2(this,e),t instanceof e)return t;if(null==t||"number"==typeof t)return this.id=e.generate(t),void(e.cacheHexString&&(this.__id=this.toString("hex")));var n=e.isValid(t);if(!n&&null!=t)throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");if(n&&"string"==typeof t&&24===t.length&&hasBufferType)return new e(Buffer$1.from(t,"hex"));if(n&&"string"==typeof t&&24===t.length)return e.createFromHexString(t);if(null==t||12!==t.length){if(null!=t&&t.toHexString)return e.createFromHexString(t.toHexString());throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}this.id=t,e.cacheHexString&&(this.__id=this.toString("hex"))}return _createClass$2(e,[{key:"toHexString",value:function(){if(e.cacheHexString&&this.__id)return this.__id;var t="";if(!this.id||!this.id.length)throw new TypeError("invalid ObjectId, ObjectId.id must be either a string or a Buffer, but is ["+JSON.stringify(this.id)+"]");if(this.id instanceof _Buffer)return t=convertToHex(this.id),e.cacheHexString&&(this.__id=t),t;for(var n=0;n<this.id.length;n++){var r=hexTable[this.id.charCodeAt(n)];if("string"!=typeof r)throw makeObjectIdError(this.id,n);t+=r}return e.cacheHexString&&(this.__id=t),t}},{key:"toString",value:function(e){return this.id&&this.id.copy?this.id.toString("string"==typeof e?e:"hex"):this.toHexString()}},{key:"toJSON",value:function(){return this.toHexString()}},{key:"equals",value:function(t){return t instanceof e?this.toString()===t.toString():"string"==typeof t&&e.isValid(t)&&12===t.length&&this.id instanceof _Buffer?t===this.id.toString("binary"):"string"==typeof t&&e.isValid(t)&&24===t.length?t.toLowerCase()===this.toHexString():"string"==typeof t&&e.isValid(t)&&12===t.length?t===this.id:!(null==t||!(t instanceof e||t.toHexString))&&t.toHexString()===this.toHexString()}},{key:"getTimestamp",value:function(){var e=new Date,t=this.id.readUInt32BE(0);return e.setTime(1e3*Math.floor(t)),e}},{key:"toExtendedJSON",value:function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}}}],[{key:"getInc",value:function(){return e.index=(e.index+1)%16777215}},{key:"generate",value:function(t){"number"!=typeof t&&(t=~~(Date.now()/1e3));var n=e.getInc(),r=Buffer$1.alloc(12);return r[3]=255&t,r[2]=t>>8&255,r[1]=t>>16&255,r[0]=t>>24&255,r[4]=PROCESS_UNIQUE[0],r[5]=PROCESS_UNIQUE[1],r[6]=PROCESS_UNIQUE[2],r[7]=PROCESS_UNIQUE[3],r[8]=PROCESS_UNIQUE[4],r[11]=255&n,r[10]=n>>8&255,r[9]=n>>16&255,r}},{key:"createPk",value:function(){return new e}},{key:"createFromTime",value:function(t){var n=Buffer$1.from([0,0,0,0,0,0,0,0,0,0,0,0]);return n[3]=255&t,n[2]=t>>8&255,n[1]=t>>16&255,n[0]=t>>24&255,new e(n)}},{key:"createFromHexString",value:function(t){if(void 0===t||null!=t&&24!==t.length)throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");if(hasBufferType)return new e(Buffer$1.from(t,"hex"));for(var n=new _Buffer(12),r=0,i=0;i<24;)n[r++]=decodeLookup[t.charCodeAt(i++)]<<4|decodeLookup[t.charCodeAt(i++)];return new e(n)}},{key:"isValid",value:function(t){return null!=t&&("number"==typeof t||("string"==typeof t?12===t.length||24===t.length&&checkForHexRegExp.test(t):t instanceof e||(t instanceof _Buffer&&12===t.length||!!t.toHexString&&(12===t.id.length||24===t.id.length&&checkForHexRegExp.test(t.id)))))}},{key:"fromExtendedJSON",value:function(t){return new e(t.$oid)}}]),e}();ObjectId.get_inc=deprecate$1(function(){return ObjectId.getInc()},"Please use the static `ObjectId.getInc()` instead"),ObjectId.prototype.get_inc=deprecate$1(function(){return ObjectId.getInc()},"Please use the static `ObjectId.getInc()` instead"),ObjectId.prototype.getInc=deprecate$1(function(){return ObjectId.getInc()},"Please use the static `ObjectId.getInc()` instead"),ObjectId.prototype.generate=deprecate$1(function(e){return ObjectId.generate(e)},"Please use the static `ObjectId.generate(time)` instead"),Object.defineProperty(ObjectId.prototype,"generationTime",{enumerable:!0,get:function(){return this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24},set:function(e){this.id[3]=255&e,this.id[2]=e>>8&255,this.id[1]=e>>16&255,this.id[0]=e>>24&255}}),ObjectId.prototype[util.inspect.custom||"inspect"]=ObjectId.prototype.toString,ObjectId.index=~~(16777215*Math.random()),Object.defineProperty(ObjectId.prototype,"_bsontype",{value:"ObjectID"});var objectid=ObjectId,BSONRegExp=function(){function e(t,n){_classCallCheck$3(this,e),this.pattern=t||"",this.options=n?alphabetize(n):"";for(var r=0;r<this.options.length;r++)if("i"!==this.options[r]&&"m"!==this.options[r]&&"x"!==this.options[r]&&"l"!==this.options[r]&&"s"!==this.options[r]&&"u"!==this.options[r])throw new Error("The regular expression option [".concat(this.options[r],"] is not supported"))}return _createClass$3(e,[{key:"toExtendedJSON",value:function(e){return e=e||{},e.legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}}}],[{key:"parseOptions",value:function(e){return e?e.split("").sort().join(""):""}},{key:"fromExtendedJSON",value:function(t){return t.$regex?"BSONRegExp"===t.$regex._bsontype?t:new e(t.$regex,e.parseOptions(t.$options)):new e(t.$regularExpression.pattern,e.parseOptions(t.$regularExpression.options))}}]),e}();Object.defineProperty(BSONRegExp.prototype,"_bsontype",{value:"BSONRegExp"});var regexp=BSONRegExp,BSONSymbol=function(){function e(t){_classCallCheck$4(this,e),this.value=t}return _createClass$4(e,[{key:"valueOf",value:function(){return this.value}},{key:"toString",value:function(){return this.value}},{key:"inspect",value:function(){return this.value}},{key:"toJSON",value:function(){return this.value}},{key:"toExtendedJSON",value:function(){return{$symbol:this.value}}}],[{key:"fromExtendedJSON",value:function(t){return new e(t.$symbol)}}]),e}();Object.defineProperty(BSONSymbol.prototype,"_bsontype",{value:"Symbol"});var symbol=BSONSymbol,Int32=function(){function e(t){_classCallCheck$5(this,e),t instanceof Number&&(t=t.valueOf()),this.value=t}return _createClass$5(e,[{key:"valueOf",value:function(){return this.value}},{key:"toJSON",value:function(){return this.value}},{key:"toExtendedJSON",value:function(e){return e&&(e.relaxed||e.legacy)?this.value:{$numberInt:this.value.toString()}}}],[{key:"fromExtendedJSON",value:function(t,n){return n&&n.relaxed?parseInt(t.$numberInt,10):new e(t.$numberInt)}}]),e}();Object.defineProperty(Int32.prototype,"_bsontype",{value:"Int32"});var int_32=Int32,Code=function(){function e(t,n){_classCallCheck$6(this,e),this.code=t,this.scope=n}return _createClass$6(e,[{key:"toJSON",value:function(){return{scope:this.scope,code:this.code}}},{key:"toExtendedJSON",value:function(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}}}],[{key:"fromExtendedJSON",value:function(t){return new e(t.$code,t.$scope)}}]),e}();Object.defineProperty(Code.prototype,"_bsontype",{value:"Code"});var code=Code,Buffer$2=_buffer3.default.Buffer,PARSE_STRING_REGEXP=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,PARSE_INF_REGEXP=/^(\+|-)?(Infinity|inf)$/i,PARSE_NAN_REGEXP=/^(\+|-)?NaN$/i,EXPONENT_MAX=6111,EXPONENT_MIN=-6176,EXPONENT_BIAS=6176,NAN_BUFFER=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),INF_NEGATIVE_BUFFER=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),INF_POSITIVE_BUFFER=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),EXPONENT_REGEX=/^([-+])?(\d+)?$/;Decimal128.fromString=function(e){var t=!1,n=!1,r=!1,i=0,o=0,s=0,u=0,a=0,f=[0],c=0,l=0,h=0,p=0,d=0,_=0,g=[0,0],y=[0,0],b=0,v=0;if(e.length>=7e3)throw new TypeError(e+" not a valid Decimal128 string");var m=e.match(PARSE_STRING_REGEXP),S=e.match(PARSE_INF_REGEXP),E=e.match(PARSE_NAN_REGEXP);if(!m&&!S&&!E||0===e.length)throw new TypeError(e+" not a valid Decimal128 string");if(m){var O=m[2],N=m[4],A=m[5],T=m[6];N&&void 0===T&&invalidErr(e,"missing exponent power"),N&&void 0===O&&invalidErr(e,"missing exponent base"),void 0===N&&(A||T)&&invalidErr(e,"missing e before exponent")}if("+"!==e[v]&&"-"!==e[v]||(t="-"===e[v++]),!isDigit(e[v])&&"."!==e[v]){if("i"===e[v]||"I"===e[v])return new Decimal128(Buffer$2.from(t?INF_NEGATIVE_BUFFER:INF_POSITIVE_BUFFER));if("N"===e[v])return new Decimal128(Buffer$2.from(NAN_BUFFER))}for(;isDigit(e[v])||"."===e[v];)"."!==e[v]?(c<34&&("0"!==e[v]||r)&&(r||(a=o),r=!0,f[l++]=parseInt(e[v],10),c+=1),r&&(s+=1),n&&(u+=1),o+=1,v+=1):(n&&invalidErr(e,"contains multiple periods"),n=!0,v+=1);if(n&&!o)throw new TypeError(e+" not a valid Decimal128 string");if("e"===e[v]||"E"===e[v]){var w=e.substr(++v).match(EXPONENT_REGEX);if(!w||!w[2])return new Decimal128(Buffer$2.from(NAN_BUFFER));d=parseInt(w[0],10),v+=w[0].length}if(e[v])return new Decimal128(Buffer$2.from(NAN_BUFFER));if(h=0,c){if(p=c-1,1!==(i=s))for(;"0"===e[a+i-1];)i-=1}else h=0,p=0,f[0]=0,s=1,c=1,i=0;for(d<=u&&u-d>16384?d=EXPONENT_MIN:d-=u;d>EXPONENT_MAX;){if((p+=1)-h>34){if(f.join("").match(/^0+$/)){d=EXPONENT_MAX;break}invalidErr(e,"overflow")}d-=1}for(;d<EXPONENT_MIN||c<s;){if(0===p&&i<c){d=EXPONENT_MIN,i=0;break}if(c<s?s-=1:p-=1,d<EXPONENT_MAX)d+=1;else{if(f.join("").match(/^0+$/)){d=EXPONENT_MAX;break}invalidErr(e,"overflow")}}if(p-h+1<i){var B=o;n&&(a+=1,B+=1),t&&(a+=1,B+=1);var I=parseInt(e[a+p+1],10),P=0;if(I>=5&&(P=1,5===I))for(P=f[p]%2==1,_=a+p+2;_<B;_++)if(parseInt(e[_],10)){P=1;break}if(P)for(var D=p;D>=0;D--)if(++f[D]>9&&(f[D]=0,0===D)){if(!(d<EXPONENT_MAX))return new Decimal128(Buffer$2.from(t?INF_NEGATIVE_BUFFER:INF_POSITIVE_BUFFER));d+=1,f[D]=1}}if(g=long_1.fromNumber(0),y=long_1.fromNumber(0),0===i)g=long_1.fromNumber(0),y=long_1.fromNumber(0);else if(p-h<17){var R=h;for(y=long_1.fromNumber(f[R++]),g=new long_1(0,0);R<=p;R++)y=y.multiply(long_1.fromNumber(10)),y=y.add(long_1.fromNumber(f[R]))}else{var x=h;for(g=long_1.fromNumber(f[x++]);x<=p-17;x++)g=g.multiply(long_1.fromNumber(10)),g=g.add(long_1.fromNumber(f[x]));for(y=long_1.fromNumber(f[x++]);x<=p;x++)y=y.multiply(long_1.fromNumber(10)),y=y.add(long_1.fromNumber(f[x]))}var $=multiply64x2(g,long_1.fromString("100000000000000000"));$.low=$.low.add(y),lessThan($.low,y)&&($.high=$.high.add(long_1.fromNumber(1))),b=d+EXPONENT_BIAS;var C={low:long_1.fromNumber(0),high:long_1.fromNumber(0)};$.high.shiftRightUnsigned(49).and(long_1.fromNumber(1)).equals(long_1.fromNumber(1))?(C.high=C.high.or(long_1.fromNumber(3).shiftLeft(61)),C.high=C.high.or(long_1.fromNumber(b).and(long_1.fromNumber(16383).shiftLeft(47))),C.high=C.high.or($.high.and(long_1.fromNumber(0x7fffffffffff)))):(C.high=C.high.or(long_1.fromNumber(16383&b).shiftLeft(49)),C.high=C.high.or($.high.and(long_1.fromNumber(562949953421311)))),C.low=$.low,t&&(C.high=C.high.or(long_1.fromString("9223372036854775808")));var k=Buffer$2.alloc(16);return v=0,k[v++]=255&C.low.low,k[v++]=C.low.low>>8&255,k[v++]=C.low.low>>16&255,k[v++]=C.low.low>>24&255,k[v++]=255&C.low.high,k[v++]=C.low.high>>8&255,k[v++]=C.low.high>>16&255,k[v++]=C.low.high>>24&255,k[v++]=255&C.high.low,k[v++]=C.high.low>>8&255,k[v++]=C.high.low>>16&255,k[v++]=C.high.low>>24&255,k[v++]=255&C.high.high,k[v++]=C.high.high>>8&255,k[v++]=C.high.high>>16&255,k[v++]=C.high.high>>24&255,new Decimal128(k)};var EXPONENT_MASK=16383;Decimal128.prototype.toString=function(){for(var e,t,n,r,i,o,s=0,u=new Array(36),a=0;a<u.length;a++)u[a]=0;var f,c,l,h,p,d=0,_=!1,g={parts:new Array(4)},y=[];d=0;var b=this.bytes;if(r=b[d++]|b[d++]<<8|b[d++]<<16|b[d++]<<24,n=b[d++]|b[d++]<<8|b[d++]<<16|b[d++]<<24,t=b[d++]|b[d++]<<8|b[d++]<<16|b[d++]<<24,e=b[d++]|b[d++]<<8|b[d++]<<16|b[d++]<<24,d=0,{low:new long_1(r,n),high:new long_1(t,e)}.high.lessThan(long_1.ZERO)&&y.push("-"),(i=e>>26&31)>>3==3){if(30===i)return y.join("")+"Infinity";if(31===i)return"NaN";o=e>>15&EXPONENT_MASK,l=8+(e>>14&1)}else l=e>>14&7,o=e>>17&EXPONENT_MASK;if(f=o-EXPONENT_BIAS,g.parts[0]=(16383&e)+((15&l)<<14),g.parts[1]=t,g.parts[2]=n,g.parts[3]=r,0===g.parts[0]&&0===g.parts[1]&&0===g.parts[2]&&0===g.parts[3])_=!0;else for(p=3;p>=0;p--){var v=0,m=divideu128(g);if(g=m.quotient,v=m.rem.low)for(h=8;h>=0;h--)u[9*p+h]=v%10,v=Math.floor(v/10)}if(_)s=1,u[d]=0;else for(s=36;!u[d];)s-=1,d+=1;if((c=s-1+f)>=34||c<=-7||f>0){if(s>34)return y.push(0),f>0?y.push("E+"+f):f<0&&y.push("E"+f),y.join("");y.push(u[d++]),(s-=1)&&y.push(".");for(var S=0;S<s;S++)y.push(u[d++]);y.push("E"),c>0?y.push("+"+c):y.push(c)}else if(f>=0)for(var E=0;E<s;E++)y.push(u[d++]);else{var O=s+f;if(O>0)for(var N=0;N<O;N++)y.push(u[d++]);else y.push("0");for(y.push(".");O++<0;)y.push("0");for(var A=0;A<s-Math.max(O-1,0);A++)y.push(u[d++])}return y.join("")},Decimal128.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},Decimal128.prototype.toExtendedJSON=function(){return{$numberDecimal:this.toString()}},Decimal128.fromExtendedJSON=function(e){return Decimal128.fromString(e.$numberDecimal)},Object.defineProperty(Decimal128.prototype,"_bsontype",{value:"Decimal128"});var decimal128=Decimal128,MinKey=function(){function e(){_classCallCheck$7(this,e)}return _createClass$7(e,[{key:"toExtendedJSON",value:function(){return{$minKey:1}}}],[{key:"fromExtendedJSON",value:function(){return new e}}]),e}();Object.defineProperty(MinKey.prototype,"_bsontype",{value:"MinKey"});var min_key=MinKey,MaxKey=function(){function e(){_classCallCheck$8(this,e)}return _createClass$8(e,[{key:"toExtendedJSON",value:function(){return{$maxKey:1}}}],[{key:"fromExtendedJSON",value:function(){return new e}}]),e}();Object.defineProperty(MaxKey.prototype,"_bsontype",{value:"MaxKey"});var max_key=MaxKey,DBRef=function(){function e(t,n,r,i){_classCallCheck$9(this,e);var o=t.split(".");2===o.length&&(r=o.shift(),t=o.shift()),this.collection=t,this.oid=n,this.db=r,this.fields=i||{}}return _createClass$9(e,[{key:"toJSON",value:function(){var e=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return null!=this.db&&(e.$db=this.db),e}},{key:"toExtendedJSON",value:function(e){e=e||{};var t={$ref:this.collection,$id:this.oid};return e.legacy?t:(this.db&&(t.$db=this.db),t=Object.assign(t,this.fields))}}],[{key:"fromExtendedJSON",value:function(t){var n=Object.assign({},t);return["$ref","$id","$db"].forEach(function(e){return delete n[e]}),new e(t.$ref,t.$id,t.$db,n)}}]),e}();Object.defineProperty(DBRef.prototype,"_bsontype",{value:"DBRef"}),Object.defineProperty(DBRef.prototype,"namespace",{get:function(){return this.collection},set:function(e){this.collection=e},configurable:!1});var db_ref=DBRef,Buffer$3=_buffer3.default.Buffer,Binary=function(){function e(t,n){if(_classCallCheck$a(this,e),!(null==t||"string"==typeof t||Buffer$3.isBuffer(t)||t instanceof Uint8Array||Array.isArray(t)))throw new TypeError("only String, Buffer, Uint8Array or Array accepted");if(this.sub_type=null==n?BSON_BINARY_SUBTYPE_DEFAULT:n,this.position=0,null==t||t instanceof Number)void 0!==Buffer$3?this.buffer=Buffer$3.alloc(e.BUFFER_SIZE):"undefined"!=typeof Uint8Array?this.buffer=new Uint8Array(new ArrayBuffer(e.BUFFER_SIZE)):this.buffer=new Array(e.BUFFER_SIZE);else{if("string"==typeof t)if(void 0!==Buffer$3)this.buffer=Buffer$3.from(t);else{if("undefined"==typeof Uint8Array&&!Array.isArray(t))throw new TypeError("only String, Buffer, Uint8Array or Array accepted");this.buffer=writeStringToArray(t)}else this.buffer=t;this.position=t.length}}return _createClass$a(e,[{key:"put",value:function(t){if(null!=t.length&&"number"!=typeof t&&1!==t.length)throw new TypeError("only accepts single character String, Uint8Array or Array");if("number"!=typeof t&&t<0||t>255)throw new TypeError("only accepts number in a valid unsigned byte range 0-255");var n=null;if(n="string"==typeof t?t.charCodeAt(0):null!=t.length?t[0]:t,this.buffer.length>this.position)this.buffer[this.position++]=n;else if(void 0!==Buffer$3&&Buffer$3.isBuffer(this.buffer)){var r=Buffer$3.alloc(e.BUFFER_SIZE+this.buffer.length);this.buffer.copy(r,0,0,this.buffer.length),this.buffer=r,this.buffer[this.position++]=n}else{var i=null;i=isUint8Array(this.buffer)?new Uint8Array(new ArrayBuffer(e.BUFFER_SIZE+this.buffer.length)):new Array(e.BUFFER_SIZE+this.buffer.length);for(var o=0;o<this.buffer.length;o++)i[o]=this.buffer[o];this.buffer=i,this.buffer[this.position++]=n}}},{key:"write",value:function(e,t){if(t="number"==typeof t?t:this.position,this.buffer.length<t+e.length){var n=null;if(void 0!==Buffer$3&&Buffer$3.isBuffer(this.buffer))n=Buffer$3.alloc(this.buffer.length+e.length),this.buffer.copy(n,0,0,this.buffer.length);else if(isUint8Array(this.buffer)){n=new Uint8Array(new ArrayBuffer(this.buffer.length+e.length));for(var r=0;r<this.position;r++)n[r]=this.buffer[r]}this.buffer=n}if(void 0!==Buffer$3&&Buffer$3.isBuffer(e)&&Buffer$3.isBuffer(this.buffer))e.copy(this.buffer,t,0,e.length),this.position=t+e.length>this.position?t+e.length:this.position;else if(void 0!==Buffer$3&&"string"==typeof e&&Buffer$3.isBuffer(this.buffer))this.buffer.write(e,t,"binary"),this.position=t+e.length>this.position?t+e.length:this.position;else if(isUint8Array(e)||Array.isArray(e)&&"string"!=typeof e){for(var i=0;i<e.length;i++)this.buffer[t++]=e[i];this.position=t>this.position?t:this.position}else if("string"==typeof e){for(var o=0;o<e.length;o++)this.buffer[t++]=e.charCodeAt(o);this.position=t>this.position?t:this.position}}},{key:"read",value:function(e,t){if(t=t&&t>0?t:this.position,this.buffer.slice)return this.buffer.slice(e,e+t);for(var n="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(t)):new Array(t),r=0;r<t;r++)n[r]=this.buffer[e++];return n}},{key:"value",value:function(e){if((e=null!=e&&e)&&void 0!==Buffer$3&&Buffer$3.isBuffer(this.buffer)&&this.buffer.length===this.position)return this.buffer;if(void 0!==Buffer$3&&Buffer$3.isBuffer(this.buffer))return e?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position);if(e){if(null!=this.buffer.slice)return this.buffer.slice(0,this.position);for(var t=isUint8Array(this.buffer)?new Uint8Array(new ArrayBuffer(this.position)):new Array(this.position),n=0;n<this.position;n++)t[n]=this.buffer[n];return t}return convertArraytoUtf8BinaryString(this.buffer,0,this.position)}},{key:"length",value:function(){return this.position}},{key:"toJSON",value:function(){return null!=this.buffer?this.buffer.toString("base64"):""}},{key:"toString",value:function(e){return null!=this.buffer?this.buffer.slice(0,this.position).toString(e):""}},{key:"toExtendedJSON",value:function(e){e=e||{};var t=Buffer$3.isBuffer(this.buffer)?this.buffer.toString("base64"):Buffer$3.from(this.buffer).toString("base64"),n=Number(this.sub_type).toString(16);return e.legacy?{$binary:t,$type:1===n.length?"0"+n:n}:{$binary:{base64:t,subType:1===n.length?"0"+n:n}}}}],[{key:"fromExtendedJSON",value:function(t,n){n=n||{};var r,i;return n.legacy?(i=t.$type?parseInt(t.$type,16):0,r=Buffer$3.from(t.$binary,"base64")):(i=t.$binary.subType?parseInt(t.$binary.subType,16):0,r=Buffer$3.from(t.$binary.base64,"base64")),new e(r,i)}}]),e}(),BSON_BINARY_SUBTYPE_DEFAULT=0;Binary.BUFFER_SIZE=256,Binary.SUBTYPE_DEFAULT=0,Binary.SUBTYPE_FUNCTION=1,Binary.SUBTYPE_BYTE_ARRAY=2,Binary.SUBTYPE_UUID_OLD=3,Binary.SUBTYPE_UUID=4,Binary.SUBTYPE_MD5=5,Binary.SUBTYPE_USER_DEFINED=128,Object.defineProperty(Binary.prototype,"_bsontype",{value:"Binary"});var binary=Binary,constants={BSON_INT32_MAX:2147483647,BSON_INT32_MIN:-2147483648,BSON_INT64_MAX:Math.pow(2,63)-1,BSON_INT64_MIN:-Math.pow(2,63),JS_INT_MAX:9007199254740992,JS_INT_MIN:-9007199254740992,BSON_DATA_NUMBER:1,BSON_DATA_STRING:2,BSON_DATA_OBJECT:3,BSON_DATA_ARRAY:4,BSON_DATA_BINARY:5,BSON_DATA_UNDEFINED:6,BSON_DATA_OID:7,BSON_DATA_BOOLEAN:8,BSON_DATA_DATE:9,BSON_DATA_NULL:10,BSON_DATA_REGEXP:11,BSON_DATA_DBPOINTER:12,BSON_DATA_CODE:13,BSON_DATA_SYMBOL:14,BSON_DATA_CODE_W_SCOPE:15,BSON_DATA_INT:16,BSON_DATA_TIMESTAMP:17,BSON_DATA_LONG:18,BSON_DATA_DECIMAL128:19,BSON_DATA_MIN_KEY:255,BSON_DATA_MAX_KEY:127,BSON_BINARY_SUBTYPE_DEFAULT:0,BSON_BINARY_SUBTYPE_FUNCTION:1,BSON_BINARY_SUBTYPE_BYTE_ARRAY:2,BSON_BINARY_SUBTYPE_UUID:3,BSON_BINARY_SUBTYPE_MD5:4,BSON_BINARY_SUBTYPE_USER_DEFINED:128},keysToCodecs={$oid:objectid,$binary:binary,$symbol:symbol,$numberInt:int_32,$numberDecimal:decimal128,$numberDouble:double_1,$numberLong:long_1,$minKey:min_key,$maxKey:max_key,$regex:regexp,$regularExpression:regexp,$timestamp:timestamp},BSON_INT32_MAX=2147483647,BSON_INT32_MIN=-2147483648,BSON_INT64_MAX=0x8000000000000000,BSON_INT64_MIN=-0x8000000000000000,BSON_TYPE_MAPPINGS={Binary:function(e){return new binary(e.value(),e.subtype)},Code:function(e){return new code(e.code,e.scope)},DBRef:function(e){return new db_ref(e.collection||e.namespace,e.oid,e.db,e.fields)},Decimal128:function(e){return new decimal128(e.bytes)},Double:function(e){return new double_1(e.value)},Int32:function(e){return new int_32(e.value)},Long:function(e){return long_1.fromBits(null!=e.low?e.low:e.low_,null!=e.low?e.high:e.high_,null!=e.low?e.unsigned:e.unsigned_)},MaxKey:function(){return new max_key},MinKey:function(){return new min_key},ObjectID:function(e){return new objectid(e)},ObjectId:function(e){return new objectid(e)},BSONRegExp:function(e){return new regexp(e.pattern,e.options)},Symbol:function(e){return new symbol(e.value)},Timestamp:function(e){return timestamp.fromBits(e.low,e.high)}},extended_json={parse:parse,deserialize:deserialize,serialize:serialize,stringify:stringify},FIRST_BIT=128,FIRST_TWO_BITS=192,FIRST_THREE_BITS=224,FIRST_FOUR_BITS=240,FIRST_FIVE_BITS=248,TWO_BIT_CHAR=192,THREE_BIT_CHAR=224,FOUR_BIT_CHAR=240,CONTINUING_CHAR=128,validateUtf8_1=validateUtf8,validate_utf8={validateUtf8:validateUtf8_1},Buffer$4=_buffer3.default.Buffer,validateUtf8$1=validate_utf8.validateUtf8,JS_INT_MAX_LONG=long_1.fromNumber(constants.JS_INT_MAX),JS_INT_MIN_LONG=long_1.fromNumber(constants.JS_INT_MIN),functionCache={},deserializer=deserialize$1,float_parser={readIEEE754:readIEEE754,writeIEEE754:writeIEEE754},Buffer$5=_buffer3.default.Buffer,writeIEEE754$1=float_parser.writeIEEE754,normalizedFunctionString$1=utils.normalizedFunctionString,regexp$1=/\x00/,ignoreKeys=new Set(["$db","$ref","$id","$clusterTime"]),isDate$1=function(e){return"object"===_typeof$3(e)&&"[object Date]"===Object.prototype.toString.call(e)},isRegExp$1=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},serializer=serializeInto,Buffer$6=_buffer3.default.Buffer,normalizedFunctionString$2=utils.normalizedFunctionString,calculate_size=calculateObjectSize,Buffer$7=_buffer3.default.Buffer,ensure_buffer=function(e){if(e instanceof Buffer$7)return e;if(e instanceof Uint8Array)return Buffer$7.from(e.buffer);throw new TypeError("Must use either Buffer or Uint8Array")},Buffer$8=_buffer3.default.Buffer,MAXSIZE=17825792,buffer$1=Buffer$8.alloc(MAXSIZE),bson={BSON_INT32_MAX:constants.BSON_INT32_MAX,BSON_INT32_MIN:constants.BSON_INT32_MIN,BSON_INT64_MAX:constants.BSON_INT64_MAX,BSON_INT64_MIN:constants.BSON_INT64_MIN,JS_INT_MAX:constants.JS_INT_MAX,JS_INT_MIN:constants.JS_INT_MIN,BSON_DATA_NUMBER:constants.BSON_DATA_NUMBER,BSON_DATA_STRING:constants.BSON_DATA_STRING,BSON_DATA_OBJECT:constants.BSON_DATA_OBJECT,BSON_DATA_ARRAY:constants.BSON_DATA_ARRAY,BSON_DATA_BINARY:constants.BSON_DATA_BINARY,BSON_DATA_UNDEFINED:constants.BSON_DATA_UNDEFINED,BSON_DATA_OID:constants.BSON_DATA_OID,BSON_DATA_BOOLEAN:constants.BSON_DATA_BOOLEAN,BSON_DATA_DATE:constants.BSON_DATA_DATE,BSON_DATA_NULL:constants.BSON_DATA_NULL,BSON_DATA_REGEXP:constants.BSON_DATA_REGEXP,BSON_DATA_DBPOINTER:constants.BSON_DATA_DBPOINTER,BSON_DATA_CODE:constants.BSON_DATA_CODE,BSON_DATA_SYMBOL:constants.BSON_DATA_SYMBOL,BSON_DATA_CODE_W_SCOPE:constants.BSON_DATA_CODE_W_SCOPE,BSON_DATA_INT:constants.BSON_DATA_INT,BSON_DATA_TIMESTAMP:constants.BSON_DATA_TIMESTAMP,BSON_DATA_LONG:constants.BSON_DATA_LONG,BSON_DATA_DECIMAL128:constants.BSON_DATA_DECIMAL128,BSON_DATA_MIN_KEY:constants.BSON_DATA_MIN_KEY,BSON_DATA_MAX_KEY:constants.BSON_DATA_MAX_KEY,BSON_BINARY_SUBTYPE_DEFAULT:constants.BSON_BINARY_SUBTYPE_DEFAULT,BSON_BINARY_SUBTYPE_FUNCTION:constants.BSON_BINARY_SUBTYPE_FUNCTION,BSON_BINARY_SUBTYPE_BYTE_ARRAY:constants.BSON_BINARY_SUBTYPE_BYTE_ARRAY,BSON_BINARY_SUBTYPE_UUID:constants.BSON_BINARY_SUBTYPE_UUID,BSON_BINARY_SUBTYPE_MD5:constants.BSON_BINARY_SUBTYPE_MD5,BSON_BINARY_SUBTYPE_USER_DEFINED:constants.BSON_BINARY_SUBTYPE_USER_DEFINED,Code:code,Map:map,BSONSymbol:symbol,DBRef:db_ref,Binary:binary,ObjectId:objectid,Long:long_1,Timestamp:timestamp,Double:double_1,Int32:int_32,MinKey:min_key,MaxKey:max_key,BSONRegExp:regexp,Decimal128:decimal128,serialize:serialize$1,serializeWithBufferAndIndex:serializeWithBufferAndIndex,deserialize:deserialize$2,calculateObjectSize:calculateObjectSize$1,deserializeStream:deserializeStream,setInternalBufferSize:setInternalBufferSize,ObjectID:objectid,EJSON:extended_json},bson_1=bson.BSON_INT32_MAX,bson_2=bson.BSON_INT32_MIN,bson_3=bson.BSON_INT64_MAX,bson_4=bson.BSON_INT64_MIN,bson_5=bson.JS_INT_MAX,bson_6=bson.JS_INT_MIN,bson_7=bson.BSON_DATA_NUMBER,bson_8=bson.BSON_DATA_STRING,bson_9=bson.BSON_DATA_OBJECT,bson_10=bson.BSON_DATA_ARRAY,bson_11=bson.BSON_DATA_BINARY,bson_12=bson.BSON_DATA_UNDEFINED,bson_13=bson.BSON_DATA_OID,bson_14=bson.BSON_DATA_BOOLEAN,bson_15=bson.BSON_DATA_DATE,bson_16=bson.BSON_DATA_NULL,bson_17=bson.BSON_DATA_REGEXP,bson_18=bson.BSON_DATA_DBPOINTER,bson_19=bson.BSON_DATA_CODE,bson_20=bson.BSON_DATA_SYMBOL,bson_21=bson.BSON_DATA_CODE_W_SCOPE,bson_22=bson.BSON_DATA_INT,bson_23=bson.BSON_DATA_TIMESTAMP,bson_24=bson.BSON_DATA_LONG,bson_25=bson.BSON_DATA_DECIMAL128,bson_26=bson.BSON_DATA_MIN_KEY,bson_27=bson.BSON_DATA_MAX_KEY,bson_28=bson.BSON_BINARY_SUBTYPE_DEFAULT,bson_29=bson.BSON_BINARY_SUBTYPE_FUNCTION,bson_30=bson.BSON_BINARY_SUBTYPE_BYTE_ARRAY,bson_31=bson.BSON_BINARY_SUBTYPE_UUID,bson_32=bson.BSON_BINARY_SUBTYPE_MD5,bson_33=bson.BSON_BINARY_SUBTYPE_USER_DEFINED,bson_34=bson.Code,bson_35=bson.BSONSymbol,bson_36=bson.DBRef,bson_37=bson.Binary,bson_38=bson.ObjectId,bson_39=bson.Long,bson_40=bson.Timestamp,bson_41=bson.Double,bson_42=bson.Int32,bson_43=bson.MinKey,bson_44=bson.MaxKey,bson_45=bson.BSONRegExp,bson_46=bson.Decimal128,bson_47=bson.serialize,bson_48=bson.serializeWithBufferAndIndex,bson_49=bson.deserialize,bson_50=bson.calculateObjectSize,bson_51=bson.deserializeStream,bson_52=bson.setInternalBufferSize,bson_53=bson.ObjectID,bson_54=bson.EJSON;exports.default=bson,exports.BSON_INT32_MAX=bson_1,exports.BSON_INT32_MIN=bson_2,exports.BSON_INT64_MAX=bson_3,exports.BSON_INT64_MIN=bson_4,exports.JS_INT_MAX=bson_5,exports.JS_INT_MIN=bson_6,exports.BSON_DATA_NUMBER=bson_7,exports.BSON_DATA_STRING=bson_8,exports.BSON_DATA_OBJECT=bson_9,exports.BSON_DATA_ARRAY=bson_10,exports.BSON_DATA_BINARY=bson_11,exports.BSON_DATA_UNDEFINED=bson_12,exports.BSON_DATA_OID=bson_13,exports.BSON_DATA_BOOLEAN=bson_14,exports.BSON_DATA_DATE=bson_15,exports.BSON_DATA_NULL=bson_16,exports.BSON_DATA_REGEXP=bson_17,exports.BSON_DATA_DBPOINTER=bson_18,exports.BSON_DATA_CODE=bson_19,exports.BSON_DATA_SYMBOL=bson_20,exports.BSON_DATA_CODE_W_SCOPE=bson_21,exports.BSON_DATA_INT=bson_22,exports.BSON_DATA_TIMESTAMP=bson_23,exports.BSON_DATA_LONG=bson_24,exports.BSON_DATA_DECIMAL128=bson_25,exports.BSON_DATA_MIN_KEY=bson_26,exports.BSON_DATA_MAX_KEY=bson_27,exports.BSON_BINARY_SUBTYPE_DEFAULT=bson_28,exports.BSON_BINARY_SUBTYPE_FUNCTION=bson_29,exports.BSON_BINARY_SUBTYPE_BYTE_ARRAY=bson_30,exports.BSON_BINARY_SUBTYPE_UUID=bson_31,exports.BSON_BINARY_SUBTYPE_MD5=bson_32,exports.BSON_BINARY_SUBTYPE_USER_DEFINED=bson_33,exports.Code=bson_34,exports.BSONSymbol=bson_35,exports.DBRef=bson_36,exports.Binary=bson_37,exports.ObjectId=bson_38,exports.Long=bson_39,exports.Timestamp=bson_40,exports.Double=bson_41,exports.Int32=bson_42,exports.MinKey=bson_43,exports.MaxKey=bson_44,exports.BSONRegExp=bson_45,exports.Decimal128=bson_46,exports.serialize=bson_47,exports.serializeWithBufferAndIndex=bson_48,exports.deserialize=bson_49,exports.calculateObjectSize=bson_50,exports.deserializeStream=bson_51,exports.setInternalBufferSize=bson_52,exports.ObjectID=bson_53,exports.EJSON=bson_54}).call(exports,__webpack_require__(11),__webpack_require__(4).Buffer)},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){return t?e+"?link=true":e}function s(e){return{authenticate:function(t,n){var r=e.getDeviceId(),i=e.getDeviceInfo(r,!!e.client&&e.client.clientAppID),s=y.makeFetchArgs("GET");return s.cors=!0,B()(o(e.rootUrl+"/providers/anon-user/login?device="+(0,m.uriEncodeObject)(i),n),e.fetchArgsWithLink(s,n)).then(y.checkStatus).then(function(e){return e.json()}).then(function(t){return e.set(t,S)})}}}function u(e){return{authenticate:function(t,n){var r=e.getDeviceId(),i=e.getDeviceInfo(r,!!e.client&&e.client.clientAppID),s=y.makeFetchArgs("POST",JSON.stringify({token:t,options:{device:i}}));return s.cors=!0,B()(o(e.rootUrl+"/providers/custom-token/login",n),e.fetchArgsWithLink(s,n)).then(y.checkStatus).then(function(e){return e.json()}).then(function(t){return e.set(t,E)})}}}function a(e){var t=(e.isAppClient(),"providers/local-userpass"),n=(e.isAppClient(),t+"/login");return{authenticate:function(t,r){var i=t.username,s=t.password,u=e.getDeviceId(),a=e.getDeviceInfo(u,!!e.client&&e.client.clientAppID),f=y.makeFetchArgs("POST",JSON.stringify({username:i,password:s,options:{device:a}}));return f.cors=!0,B()(o(e.rootUrl+"/"+n,r),e.fetchArgsWithLink(f,r)).then(y.checkStatus).then(function(e){return e.json()}).then(function(t){return e.set(t,O)})},emailConfirm:function(n,r){var i=y.makeFetchArgs("POST",JSON.stringify({tokenId:n,token:r}));return i.cors=!0,B()(e.rootUrl+"/"+t+"/confirm",i).then(y.checkStatus).then(function(e){return e.json()})},sendEmailConfirm:function(n){var r=y.makeFetchArgs("POST",JSON.stringify({email:n}));return r.cors=!0,B()(e.rootUrl+"/"+t+"/confirm/send",r).then(y.checkStatus).then(function(e){return e.json()})},sendPasswordReset:function(n){var r=y.makeFetchArgs("POST",JSON.stringify({email:n}));return r.cors=!0,B()(e.rootUrl+"/"+t+"/reset/send",r).then(y.checkStatus).then(function(e){return e.json()})},passwordReset:function(n,r,i){var o=y.makeFetchArgs("POST",JSON.stringify({tokenId:n,token:r,password:i}));return o.cors=!0,B()(e.rootUrl+"/"+t+"/reset",o).then(y.checkStatus).then(function(e){return e.json()})},register:function(n,r){var i=y.makeFetchArgs("POST",JSON.stringify({email:n,password:r}));return i.cors=!0,B()(e.rootUrl+"/"+t+"/register",i).then(y.checkStatus).then(function(e){return e.json()})}}}function f(e){var t=(e.isAppClient(),"providers/api-key/login");return{authenticate:function(n,r){var i=e.getDeviceId(),s=e.getDeviceInfo(i,!!e.client&&e.client.clientAppID),u=y.makeFetchArgs("POST",JSON.stringify({key:n,options:{device:s}}));return u.cors=!0,B()(o(e.rootUrl+"/"+t,r),e.fetchArgsWithLink(u,r)).then(y.checkStatus).then(function(e){return e.json()}).then(function(t){return e.set(t,N)})}}}function c(){for(var e="",t=0;t<64;++t)e+=I.charAt(Math.floor(Math.random()*I.length));return e}function l(e,t,n){void 0===n&&(n=e.pageRootUrl());var r=c();return e.storage.set(v.STATE_KEY,r).then(function(){return e.getDeviceId()}).then(function(i){var o=e.getDeviceInfo(i,!!e.client&&e.client.clientAppID);return e.rootUrl+"/providers/oauth2-"+t+"/login?redirect="+encodeURI(n)+"&state="+r+"&device="+(0,m.uriEncodeObject)(o)})}function h(e){var t=(e.isAppClient(),"providers/oauth2-google/login");return{authenticate:function(n,r){var i=n.authCode;if(i){var s=e.getDeviceId(),u=e.getDeviceInfo(s,!!e.client&&e.client.clientAppID),a=y.makeFetchArgs("POST",JSON.stringify({authCode:i,options:{device:u}}));return B()(o(e.rootUrl+"/"+t,r),e.fetchArgsWithLink(a,r)).then(y.checkStatus).then(function(e){return e.json()}).then(function(t){return e.set(t,A)})}var f=n&&n.redirectUrl?n.redirectUrl:void 0;return e.storage.set(v.STITCH_REDIRECT_PROVIDER,A).then(function(){return l(e,A,f)}).then(function(e){return window.location.replace(e)})}}}function p(e){var t=(e.isAppClient(),"providers/oauth2-facebook/login");return{authenticate:function(n,r){var i=n.accessToken;if(i){var s=e.getDeviceId(),u=e.getDeviceInfo(s,!!e.client&&e.client.clientAppID),a=y.makeFetchArgs("POST",JSON.stringify({accessToken:i,options:{device:u}}));return B()(o(e.rootUrl+"/"+t,r),e.fetchArgsWithLink(a,r)).then(y.checkStatus).then(function(e){return e.json()}).then(function(t){return e.set(t,T)})}var f=n&&n.redirectUrl?n.redirectUrl:void 0;return e.storage.set(v.STITCH_REDIRECT_PROVIDER,T).then(function(){return l(e,T,f)}).then(function(e){return window.location.replace(e)})}}}function d(e){var t=(e.isAppClient(),"providers/mongodb-cloud/login");return{authenticate:function(n,r){var i=n.username,s=n.apiKey,u=n.cors,a=n.cookie,f=Object.assign({},{cors:!0,cookie:!1},{cors:u,cookie:a}),c=e.getDeviceId(),l=e.getDeviceInfo(c,!!e.client&&e.client.clientAppID),h=y.makeFetchArgs("POST",JSON.stringify({username:i,apiKey:s,options:{device:l}}));h.cors=!0,h.credentials="include";var p=B(),d=o(e.rootUrl+"/"+t,r);return f.cookie?p(d+"?cookie=true",h).then(y.checkStatus):p(d,e.fetchArgsWithLink(h,r)).then(y.checkStatus).then(function(e){return e.json()}).then(function(t){return e.set(t,w)})}}}function _(e){var t;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t={},i(t,S,s(e)),i(t,N,f(e)),i(t,A,h(e)),i(t,T,p(e)),i(t,w,d(e)),i(t,O,a(e)),i(t,E,u(e)),t}Object.defineProperty(t,"__esModule",{value:!0}),t.createProviders=t.fetcher=t.PROVIDER_TYPE_MONGODB_CLOUD=t.PROVIDER_TYPE_FACEBOOK=t.PROVIDER_TYPE_GOOGLE=t.PROVIDER_TYPE_APIKEY=t.PROVIDER_TYPE_USERPASS=t.PROVIDER_TYPE_CUSTOM=t.PROVIDER_TYPE_ANON=void 0;var g=n(2),y=r(g),b=n(1),v=r(b),m=n(0),S=t.PROVIDER_TYPE_ANON="anon",E=t.PROVIDER_TYPE_CUSTOM="custom",O=t.PROVIDER_TYPE_USERPASS="userpass",N=t.PROVIDER_TYPE_APIKEY="apiKey",A=t.PROVIDER_TYPE_GOOGLE="google",T=t.PROVIDER_TYPE_FACEBOOK="facebook",w=t.PROVIDER_TYPE_MONGODB_CLOUD="mongodbCloud",B=t.fetcher=function(){return"undefined"==typeof fetch?n(10):fetch},I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t.createProviders=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.v1=1,t.v2=2,t.v3=3,t.API_TYPE_PUBLIC="public",t.API_TYPE_PRIVATE="private",t.API_TYPE_CLIENT="client",t.API_TYPE_APP="app"},function(e,t,n){"use strict";var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r)return r;throw new Error("unable to locate global object")}();e.exports=t=r.fetch,t.default=r.fetch.bind(r),t.Headers=r.Headers,t.Request=r.Request,t.Response=r.Response},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.StitchAdminClient=t.StitchAdminClientFactory=void 0;var a=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(r)},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(29),l=r(c),h=n(5),p=n(2),d=r(p),_=n(1),g=n(3),y=n(9),b=(t.StitchAdminClientFactory=function(){function e(){throw u(this,e),new g.StitchError("StitchAdminClient can only be made from the StitchAdminClientFactory.create function")}return f(e,null,[{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{requestOrigin:void 0};return(0,h.newStitchClient)(b.prototype,"",{requestOrigin:t.requestOrigin,baseUrl:e,authCodec:_.ADMIN_CLIENT_CODEC})}}]),e}(),t.StitchAdminClient=function(e){function t(){return u(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return s(t,e),f(t,[{key:"logout",value:function(){var e=this;return a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_do",this).call(this,"/auth/session","DELETE",{refreshOnFailure:!1,useRefreshToken:!0,apiVersion:y.v3}).then(function(){return e.auth.clear()})}},{key:"userProfile",value:function(){return this._v3._get("/auth/profile")}},{key:"getAuthProviders",value:function(){return a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_do",this).call(this,"/auth/providers","GET",{noAuth:!0,apiVersion:y.v3}).then(function(e){return e.json()})}},{key:"doSessionPost",value:function(){return a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_do",this).call(this,"/auth/session","POST",{refreshOnFailure:!1,useRefreshToken:!0,apiVersion:y.v3}).then(function(e){return e.json()})}},{key:"apps",value:function(e){var t=this._v3,n="/groups/"+e+"/apps";return{list:function(e){return t._get(n,e)},create:function(e,r){var i=r&&r.product?"?product="+r.product:"";return t._post(n+i,e)},app:function(e){var r=n+"/"+e;return{get:function(){return t._get(r)},remove:function(){return t._delete(r)},export:function(){return t._get(r+"/export",void 0,{Accept:"application/zip"})},measurements:function(e){return t._get(r+"/measurements",e)},commands:function(){return{run:function(e,n){return t._post(r+"/commands/"+e,n)}}},dependencies:function(){return{list:function(){return t._get(r+"/dependencies")},upload:function(e,n){var i=new l.default;return i.append("file",n,e),t._postRaw(r+"/dependencies",{body:i,multipart:!0})}}},values:function(){return{list:function(){return t._get(r+"/values")},create:function(e){return t._post(r+"/values",e)},value:function(e){var n=r+"/values/"+e;return{get:function(){return t._get(n)},remove:function(){return t._delete(n)},update:function(e){return t._put(n,{body:JSON.stringify(e)})}}}}},secrets:function(){return{list:function(){return t._get(r+"/secrets")},create:function(e){return t._post(r+"/secrets",e)},secret:function(e){var n=r+"/secrets/"+e;return{remove:function(){return t._delete(n)},update:function(e){return t._put(n,{body:JSON.stringify(e)})}}}}},hosting:function(){return{config:function(){return{get:function(){return t._get(r+"/hosting/config")},patch:function(e){return t._patch(r+"/hosting/config",{body:JSON.stringify(e)})}}},cache:function(){return{invalidate:function(e){return t._put(r+"/hosting/cache",{body:JSON.stringify({invalidate:!0,path:e})})}}},assets:function(){return{createDirectory:function(e){return t._put(r+"/hosting/assets/asset",{body:JSON.stringify({path:e+"/"})})},list:function(e){return t._get(r+"/hosting/assets",e)},upload:function(e,n){var i=new l.default;return i.append("meta",e),i.append("file",n),t._put(r+"/hosting/assets/asset",{body:i,multipart:!0})},post:function(e){return t._post(r+"/hosting/assets",e)},asset:function(){return{patch:function(e){return t._patch(r+"/hosting/assets/asset",{body:JSON.stringify({attributes:e.attributes}),queryParams:{path:e.path}})},get:function(e){return t._get(r+"/hosting/assets/asset",e)},delete:function(e){return t._delete(r+"/hosting/assets/asset",e)}}}}}}},deploy:function(){return{auth:function(){return{github:function(){return t._get(r+"/deploy/github/auth",void 0,void 0,{credentials:"include"})}}},config:function(){return t._get(r+"/deploy/config")},deployments:function(){return{list:function(e){return t._get(r+"/deployments",e)},get:function(e){return t._get(r+"/deployments/"+e)}}},installation:function(){return t._get(r+"/deploy/installation")},updateConfig:function(e){return t._patch(r+"/deploy/config",{body:JSON.stringify(e)})},overwriteConfig:function(e){return t._put(r+"/deploy/config",{body:JSON.stringify(e)})}}},drafts:function(){return{get:function(e){return t._get(r+"/drafts/"+e)},list:function(){return t._get(r+"/drafts")},create:function(){return t._post(r+"/drafts")},delete:function(e){return t._delete(r+"/drafts/"+e)},deploy:function(e){return t._post(r+"/drafts/"+e+"/deployment")},diff:function(e){return t._get(r+"/drafts/"+e+"/diff")}}},services:function(){return{list:function(){return t._get(r+"/services")},create:function(e){return t._post(r+"/services",e)},service:function(e){return{get:function(){return t._get(r+"/services/"+e)},remove:function(){return t._delete(r+"/services/"+e)},update:function(n){return t._patch(r+"/services/"+e,{body:JSON.stringify(n)})},runCommand:function(n,i){return t._post(r+"/services/"+e+"/commands/"+n,i)},config:function(){return{get:function(n){return t._get(r+"/services/"+e+"/config",n)},update:function(n){return t._patch(r+"/services/"+e+"/config",{body:JSON.stringify(n)})}}},rules:function(){return{list:function(){return t._get(r+"/services/"+e+"/rules")},create:function(n){return t._post(r+"/services/"+e+"/rules",n)},rule:function(n){var i=r+"/services/"+e+"/rules/"+n;return{get:function(){return t._get(i)},update:function(e){return t._put(i,{body:JSON.stringify(e)})},remove:function(){return t._delete(i)}}}}},incomingWebhooks:function(){return{list:function(){return t._get(r+"/services/"+e+"/incoming_webhooks")},create:function(n){return t._post(r+"/services/"+e+"/incoming_webhooks",n)},incomingWebhook:function(n){var i=r+"/services/"+e+"/incoming_webhooks/"+n;return{get:function(){return t._get(i)},update:function(e){return t._put(i,{body:JSON.stringify(e)})},remove:function(){return t._delete(i)}}}}}}}}},pushNotifications:function(){return{list:function(e){return t._get(r+"/push/notifications",e)},create:function(e){return t._post(r+"/push/notifications",e)},pushNotification:function(e){return{get:function(){return t._get(r+"/push/notifications/"+e)},update:function(n){return t._put(r+"/push/notifications/"+e,{body:JSON.stringify(n)})},remove:function(){return t._delete(r+"/push/notifications/"+e)},send:function(){return t._post(r+"/push/notifications/"+e+"/send")}}}}},users:function(){return{count:function(){return t._get(r+"/users_count")},list:function(e){return t._get(r+"/users",e)},create:function(e){return t._post(r+"/users",e)},user:function(e){return{get:function(){return t._get(r+"/users/"+e)},devices:function(){return{get:function(){return t._get(r+"/users/"+e+"/devices")}}},logout:function(){return t._put(r+"/users/"+e+"/logout")},enable:function(){return t._put(r+"/users/"+e+"/enable")},disable:function(){return t._put(r+"/users/"+e+"/disable")},remove:function(){return t._delete(r+"/users/"+e)}}}}},userRegistrations:function(){return{sendConfirmationEmail:function(e){return t._post(r+"/user_registrations/by_email/"+e+"/send_confirm")},runUserConfirmation:function(e){return t._post(r+"/user_registrations/by_email/"+e+"/run_confirm")},confirmByEmail:function(e){return t._post(r+"/user_registrations/by_email/"+e+"/confirm")},listPending:function(e){return t._get(r+"/user_registrations/pending_users",e)},removePendingUserByEmail:function(e){return t._delete(r+"/user_registrations/by_email/"+e)},removePendingUserByID:function(e){return t._delete(r+"/user_registrations/by_id/"+e)}}},customUserData:function(){return{get:function(){return t._get(r+"/custom_user_data")},update:function(e){return t._patch(r+"/custom_user_data",{body:JSON.stringify(e)})}}},debug:function(){return{executeFunction:function(e){for(var n=arguments.length,i=Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t._post(r+"/debug/execute_function",{name:s,arguments:i},{user_id:e})},executeFunctionSource:function(e){var n=e.userId,i=e.source,o=void 0===i?"":i,s=e.evalSource,u=void 0===s?"":s,a=e.runAsSystem;return t._post(r+"/debug/execute_function_source",{source:o,eval_source:u},{user_id:n,run_as_system:a})}}},authProviders:function(){return{list:function(){return t._get(r+"/auth_providers")},create:function(e){return t._post(r+"/auth_providers",e)},authProvider:function(e){return{get:function(){return t._get(r+"/auth_providers/"+e)},update:function(n){return t._patch(r+"/auth_providers/"+e,{body:JSON.stringify(n)})},enable:function(){return t._put(r+"/auth_providers/"+e+"/enable")},disable:function(){return t._put(r+"/auth_providers/"+e+"/disable")},remove:function(){return t._delete(r+"/auth_providers/"+e)}}}}},security:function(){return{allowedRequestOrigins:function(){return{get:function(){return t._get(r+"/security/allowed_request_origins")},update:function(e){return t._post(r+"/security/allowed_request_origins",e)}}}}},logs:function(){return{list:function(e){return t._get(r+"/logs",e)}}},apiKeys:function(){return{list:function(){return t._get(r+"/api_keys")},create:function(e){return t._post(r+"/api_keys",e)},apiKey:function(e){return{get:function(){return t._get(r+"/api_keys/"+e)},remove:function(){return t._delete(r+"/api_keys/"+e)},enable:function(){return t._put(r+"/api_keys/"+e+"/enable")},disable:function(){return t._put(r+"/api_keys/"+e+"/disable")}}}}},functions:function(){return{list:function(){return t._get(r+"/functions")},create:function(e){return t._post(r+"/functions",e)},function:function(e){return{get:function(){return t._get(r+"/functions/"+e)},update:function(n){return t._put(r+"/functions/"+e,{body:JSON.stringify(n)})},remove:function(){return t._delete(r+"/functions/"+e)}}}}},eventSubscriptions:function(){return{list:function(e){return t._get(r+"/event_subscriptions",e)},create:function(e){return t._post(r+"/event_subscriptions",e)},eventSubscription:function(e){return{get:function(){return t._get(r+"/event_subscriptions/"+e)},update:function(n){return t._put(r+"/event_subscriptions/"+e,{body:JSON.stringify(n)})},remove:function(){return t._delete(r+"/event_subscriptions/"+e)},resume:function(n){return t._put(r+"/event_subscriptions/"+e+"/resume",{body:JSON.stringify(n)})}}}}},validationSettings:function(){var e=r+"/validation_settings";return{graphql:function(){var n=e+"/graphql";return{get:function(){return t._get(n)},update:function(e){return t._put(n,{body:JSON.stringify(e)})}}}}},graphql:function(){var e=r+"/graphql";return{post:function(n){return t._post(""+e,n)},validate:function(){return t._get(e+"/validate")},customResolvers:function(){return{list:function(){return t._get(e+"/custom_resolvers")},create:function(n){return t._post(e+"/custom_resolvers",n)},customResolver:function(n){return{get:function(){return t._get(e+"/custom_resolvers/"+n)},update:function(r){return t._put(e+"/custom_resolvers/"+n,{body:JSON.stringify(r)})},remove:function(){return t._delete(e+"/custom_resolvers/"+n)}}}}}}},sync:function(){var e=r+"/sync";return{config:function(){var n=e+"/config";return{get:function(){return t._get(n)},update:function(e){return t._put(n,{body:JSON.stringify(e)})}}},clientSchemas:function(){var n=e+"/client_schemas";return{get:function(e,r){return t._get(n+"/"+e,r)}}}}}}}}}},{key:"privateAdminTriggers",value:function(e,t){var n=this._v1[y.API_TYPE_PRIVATE],r="/admin/groups/"+e+"/apps/"+t+"/triggers";return{list:function(){return n._get(r)},get:function(e){return n._get(r+"/"+e)}}}},{key:"type",get:function(){return d.default}},{key:"_v1",get:function(){var e=this,n=function(n,r,i){return a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_do",e).call(e,n,r,Object.assign({},{apiVersion:y.v1,apiType:y.API_TYPE_PRIVATE},i)).then(function(e){return(e.headers.get("content-type")||"").split(",").indexOf("application/json")>=0?e.json():e})};return i({},y.API_TYPE_PRIVATE,{_get:function(e,t,r,i){return n(e,"GET",Object.assign({},{queryParams:t,headers:r},i))}})}},{key:"_v3",get:function(){var e=this,n=function(n,r,i){return a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_do",e).call(e,n,r,Object.assign({},{apiVersion:y.v3},i)).then(function(e){return(e.headers.get("content-type")||"").split(",").indexOf("application/json")>=0?e.json():e})};return{_get:function(e,t,r,i){return n(e,"GET",Object.assign({},{queryParams:t,headers:r},i))},_put:function(e,t){return t?n(e,"PUT",t):n(e,"PUT")},_patch:function(e,t){return t?n(e,"PATCH",t):n(e,"PATCH")},_delete:function(e,t){return t?n(e,"DELETE",{queryParams:t}):n(e,"DELETE")},_post:function(e,t,r){return r?n(e,"POST",{body:JSON.stringify(t),queryParams:r}):n(e,"POST",{body:JSON.stringify(t)})},_postRaw:function(e,t){return n(e,"POST",t)}}}}]),t}(h.StitchClient))},function(e,t,n){var r,i,o;!function(s){"use strict";if("object"==typeof t&&null!=t&&"number"!=typeof t.nodeType)e.exports=s();else if(null!=n(39))i=[],r=s,void 0!==(o="function"==typeof r?r.apply(t,i):r)&&(e.exports=o);else{var u=s(),a="undefined"!=typeof self?self:$.global;"function"!=typeof a.btoa&&(a.btoa=u.btoa),"function"!=typeof a.atob&&(a.atob=u.atob)}}(function(){"use strict";function e(e){this.message=e}function t(t){for(var n,i,o=String(t),s=0,u=r,a="";o.charAt(0|s)||(u="=",s%1);a+=u.charAt(63&n>>8-s%1*8)){if((i=o.charCodeAt(s+=.75))>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");n=n<<8|i}return a}function n(t){var n=String(t).replace(/[=]+$/,"");if(n.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,o,s=0,u=0,a="";o=n.charAt(u++);~o&&(i=s%4?64*i+o:o,s++%4)?a+=String.fromCharCode(255&i>>(-2*s&6)):0)o=r.indexOf(o);return a}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return e.prototype=new Error,e.prototype.name="InvalidCharacterError",{btoa:t,atob:n}})},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t,n){var r=Object.create(v.prototype),i=void 0;return i=e&&""!==e.clientAppID?"client."+e.clientAppID:"admin",n=Object.assign({codec:p.APP_CLIENT_CODEC,namespace:i,storageType:"localStorage"},n),r.client=e,r.rootUrl=t,r.codec=n.codec,r.requestOrigin=n.requestOrigin,r.platform=n.platform||y,r.storage=(0,f.createStorage)(n),r.providers=(0,c.createProviders)(r,n),Promise.all([r._get(),r.storage.get(p.REFRESH_TOKEN_KEY),r.storage.get(p.USER_LOGGED_IN_PT_KEY),r.storage.get(p.DEVICE_ID_KEY)]).then(function(e){var t=u(e,4),n=t[0],i=t[1],o=t[2],s=t[3];return r.auth=n,r.authedId=n.userId,r.rt=i,r.loggedInProviderType=o,r.deviceId=s,r})}Object.defineProperty(t,"__esModule",{value:!0}),t.Auth=t.AuthFactory=void 0;var u=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.newAuth=s;var f=n(15),c=n(8),l=n(3),h=n(1),p=r(h),d=n(2),_=r(d),g=n(26),y=r(g),b=n(34),v=(t.AuthFactory=function(){function e(){throw o(this,e),new l.StitchError("Auth can only be made from the AuthFactory.create function")}return a(e,null,[{key:"create",value:function(e,t,n){return s(e,t,n)}}]),e}(),t.Auth=function(){function e(t,n,r){throw o(this,e),new l.StitchError("Auth can only be made from the AuthFactory.create function")}return a(e,[{key:"getDeviceInfo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r={appId:t,appVersion:n,sdkVersion:_.SDK_VERSION};return e&&(r.deviceId=e),this.platform&&(r.platform=this.platform.name,r.platformVersion=this.platform.version),r}},{key:"provider",value:function(e){if(!this.providers.hasOwnProperty(e))throw new Error("Invalid auth provider specified: "+e);return this.providers[e]}},{key:"refreshToken",value:function(){var e=this;return this.client.doSessionPost().then(function(t){return e.set(t)})}},{key:"pageRootUrl",value:function(){return[window.location.protocol,"//",window.location.host,window.location.pathname].join("")}},{key:"error",value:function(){return this._error}},{key:"isAppClient",value:function(){return!this.client||this.client.type===_.APP_CLIENT_TYPE}},{key:"handleRedirect",value:function(){var e=this;if("undefined"!=typeof window&&window.location&&window.location.hash)return Promise.all([this.storage.get(p.STATE_KEY),this.storage.get(p.STITCH_REDIRECT_PROVIDER)]).then(function(t){var n=u(t,2),r=n[0],i=n[1],o=window.location.hash.substring(1),s=e.parseRedirectFragment(o,r);return s.lastError||s.found&&!i?(console.error("StitchClient: error from redirect: "+(s.lastError?s.lastError:"provider type not set")),e._error=s.lastError,window.history.replaceState(null,"",e.pageRootUrl()),Promise.reject()):s.found?Promise.all([e.storage.remove(p.STATE_KEY),e.storage.remove(p.STITCH_REDIRECT_PROVIDER)]).then(function(){return{redirectState:s,redirectProvider:i}}):Promise.reject()}).then(function(t){var n=t.redirectState,r=t.redirectProvider;return n.stateValid?n.ua?e.set(n.ua,r):void console.error("StitchClient: no UA value was returned from redirect!"):(console.error("StitchClient: state values did not match!"),void window.history.replaceState(null,"",e.pageRootUrl()))}).then(function(){return window.history.replaceState(null,"",e.pageRootUrl())}).catch(function(e){if(e)throw e})}},{key:"getCookie",value:function(e){for(var t=document.cookie.split(" "),n=0;n<t.length;n++){var r=t[n],i=r.indexOf("=");if(r.substring(0,i)===e){var o=r.substring(i+1,r.length);return";"===o[o.length-1]?o.substring(0,o.length-1):o}}}},{key:"handleCookie",value:function(){var e=this;if("undefined"!=typeof window&&"undefined"!=typeof document&&document.cookie){var t=this.getCookie(p.USER_AUTH_COOKIE_NAME);if(t){document.cookie=p.USER_AUTH_COOKIE_NAME+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT;";var n=this.unmarshallUserAuth(t);return this.set(n,c.PROVIDER_TYPE_MONGODB_CLOUD).then(function(){return window.history.replaceState(null,"",e.pageRootUrl())})}}}},{key:"clear",value:function(){return this.auth=null,this.authedId=null,this.rt=null,this.loggedInProviderType=null,Promise.all([this.storage.remove(p.USER_AUTH_KEY),this.storage.remove(p.REFRESH_TOKEN_KEY),this.storage.remove(p.USER_LOGGED_IN_PT_KEY),this.storage.remove(p.STITCH_REDIRECT_PROVIDER)])}},{key:"getDeviceId",value:function(){return this.deviceId}},{key:"isAccessTokenExpired",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.DEFAULT_ACCESS_TOKEN_EXPIRE_WITHIN_SECS,t=this.getAccessToken();if(!t)return!1;var n=void 0;try{n=b(t)}catch(e){return!1}return!!n&&(n.exp&&Math.floor(Date.now()/1e3)>=n.exp-e)}},{key:"getAccessToken",value:function(){return this.auth.accessToken}},{key:"getRefreshToken",value:function(){return this.rt}},{key:"set",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e){var r={},i=[];return n&&(this.loggedInProviderType=n,i.push(this.storage.set(p.USER_LOGGED_IN_PT_KEY,n))),e[this.codec.refreshToken]&&(this.rt=e[this.codec.refreshToken],delete e[this.codec.refreshToken],i.push(this.storage.set(p.REFRESH_TOKEN_KEY,this.rt))),e[this.codec.deviceId]&&(this.deviceId=e[this.codec.deviceId],delete e[this.codec.deviceId],i.push(this.storage.set(p.DEVICE_ID_KEY,this.deviceId))),e[this.codec.accessToken]&&(r.accessToken=e[this.codec.accessToken]),e[this.codec.userId]&&(r.userId=e[this.codec.userId]),this.auth=Object.assign(this.auth?this.auth:{},r),this.authedId=this.auth.userId,i.push(this.storage.set(p.USER_AUTH_KEY,JSON.stringify(this.auth))),Promise.all(i).then(function(){return t.auth})}}},{key:"_get",value:function(){var e=this;return this.storage.get(p.USER_AUTH_KEY).then(function(t){if(!t)return{};try{return JSON.parse(t)}catch(t){return e.clear().then(function(){throw new l.StitchError("Failure retrieving stored auth")})}})}},{key:"getLoggedInProviderType",value:function(){return this.loggedInProviderType}},{key:"parseRedirectFragment",value:function(e,t){for(var n=e.split("&"),r={ua:null,found:!1,stateValid:!1,lastError:null},i=!1,o=0;o<n.length&&!i;++o){var s=n[o].split("=");switch(decodeURIComponent(s[0])){case p.STITCH_ERROR_KEY:r.lastError=decodeURIComponent(s[1]),r.found=!0,i=!0;break;case p.USER_AUTH_KEY:try{r.ua=this.unmarshallUserAuth(decodeURIComponent(s[1])),r.found=!0}catch(e){r.lastError=e}continue;case p.STITCH_LINK_KEY:r.found=!0;continue;case p.STATE_KEY:r.found=!0;var u=decodeURIComponent(s[1]);t&&t===u&&(r.stateValid=!0);continue;default:continue}}return r}},{key:"unmarshallUserAuth",value:function(e){var t,n=e.split("$");if(4!==n.length)throw new RangeError("invalid user auth data provided: "+e);return t={},i(t,this.codec.accessToken,n[0]),i(t,this.codec.refreshToken,n[1]),i(t,this.codec.userId,n[2]),i(t,this.codec.deviceId,n[3]),t}},{key:"fetchArgsWithLink",value:function(e,t){return t&&(e.headers.Authorization="Bearer "+this.getAccessToken()),e}}]),e}())},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){switch(e){case null:case void 0:var n=[u.USER_AUTH_KEY,u.REFRESH_TOKEN_KEY,u.DEVICE_ID_KEY,u.STATE_KEY].map(function(e){return Promise.resolve(t.store.getItem(e)).then(function(n){return!!n&&t.store.setItem(t._generateKey(e),n)}).then(function(){return t.store.removeItem(e)})});return Promise.all(n).then(function(){return t.store.setItem(c,f)})}}function o(e){var t=e.storageType,n=e.storage,r=e.namespace;if("localStorage"===t){if("undefined"!=typeof window&&"localStorage"in window&&null!==window.localStorage)return new l(window.localStorage,r)}else if("sessionStorage"===t){if("undefined"!=typeof window&&"sessionStorage"in window&&null!==window.sessionStorage)return new l(window.sessionStorage,r)}else if("customStorage"==t)return new l(n,r);return new l(new a,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryStorage=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.createStorage=o;var u=n(1),a=t.MemoryStorage=function(){function e(){r(this,e),this._data={},this._orderedKeys=[],this.length=0}return s(e,[{key:"getItem",value:function(e){return e in this._data?this._data[e]:null}},{key:"setItem",value:function(e,t){return this._orderedKeys.push(e),this._data[e]=t,this.length++,this._data[e]}},{key:"removeItem",value:function(e){this._orderedKeys.pop(e),delete this._data[e],this.length--}},{key:"key",value:function(e){return this._orderedKeys[e]}}]),e}(),f=1,c="__stitch_storage_version__",l=function(){function e(t,n){var o=this;r(this,e),this.store=t,this.namespace="_stitch."+n,this._migration=Promise.resolve(this.store.getItem(c)).then(function(e){return i(e,o)})}return s(e,[{key:"_generateKey",value:function(e){return this.namespace+"."+e}},{key:"get",value:function(e){var t=this;return Promise.resolve(this._migration).then(function(){return t.store.getItem(t._generateKey(e))})}},{key:"set",value:function(e,t){var n=this;return Promise.resolve(this._migration).then(function(){return n.store.setItem(n._generateKey(e),t)}).then(function(){return t})}},{key:"remove",value:function(e){var t=this;return Promise.resolve(this._migration).then(function(){return t.store.removeItem(t._generateKey(e))})}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BSON=t.StitchAdminClientFactory=t.StitchClientFactory=void 0;var r=n(5),i=n(12),o=n(6);t.StitchClientFactory=r.StitchClientFactory,t.StitchAdminClientFactory=i.StitchAdminClientFactory,t.BSON=o.BSON},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),s=function(){function e(t,n){r(this,e),this.client=t,this.serviceName=n}return i(e,[{key:"put",value:function(e,t,n,r,i){return(0,o.serviceResponse)(this,{action:"put",args:{bucket:e,key:t,acl:n,contentType:r,body:i}})}},{key:"signPolicy",value:function(e,t,n,r){return(0,o.serviceResponse)(this,{action:"signPolicy",args:{bucket:e,key:t,acl:n,contentType:r}})}}]),e}();t.default=s,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),s=function(){function e(t,n){r(this,e),this.client=t,this.serviceName=n}return i(e,[{key:"send",value:function(e,t,n,r){return(0,o.serviceResponse)(this,{action:"send",args:{fromAddress:e,toAddress:t,subject:n,body:r}})}}]),e}();t.default=s,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){var n=void 0;return"string"!=typeof e?n=e:(n={url:e},t.authUrl&&(n.authUrl=t.authUrl)),n}function o(e,t,n){return(0,u.serviceResponse)(t,{action:e,args:n})}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(0),a=function(){function e(t,n){r(this,e),this.client=t,this.serviceName=n}return s(e,[{key:"get",value:function(e){return o("get",this,i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}},{key:"post",value:function(e){return o("post",this,i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}},{key:"put",value:function(e){return o("put",this,i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}},{key:"patch",value:function(e){return o("patch",this,i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}},{key:"delete",value:function(e){return o("delete",this,i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}},{key:"head",value:function(e){return o("head",this,i(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}}]),e}();t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(17),o=r(i),s=n(18),u=r(s),a=n(19),f=r(a),c=n(23),l=r(c),h=n(24),p=r(h);t.default={"aws-s3":o.default,"aws-ses":u.default,aws_s3:o.default,aws_ses:u.default,http:f.default,mongodb:l.default,twilio:p.default},e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=t?"updateMany":"updateOne",s=void 0;return!t&&i.upsert&&(s={upsert:!0}),a(o,e,u(e,{query:n,update:r},s))}function o(e){var t=e.service;return a("find",t,u(t,{query:e.query,project:e.project,limit:e.limit,sort:e.sort}))}function s(e,t){return a("aggregate",e,u(e,{pipeline:t}))}function u(e,t){var n=e.db.name,r=e.name,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object.assign({database:n,collection:r},t,i)}function a(e,t,n){return(0,l.serviceResponse)(t.db,{serviceName:t.db.service,action:e,args:n})}function f(e,t,n){return this instanceof f?(this.service=e,this.query=t,this.project=n,this):new f(e,t,n)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),h=function(){function e(t,n){r(this,e),this.db=t,this.name=n}return c(e,[{key:"insertOne",value:function(e){return a("insertOne",this,u(this,{document:e}))}},{key:"insertMany",value:function(e){return a("insertMany",this,u(this,{documents:Array.isArray(e)?e:[e]}))}},{key:"deleteOne",value:function(e){return a("deleteOne",this,u(this,{query:e}))}},{key:"deleteMany",value:function(e){return a("deleteMany",this,u(this,{query:e}))}},{key:"updateOne",value:function(e,t){return i(this,!1,e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}},{key:"updateMany",value:function(e,t){return i(this,!0,e,t)}},{key:"find",value:function(e,t){return new f(this,e,t)}},{key:"findOne",value:function(e,t){return a("findOne",this,u(this,{query:e,project:t}))}},{key:"aggregate",value:function(e){return s(this,e)}},{key:"count",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0;return t.limit&&(n={limit:t.limit}),a("count",this,u(this,{count:!0,query:e},n))}}]),e}();f.prototype.limit=function(e){return this.limit=e,this},f.prototype.sort=function(e){return this.sort=e,this},f.prototype.execute=function(e){return o(this)},t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(21),s=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(){function e(t,n,i){r(this,e),this.client=t,this.service=n,this.name=i}return i(e,[{key:"collection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new s.default(this,e,t)}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(22),s=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(){function e(t,n){r(this,e),this.stitchClient=t,this.serviceName=n}return i(e,[{key:"db",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new s.default(this.stitchClient,this.serviceName,e)}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),s=function(){function e(t,n){r(this,e),this.client=t,this.serviceName=n}return i(e,[{key:"send",value:function(e,t,n){return(0,o.serviceResponse)(this,{action:"send",args:{from:e,to:t,body:n}})}}]),e}();t.default=s,e.exports=t.default},function(e,t,n){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function i(e){var t=r(e),n=t[0],i=t[1];return 3*(n+i)/4-i}function o(e,t,n){return 3*(t+n)/4-n}function s(e){var t,n,i=r(e),s=i[0],u=i[1],a=new h(o(e,s,u)),f=0,c=u>0?s-4:s;for(n=0;n<c;n+=4)t=l[e.charCodeAt(n)]<<18|l[e.charCodeAt(n+1)]<<12|l[e.charCodeAt(n+2)]<<6|l[e.charCodeAt(n+3)],a[f++]=t>>16&255,a[f++]=t>>8&255,a[f++]=255&t;return 2===u&&(t=l[e.charCodeAt(n)]<<2|l[e.charCodeAt(n+1)]>>4,a[f++]=255&t),1===u&&(t=l[e.charCodeAt(n)]<<10|l[e.charCodeAt(n+1)]<<4|l[e.charCodeAt(n+2)]>>2,a[f++]=t>>8&255,a[f++]=255&t),a}function u(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function a(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(u(r));return i.join("")}function f(e){for(var t,n=e.length,r=n%3,i=[],o=0,s=n-r;o<s;o+=16383)i.push(a(e,o,o+16383>s?s:o+16383));return 1===r?(t=e[n-1],i.push(c[t>>2]+c[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],i.push(c[t>>10]+c[t>>4&63]+c[t<<2&63]+"=")),i.join("")}t.byteLength=i,t.toByteArray=s,t.fromByteArray=f;for(var c=[],l=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,_=p.length;d<_;++d)c[d]=p[d],l[p.charCodeAt(d)]=d;l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},function(e,t,n){var r,i=n(27);"undefined"!=typeof navigator&&navigator&&(r=navigator.userAgent),e.exports=i(r)},function(e,t,n){var r=n(28);e.exports=function(e){return e?[["edge",/Edge\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/]].map(function(t){if(t[1].test(e)){var n=t[1].exec(e),i=n&&n[1].split(/[._]/).slice(0,3);return i&&i.length<3&&Array.prototype.push.apply(i,1==i.length?[0,0]:[0]),{name:t[0],version:i.join("."),os:r(e)}}}).filter(Boolean).shift():null}},function(e,t){e.exports=function(e){var t=[{name:"iOS",rule:/iP(hone|od|ad)/},{name:"Android OS",rule:/Android/},{name:"BlackBerry OS",rule:/BlackBerry|BB10/},{name:"Windows Mobile",rule:/IEMobile/},{name:"Amazon OS",rule:/Kindle/},{name:"Windows 3.11",rule:/Win16/},{name:"Windows 95",rule:/(Windows 95)|(Win95)|(Windows_95)/},{name:"Windows 98",rule:/(Windows 98)|(Win98)/},{name:"Windows 2000",rule:/(Windows NT 5.0)|(Windows 2000)/},{name:"Windows XP",rule:/(Windows NT 5.1)|(Windows XP)/},{name:"Windows Server 2003",rule:/(Windows NT 5.2)/},{name:"Windows Vista",rule:/(Windows NT 6.0)/},{name:"Windows 7",rule:/(Windows NT 6.1)/},{name:"Windows 8",rule:/(Windows NT 6.2)/},{name:"Windows 8.1",rule:/(Windows NT 6.3)/},{name:"Windows 10",rule:/(Windows NT 10.0)/},{name:"Windows ME",rule:/Windows ME/},{name:"Open BSD",rule:/OpenBSD/},{name:"Sun OS",rule:/SunOS/},{name:"Linux",rule:/(Linux)|(X11)/},{name:"Mac OS",rule:/(Mac_PowerPC)|(Macintosh)/},{name:"QNX",rule:/QNX/},{name:"BeOS",rule:/BeOS/},{name:"OS/2",rule:/OS\/2/},{name:"Search Bot",rule:/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/}],n=t.filter(function(t){if(e.match(t.rule))return!0});return n&&n[0]?n[0].name:null}},function(e,t){e.exports="object"==typeof self?self.FormData:window.FormData},function(e,t){t.read=function(e,t,n,r,i){var o,s,u=8*i-r-1,a=(1<<u)-1,f=a>>1,c=-7,l=n?i-1:0,h=n?-1:1,p=e[t+l];for(l+=h,o=p&(1<<-c)-1,p>>=-c,c+=u;c>0;o=256*o+e[t+l],l+=h,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;c>0;s=256*s+e[t+l],l+=h,c-=8);if(0===o)o=1-f;else{if(o===a)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=f}return(p?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,u,a,f=8*o-i-1,c=(1<<f)-1,l=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,_=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(a=Math.pow(2,-s))<1&&(s--,a*=2),t+=s+l>=1?h/a:h*Math.pow(2,1-l),t*a>=2&&(s++,a/=2),s+l>=c?(u=0,s=c):s+l>=1?(u=(t*a-1)*Math.pow(2,i),s+=l):(u=t*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;e[n+p]=255&u,p+=d,u/=256,i-=8);for(s=s<<i|u,f+=i;f>0;e[n+p]=255&s,p+=d,s/=256,f-=8);e[n+p-d]|=128*_}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){function n(e){this.message=e}function r(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,o,s=0,u=0,a="";o=t.charAt(u++);~o&&(r=s%4?64*r+o:o,s++%4)?a+=String.fromCharCode(255&r>>(-2*s&6)):0)o=i.indexOf(o);return a}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||r},function(e,t,n){function r(e){return decodeURIComponent(i(e).replace(/(.)/g,function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}var i=n(32);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return r(t)}catch(e){return i(t)}}},function(e,t,n){"use strict";function r(e){this.message=e}var i=n(33);r.prototype=new Error,r.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new r("Invalid token specified");t=t||{};var n=!0===t.header?0:1;try{return JSON.parse(i(e.split(".")[n]))}catch(e){throw new r("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=r},function(e,t){function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}function i(e,t){var n,r,i;return t?(e>>>=0,(i=0<=e&&e<256)&&(r=l[e])?r:(n=s(e,(0|e)<0?-1:0,!0),i&&(l[e]=n),n)):(e|=0,(i=-128<=e&&e<128)&&(r=c[e])?r:(n=s(e,e<0?-1:0,!1),i&&(c[e]=n),n))}function o(e,t){if(isNaN(e))return t?b:y;if(t){if(e<0)return b;if(e>=d)return O}else{if(e<=-_)return N;if(e+1>=_)return E}return e<0?o(-e,t).neg():s(e%p|0,e/p|0,t)}function s(e,t,r){return new n(e,t,r)}function u(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return y;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return u(e.substring(1),t,n).neg();for(var i=o(h(n,8)),s=y,a=0;a<e.length;a+=8){var f=Math.min(8,e.length-a),c=parseInt(e.substring(a,a+f),n);if(f<8){var l=o(h(n,f));s=s.mul(l).add(o(c))}else s=s.mul(i),s=s.add(o(c))}return s.unsigned=t,s}function a(e,t){return"number"==typeof e?o(e,t):"string"==typeof e?u(e,t):s(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}e.exports=n;var f=null;try{f=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var c={},l={};n.fromInt=i,n.fromNumber=o,n.fromBits=s;var h=Math.pow;n.fromString=u,n.fromValue=a;var p=4294967296,d=p*p,_=d/2,g=i(1<<24),y=i(0);n.ZERO=y;var b=i(0,!0);n.UZERO=b;var v=i(1);n.ONE=v;var m=i(1,!0);n.UONE=m;var S=i(-1);n.NEG_ONE=S;var E=s(-1,2147483647,!1);n.MAX_VALUE=E;var O=s(-1,-1,!0);n.MAX_UNSIGNED_VALUE=O;var N=s(0,-2147483648,!1);n.MIN_VALUE=N;var A=n.prototype;A.toInt=function(){return this.unsigned?this.low>>>0:this.low},A.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},A.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(N)){var t=o(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=o(h(e,6),this.unsigned),s=this,u="";;){var a=s.div(i),f=s.sub(a.mul(i)).toInt()>>>0,c=f.toString(e);if(s=a,s.isZero())return c+u;for(;c.length<6;)c="0"+c;u=""+c+u}},A.getHighBits=function(){return this.high},A.getHighBitsUnsigned=function(){return this.high>>>0},A.getLowBits=function(){return this.low},A.getLowBitsUnsigned=function(){return this.low>>>0},A.getNumBitsAbs=function(){if(this.isNegative())return this.eq(N)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},A.isZero=function(){return 0===this.high&&0===this.low},A.eqz=A.isZero,A.isNegative=function(){return!this.unsigned&&this.high<0},A.isPositive=function(){return this.unsigned||this.high>=0},A.isOdd=function(){return 1==(1&this.low)},A.isEven=function(){return 0==(1&this.low)},A.equals=function(e){return r(e)||(e=a(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},A.eq=A.equals,A.notEquals=function(e){return!this.eq(e)},A.neq=A.notEquals,A.ne=A.notEquals,A.lessThan=function(e){return this.comp(e)<0},A.lt=A.lessThan,A.lessThanOrEqual=function(e){return this.comp(e)<=0},A.lte=A.lessThanOrEqual,A.le=A.lessThanOrEqual,A.greaterThan=function(e){return this.comp(e)>0},A.gt=A.greaterThan,A.greaterThanOrEqual=function(e){return this.comp(e)>=0},A.gte=A.greaterThanOrEqual,A.ge=A.greaterThanOrEqual,A.compare=function(e){if(r(e)||(e=a(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},A.comp=A.compare,A.negate=function(){return!this.unsigned&&this.eq(N)?N:this.not().add(v)},A.neg=A.negate,A.add=function(e){r(e)||(e=a(e));var t=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,u=e.high>>>16,f=65535&e.high,c=e.low>>>16,l=65535&e.low,h=0,p=0,d=0,_=0;return _+=o+l,d+=_>>>16,_&=65535,d+=i+c,p+=d>>>16,d&=65535,p+=n+f,h+=p>>>16,p&=65535,h+=t+u,h&=65535,s(d<<16|_,h<<16|p,this.unsigned)},A.subtract=function(e){return r(e)||(e=a(e)),this.add(e.neg())},A.sub=A.subtract,A.multiply=function(e){if(this.isZero())return y;if(r(e)||(e=a(e)),f){return s(f.mul(this.low,this.high,e.low,e.high),f.get_high(),this.unsigned)}if(e.isZero())return y;if(this.eq(N))return e.isOdd()?N:y;if(e.eq(N))return this.isOdd()?N:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return o(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,i=this.low>>>16,u=65535&this.low,c=e.high>>>16,l=65535&e.high,h=e.low>>>16,p=65535&e.low,d=0,_=0,b=0,v=0;return v+=u*p,b+=v>>>16,v&=65535,b+=i*p,_+=b>>>16,b&=65535,b+=u*h,_+=b>>>16,b&=65535,_+=n*p,d+=_>>>16,_&=65535,_+=i*h,d+=_>>>16,_&=65535,_+=u*l,d+=_>>>16,_&=65535,d+=t*p+n*h+i*l+u*c,d&=65535,s(b<<16|v,d<<16|_,this.unsigned)},A.mul=A.multiply,A.divide=function(e){if(r(e)||(e=a(e)),e.isZero())throw Error("division by zero");if(f){if(!this.unsigned&&-2147483648===this.high&&-1===e.low&&-1===e.high)return this;return s((this.unsigned?f.div_u:f.div_s)(this.low,this.high,e.low,e.high),f.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?b:y;var t,n,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return b;if(e.gt(this.shru(1)))return m;i=b}else{if(this.eq(N)){if(e.eq(v)||e.eq(S))return N;if(e.eq(N))return v;return t=this.shr(1).div(e).shl(1),t.eq(y)?e.isNegative()?v:S:(n=this.sub(e.mul(t)),i=t.add(n.div(e)))}if(e.eq(N))return this.unsigned?b:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=y}for(n=this;n.gte(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var u=Math.ceil(Math.log(t)/Math.LN2),c=u<=48?1:h(2,u-48),l=o(t),p=l.mul(e);p.isNegative()||p.gt(n);)t-=c,l=o(t,this.unsigned),p=l.mul(e);l.isZero()&&(l=v),i=i.add(l),n=n.sub(p)}return i},A.div=A.divide,A.modulo=function(e){if(r(e)||(e=a(e)),f){return s((this.unsigned?f.rem_u:f.rem_s)(this.low,this.high,e.low,e.high),f.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))},A.mod=A.modulo,A.rem=A.modulo,A.not=function(){return s(~this.low,~this.high,this.unsigned)},A.and=function(e){return r(e)||(e=a(e)),s(this.low&e.low,this.high&e.high,this.unsigned)},A.or=function(e){return r(e)||(e=a(e)),s(this.low|e.low,this.high|e.high,this.unsigned)},A.xor=function(e){return r(e)||(e=a(e)),s(this.low^e.low,this.high^e.high,this.unsigned)},A.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?s(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):s(0,this.low<<e-32,this.unsigned)},A.shl=A.shiftLeft,A.shiftRight=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?s(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):s(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},A.shr=A.shiftRight,A.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;if(e<32){return s(this.low>>>e|t<<32-e,t>>>e,this.unsigned)}return 32===e?s(t,0,this.unsigned):s(t>>>e-32,0,this.unsigned)},A.shru=A.shiftRightUnsigned,A.shr_u=A.shiftRightUnsigned,A.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},A.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},A.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},A.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},A.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},function(e,t,n){"use strict";function r(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,u,a=r(e),f=1;f<arguments.length;f++){n=Object(arguments[f]);for(var c in n)o.call(n,c)&&(a[c]=n[c]);if(i){u=i(n);for(var l=0;l<u.length;l++)s.call(n,u[l])&&(a[u[l]]=n[u[l]])}}return a}},function(e,t,n){"use strict";function r(e){switch(e.arrayFormat){case"index":return function(t,n,r){return null===n?[o(t,e),"[",r,"]"].join(""):[o(t,e),"[",o(r,e),"]=",o(n,e)].join("")};case"bracket":return function(t,n){return null===n?o(t,e):[o(t,e),"[]=",o(n,e)].join("")};default:return function(t,n){return null===n?o(t,e):[o(t,e),"=",o(n,e)].join("")}}}function i(e){var t;switch(e.arrayFormat){case"index":return function(e,n,r){if(t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),!t)return void(r[e]=n);void 0===r[e]&&(r[e]={}),r[e][t[1]]=n};case"bracket":return function(e,n,r){return t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0===r[e]?void(r[e]=[n]):void(r[e]=[].concat(r[e],n)):void(r[e]=n)};default:return function(e,t,n){if(void 0===n[e])return void(n[e]=t);n[e]=[].concat(n[e],t)}}}function o(e,t){return t.encode?t.strict?u(e):encodeURIComponent(e):e}function s(e){return Array.isArray(e)?e.sort():"object"==typeof e?s(Object.keys(e)).sort(function(e,t){return Number(e)-Number(t)}).map(function(t){return e[t]}):e}var u=n(38),a=n(36);t.extract=function(e){return e.split("?")[1]||""},t.parse=function(e,t){t=a({arrayFormat:"none"},t);var n=i(t),r=Object.create(null);return"string"!=typeof e?r:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach(function(e){var t=e.replace(/\+/g," ").split("="),i=t.shift(),o=t.length>0?t.join("="):void 0;o=void 0===o?null:decodeURIComponent(o),n(decodeURIComponent(i),o,r)}),Object.keys(r).sort().reduce(function(e,t){var n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=s(n):e[t]=n,e},Object.create(null))):r},t.stringify=function(e,t){t=a({encode:!0,strict:!0,arrayFormat:"none"},t);var n=r(t);return e?Object.keys(e).sort().map(function(r){var i=e[r];if(void 0===i)return"";if(null===i)return o(r,t);if(Array.isArray(i)){var s=[];return i.slice().forEach(function(e){void 0!==e&&s.push(n(r,e,s.length))}),s.join("&")}return o(r,t)+"="+o(i,t)}).filter(function(e){return e.length>0}).join("&"):""}},function(e,t,n){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}},function(e,t){(function(t){e.exports=t}).call(t,{})}])});
//# sourceMappingURL=stitch.min.js.map