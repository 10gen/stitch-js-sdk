{"version":3,"sources":["webpack:///baas.min.js","webpack:///webpack/bootstrap 304b7807bbba57e3d9c5?dea4","webpack:///./distribution/client.js?77eb","webpack:///./~/whatwg-fetch/fetch.js?1c20"],"names":["Baas","modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","Admin","MongoClient","BaasClient","Auth","BaasError","parseRedirectFragment","ErrInvalidSession","ErrAuthProviderNotFound","undefined","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","USER_AUTH_KEY","REFRESH_TOKEN_KEY","STATE_KEY","BAAS_ERROR_KEY","BAAS_LINK_KEY","IMPERSONATION_ACTIVE_KEY","IMPERSONATION_USER_KEY","IMPERSONATION_REAL_USER_AUTH_KEY","DEFAULT_BAAS_SERVER_URL","JSONTYPE","stateLength","toQueryString","obj","parts","hasOwnProperty","push","encodeURIComponent","join","checkStatus","response","status","error","Error","statusText","fragment","ourState","vars","split","result","ua","found","stateValid","lastError","_iteratorNormalCompletion","_didIteratorError","_iteratorError","outerloop","_step","_iterator","Symbol","iterator","next","done","pair","pairParts","pairKey","decodeURIComponent","JSON","parse","window","atob","theirState","err","return","_Error","message","code","this","_this","getPrototypeOf","name","captureStackTrace","stack","rootUrl","location","protocol","host","pathname","token","currAuth","get","localStorage","getItem","set","_error","redirectFragment","hash","substring","redirectState","console","history","replaceState","pageRootUrl","removeItem","providerName","redirectUrl","state","generateState","setItem","encodeURI","username","password","cors","_this2","init","method","headers","Accept","Content-Type","body","stringify","fetch","then","json","Promise","resolve","clearImpersonation","rt","btoa","a","user","_id","client","_this3","userId","_doAuthed","refreshOnFailure","useRefreshToken","catch","e","stopImpersonation","reject","isImpersonatingUser","realUserAuth","refreshImpersonation","root","alpha","pos","Math","floor","random","app","options","baseUrl","appUrl","authUrl","authManager","handleRedirect","replace","getOAuthLoginURL","authedId","_this4","data","clear","resource","url","queryParams","_this5","auth","_refreshToken","_this6","setAccessToken","stages","DB","service","Collection","db","database","collection","query","args","getBaseArgs","singleDoc","executePipeline","action","project","documents","items","update","upsert","multi","makeUpdateStage","baasClient","serviceName","_this7","keys","list","_get","_post","apiKey","keyId","remove","_delete","enable","_put","disable","_this8","_app","users","filter","uid","logout","authProviders","provider","authType","authName","variables","variable","varName","logs","apiKeys","services","svc","setConfig","rules","rule","ruleId","triggers","trigger","triggerId","_this9","startImpersonation","normalizeName","String","test","toLowerCase","normalizeValue","iteratorFor","shift","support","iterable","Headers","map","forEach","append","getOwnPropertyNames","consumed","bodyUsed","fileReaderReady","reader","onload","onerror","readBlobAsArrayBuffer","blob","FileReader","promise","readAsArrayBuffer","readBlobAsText","readAsText","readArrayBufferAsText","buf","view","Uint8Array","chars","Array","fromCharCode","bufferClone","slice","byteLength","buffer","Body","_initBody","_bodyInit","_bodyText","Blob","isPrototypeOf","_bodyBlob","formData","FormData","_bodyFormData","searchParams","URLSearchParams","toString","arrayBuffer","isDataView","_bodyArrayBuffer","ArrayBuffer","isArrayBufferView","type","rejected","text","decode","normalizeMethod","upcased","toUpperCase","methods","indexOf","Request","input","credentials","mode","referrer","form","trim","bytes","parseHeaders","rawHeaders","line","Response","bodyInit","ok","viewClasses","DataView","isView","oldValue","has","callback","thisArg","values","entries","clone","redirectStatuses","redirect","RangeError","request","xhr","XMLHttpRequest","getAllResponseHeaders","responseURL","responseText","ontimeout","open","withCredentials","responseType","setRequestHeader","send","polyfill"],"mappings":"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","file":"baas.min.js","sourcesContent":["var Baas =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.Admin = exports.MongoClient = exports.BaasClient = exports.Auth = exports.BaasError = exports.parseRedirectFragment = exports.ErrInvalidSession = exports.ErrAuthProviderNotFound = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\t__webpack_require__(1);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /* global window, localStorage, fetch */\n\t/* eslint no-labels: ['error', { 'allowLoop': true }] */\n\t\n\t\n\t// fetch polyfill\n\t\n\tvar USER_AUTH_KEY = '_baas_ua';\n\tvar REFRESH_TOKEN_KEY = '_baas_rt';\n\tvar STATE_KEY = '_baas_state';\n\tvar BAAS_ERROR_KEY = '_baas_error';\n\tvar BAAS_LINK_KEY = '_baas_link';\n\tvar IMPERSONATION_ACTIVE_KEY = '_baas_impers_active';\n\tvar IMPERSONATION_USER_KEY = '_baas_impers_user';\n\tvar IMPERSONATION_REAL_USER_AUTH_KEY = '_baas_impers_real_ua';\n\tvar DEFAULT_BAAS_SERVER_URL = 'https://baas-dev.10gen.cc';\n\tvar JSONTYPE = 'application/json';\n\t\n\tvar ErrAuthProviderNotFound = exports.ErrAuthProviderNotFound = 'AuthProviderNotFound';\n\tvar ErrInvalidSession = exports.ErrInvalidSession = 'InvalidSession';\n\tvar stateLength = 64;\n\t\n\tvar toQueryString = function toQueryString(obj) {\n\t  var parts = [];\n\t  for (var i in obj) {\n\t    if (obj.hasOwnProperty(i)) {\n\t      parts.push(encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]));\n\t    }\n\t  }\n\t  return parts.join('&');\n\t};\n\t\n\tvar checkStatus = function checkStatus(response) {\n\t  if (response.status >= 200 && response.status < 300) {\n\t    return response;\n\t  } else {\n\t    var error = new Error(response.statusText);\n\t    error.response = response;\n\t    throw error;\n\t  }\n\t};\n\t\n\tvar parseRedirectFragment = exports.parseRedirectFragment = function parseRedirectFragment(fragment, ourState) {\n\t  // After being redirected from oauth, the URL will look like:\n\t  // https://todo.examples.baas-dev.10gen.cc/#_baas_state=...&_baas_ua=...\n\t  // This function parses out baas-specific tokens from the fragment and\n\t  // builds an object describing the result.\n\t  var vars = fragment.split('&');\n\t  var result = { ua: null, found: false, stateValid: false, lastError: null };\n\t  var _iteratorNormalCompletion = true;\n\t  var _didIteratorError = false;\n\t  var _iteratorError = undefined;\n\t\n\t  try {\n\t    outerloop: for (var _iterator = vars[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t      var pair = _step.value;\n\t\n\t      var pairParts = pair.split('=');\n\t      var pairKey = decodeURIComponent(pairParts[0]);\n\t      switch (pairKey) {\n\t        case BAAS_ERROR_KEY:\n\t          result.lastError = decodeURIComponent(pairParts[1]);\n\t          result.found = true;\n\t          break outerloop;\n\t        case USER_AUTH_KEY:\n\t          result.ua = JSON.parse(window.atob(decodeURIComponent(pairParts[1])));\n\t          result.found = true;\n\t          continue;\n\t        case BAAS_LINK_KEY:\n\t          result.found = true;\n\t          continue;\n\t        case STATE_KEY:\n\t          result.found = true;\n\t          var theirState = decodeURIComponent(pairParts[1]);\n\t          if (ourState && ourState === theirState) {\n\t            result.stateValid = true;\n\t          }\n\t      }\n\t    }\n\t  } catch (err) {\n\t    _didIteratorError = true;\n\t    _iteratorError = err;\n\t  } finally {\n\t    try {\n\t      if (!_iteratorNormalCompletion && _iterator.return) {\n\t        _iterator.return();\n\t      }\n\t    } finally {\n\t      if (_didIteratorError) {\n\t        throw _iteratorError;\n\t      }\n\t    }\n\t  }\n\t\n\t  return result;\n\t};\n\t\n\tvar BaasError = exports.BaasError = function (_Error) {\n\t  _inherits(BaasError, _Error);\n\t\n\t  function BaasError(message, code) {\n\t    _classCallCheck(this, BaasError);\n\t\n\t    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(BaasError).call(this, message));\n\t\n\t    _this.name = 'BaasError';\n\t    _this.message = message;\n\t    if (code !== undefined) {\n\t      _this.code = code;\n\t    }\n\t    if (typeof Error.captureStackTrace === 'function') {\n\t      Error.captureStackTrace(_this, _this.constructor);\n\t    } else {\n\t      _this.stack = new Error(message).stack;\n\t    }\n\t    return _this;\n\t  }\n\t\n\t  return BaasError;\n\t}(Error);\n\t\n\tvar Auth = exports.Auth = function () {\n\t  function Auth(rootUrl) {\n\t    _classCallCheck(this, Auth);\n\t\n\t    this.rootUrl = rootUrl;\n\t  }\n\t\n\t  _createClass(Auth, [{\n\t    key: 'pageRootUrl',\n\t    value: function pageRootUrl() {\n\t      return [window.location.protocol, '//', window.location.host, window.location.pathname].join('');\n\t    }\n\t\n\t    // The state we generate is to be used for any kind of request where we will\n\t    // complete an authentication flow via a redirect. We store the generate in\n\t    // a local storage bound to the app's origin. This ensures that any time we\n\t    // receive a redirect, there must be a state parameter and it must match\n\t    // what we ourselves have generated. This state MUST only be sent to\n\t    // a trusted BaaS endpoint in order to preserve its integrity. BaaS will\n\t    // store it in some way on its origin (currently a cookie stored on this client)\n\t    // and use that state at the end of an auth flow as a parameter in the redirect URI.\n\t\n\t  }, {\n\t    key: 'setAccessToken',\n\t    value: function setAccessToken(token) {\n\t      var currAuth = this.get();\n\t      currAuth['accessToken'] = token;\n\t      currAuth['refreshToken'] = localStorage.getItem(REFRESH_TOKEN_KEY);\n\t      this.set(currAuth);\n\t    }\n\t  }, {\n\t    key: 'error',\n\t    value: function error() {\n\t      return this._error;\n\t    }\n\t  }, {\n\t    key: 'handleRedirect',\n\t    value: function handleRedirect() {\n\t      var ourState = localStorage.getItem(STATE_KEY);\n\t      var redirectFragment = window.location.hash.substring(1);\n\t      var redirectState = parseRedirectFragment(redirectFragment, ourState);\n\t      if (redirectState.lastError) {\n\t        console.error('BaasClient: error from redirect: ' + redirectState.lastError);\n\t        this._error = redirectState.lastError;\n\t        window.history.replaceState(null, '', this.pageRootUrl());\n\t        return;\n\t      }\n\t      if (!redirectState.found) {\n\t        return;\n\t      }\n\t      localStorage.removeItem(STATE_KEY);\n\t      if (!redirectState.stateValid) {\n\t        console.error('BaasClient: state values did not match!');\n\t        window.history.replaceState(null, '', this.pageRootUrl());\n\t        return;\n\t      }\n\t      if (!redirectState.ua) {\n\t        console.error('BaasClient: no UA value was returned from redirect!');\n\t        return;\n\t      }\n\t      // If we get here, the state is valid - set auth appropriately.\n\t      this.set(redirectState.ua);\n\t      window.history.replaceState(null, '', this.pageRootUrl());\n\t    }\n\t  }, {\n\t    key: 'getOAuthLoginURL',\n\t    value: function getOAuthLoginURL(providerName, redirectUrl) {\n\t      if (redirectUrl === undefined) {\n\t        redirectUrl = this.pageRootUrl();\n\t      }\n\t      var state = Auth.generateState();\n\t      localStorage.setItem(STATE_KEY, state);\n\t      var result = this.rootUrl + '/oauth2/' + providerName + '?redirect=' + encodeURI(redirectUrl) + '&state=' + state;\n\t      return result;\n\t    }\n\t  }, {\n\t    key: 'localAuth',\n\t    value: function localAuth(username, password, cors) {\n\t      var _this2 = this;\n\t\n\t      var init = {\n\t        method: 'POST',\n\t        headers: {\n\t          'Accept': JSONTYPE,\n\t          'Content-Type': JSONTYPE\n\t        },\n\t        body: JSON.stringify({ 'username': username, 'password': password })\n\t      };\n\t\n\t      if (cors) {\n\t        init['cors'] = cors;\n\t      }\n\t\n\t      return fetch(this.rootUrl + '/local/userpass', init).then(checkStatus).then(function (response) {\n\t        return response.json().then(function (json) {\n\t          _this2.set(json);\n\t          Promise.resolve();\n\t        });\n\t      });\n\t    }\n\t  }, {\n\t    key: 'clear',\n\t    value: function clear() {\n\t      localStorage.removeItem(USER_AUTH_KEY);\n\t      localStorage.removeItem(REFRESH_TOKEN_KEY);\n\t      this.clearImpersonation();\n\t    }\n\t  }, {\n\t    key: 'set',\n\t    value: function set(json) {\n\t      var rt = json['refreshToken'];\n\t      delete json['refreshToken'];\n\t\n\t      localStorage.setItem(USER_AUTH_KEY, window.btoa(JSON.stringify(json)));\n\t      localStorage.setItem(REFRESH_TOKEN_KEY, rt);\n\t    }\n\t  }, {\n\t    key: 'get',\n\t    value: function get() {\n\t      if (localStorage.getItem(USER_AUTH_KEY) === null) {\n\t        return null;\n\t      }\n\t      return JSON.parse(window.atob(localStorage.getItem(USER_AUTH_KEY)));\n\t    }\n\t  }, {\n\t    key: 'authedId',\n\t    value: function authedId() {\n\t      var a = this.get();\n\t      return ((a || {}).user || {})._id;\n\t    }\n\t  }, {\n\t    key: 'isImpersonatingUser',\n\t    value: function isImpersonatingUser() {\n\t      return localStorage.getItem(IMPERSONATION_ACTIVE_KEY) === 'true';\n\t    }\n\t  }, {\n\t    key: 'refreshImpersonation',\n\t    value: function refreshImpersonation(client) {\n\t      var _this3 = this;\n\t\n\t      var userId = localStorage.getItem(IMPERSONATION_USER_KEY);\n\t      return client._doAuthed('/admin/users/' + userId + '/impersonate', 'POST', { refreshOnFailure: false, useRefreshToken: true }).then(function (response) {\n\t        return response.json().then(function (json) {\n\t          json['refreshToken'] = localStorage.getItem(REFRESH_TOKEN_KEY);\n\t          _this3.set(json);\n\t          return Promise.resolve();\n\t        });\n\t      }).catch(function (e) {\n\t        _this3.stopImpersonation();\n\t        throw e;\n\t      });\n\t    }\n\t  }, {\n\t    key: 'startImpersonation',\n\t    value: function startImpersonation(client, userId) {\n\t      if (this.get() === null) {\n\t        return Promise.reject(new BaasError('Must auth first'));\n\t      }\n\t      if (this.isImpersonatingUser()) {\n\t        throw new BaasError('Already impersonating a user');\n\t      }\n\t      localStorage.setItem(IMPERSONATION_ACTIVE_KEY, 'true');\n\t      localStorage.setItem(IMPERSONATION_USER_KEY, userId);\n\t\n\t      var realUserAuth = JSON.parse(window.atob(localStorage.getItem(USER_AUTH_KEY)));\n\t      realUserAuth['refreshToken'] = localStorage.getItem(REFRESH_TOKEN_KEY);\n\t      localStorage.setItem(IMPERSONATION_REAL_USER_AUTH_KEY, window.btoa(JSON.stringify(realUserAuth)));\n\t      return this.refreshImpersonation(client);\n\t    }\n\t  }, {\n\t    key: 'stopImpersonation',\n\t    value: function stopImpersonation() {\n\t      var root = this;\n\t      return new Promise(function (resolve, reject) {\n\t        if (!root.isImpersonatingUser()) {\n\t          throw new BaasError('Not impersonating a user');\n\t        }\n\t        var realUserAuth = JSON.parse(window.atob(localStorage.getItem(IMPERSONATION_REAL_USER_AUTH_KEY)));\n\t        root.set(realUserAuth);\n\t        root.clearImpersonation();\n\t        resolve();\n\t      });\n\t    }\n\t  }, {\n\t    key: 'clearImpersonation',\n\t    value: function clearImpersonation() {\n\t      localStorage.removeItem(IMPERSONATION_ACTIVE_KEY);\n\t      localStorage.removeItem(IMPERSONATION_USER_KEY);\n\t      localStorage.removeItem(IMPERSONATION_REAL_USER_AUTH_KEY);\n\t    }\n\t  }], [{\n\t    key: 'generateState',\n\t    value: function generateState() {\n\t      var alpha = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\t      var state = '';\n\t      for (var i = 0; i < stateLength; i++) {\n\t        var pos = Math.floor(Math.random() * alpha.length);\n\t        state += alpha.substring(pos, pos + 1);\n\t      }\n\t      return state;\n\t    }\n\t  }]);\n\t\n\t  return Auth;\n\t}();\n\t\n\tvar BaasClient = exports.BaasClient = function () {\n\t  function BaasClient(app, options) {\n\t    _classCallCheck(this, BaasClient);\n\t\n\t    var baseUrl = DEFAULT_BAAS_SERVER_URL;\n\t    if (options && options.baseUrl) {\n\t      baseUrl = options.baseUrl;\n\t    }\n\t    this.appUrl = baseUrl + '/admin/v1';\n\t    this.authUrl = baseUrl + '/admin/v1/auth';\n\t    if (app) {\n\t      this.appUrl = baseUrl + '/v1/app/' + app;\n\t      this.authUrl = this.appUrl + '/auth';\n\t    }\n\t    this.authManager = new Auth(this.authUrl);\n\t    this.authManager.handleRedirect();\n\t  }\n\t\n\t  _createClass(BaasClient, [{\n\t    key: 'authWithOAuth',\n\t    value: function authWithOAuth(providerName, redirectUrl) {\n\t      window.location.replace(this.authManager.getOAuthLoginURL(providerName, redirectUrl));\n\t    }\n\t  }, {\n\t    key: 'authedId',\n\t    value: function authedId() {\n\t      return this.authManager.authedId();\n\t    }\n\t  }, {\n\t    key: 'auth',\n\t    value: function auth() {\n\t      return this.authManager.get();\n\t    }\n\t  }, {\n\t    key: 'authError',\n\t    value: function authError() {\n\t      return this.authManager.error();\n\t    }\n\t  }, {\n\t    key: 'logout',\n\t    value: function logout() {\n\t      var _this4 = this;\n\t\n\t      return this._doAuthed('/auth', 'DELETE', { refreshOnFailure: false, useRefreshToken: true }).then(function (data) {\n\t        _this4.authManager.clear();\n\t      });\n\t    }\n\t\n\t    // wrapper around fetch() that matches the signature of doAuthed but does not\n\t    // actually use any auth. This is necessary for routes that must be\n\t    // accessible without logging in, like listing available auth providers.\n\t\n\t  }, {\n\t    key: '_do',\n\t    value: function _do(resource, method, options) {\n\t      options = options || {};\n\t      var url = '' + this.appUrl + resource;\n\t      var init = {\n\t        method: method,\n\t        headers: { 'Accept': JSONTYPE, 'Content-Type': JSONTYPE }\n\t      };\n\t      if (options.body) {\n\t        init['body'] = options.body;\n\t      }\n\t      if (options.queryParams) {\n\t        url = url + '?' + toQueryString(options.queryParams);\n\t      }\n\t\n\t      return fetch(url, init).then(function (response) {\n\t        // Okay: passthrough\n\t        if (response.status >= 200 && response.status < 300) {\n\t          return Promise.resolve(response);\n\t        } else if (response.headers.get('Content-Type') === JSONTYPE) {\n\t          return response.json().then(function (json) {\n\t            var error = new BaasError(json['error'], json['errorCode']);\n\t            error.response = response;\n\t            throw error;\n\t          });\n\t        }\n\t        var error = new Error(response.statusText);\n\t        error.response = response;\n\t        throw error;\n\t      }).then(function (response) {\n\t        return response.json();\n\t      });\n\t    }\n\t  }, {\n\t    key: '_doAuthed',\n\t    value: function _doAuthed(resource, method, options) {\n\t      var _this5 = this;\n\t\n\t      if (options === undefined) {\n\t        options = { refreshOnFailure: true, useRefreshToken: false };\n\t      } else {\n\t        if (options.refreshOnFailure === undefined) {\n\t          options.refreshOnFailure = true;\n\t        }\n\t        if (options.useRefreshToken === undefined) {\n\t          options.useRefreshToken = false;\n\t        }\n\t      }\n\t\n\t      if (this.auth() === null) {\n\t        return Promise.reject(new BaasError('Must auth first'));\n\t      }\n\t\n\t      var url = '' + this.appUrl + resource;\n\t\n\t      var headers = {\n\t        'Accept': JSONTYPE,\n\t        'Content-Type': JSONTYPE\n\t      };\n\t      var token = options.useRefreshToken ? localStorage.getItem(REFRESH_TOKEN_KEY) : this.auth()['accessToken'];\n\t      headers['Authorization'] = 'Bearer ' + token;\n\t\n\t      var init = {\n\t        method: method,\n\t        headers: headers\n\t      };\n\t\n\t      if (options.body) {\n\t        init['body'] = options.body;\n\t      }\n\t\n\t      if (options.queryParams) {\n\t        url = url + '?' + toQueryString(options.queryParams);\n\t      }\n\t\n\t      return fetch(url, init).then(function (response) {\n\t        // Okay: passthrough\n\t        if (response.status >= 200 && response.status < 300) {\n\t          return Promise.resolve(response);\n\t        } else if (response.headers.get('Content-Type') === JSONTYPE) {\n\t          return response.json().then(function (json) {\n\t            // Only want to try refreshing token when there's an invalid session\n\t            if ('errorCode' in json && json['errorCode'] === ErrInvalidSession) {\n\t              if (!options.refreshOnFailure) {\n\t                _this5.authManager.clear();\n\t                var _error = new BaasError(json['error'], json['errorCode']);\n\t                _error.response = response;\n\t                throw _error;\n\t              }\n\t\n\t              return _this5._refreshToken().then(function () {\n\t                options.refreshOnFailure = false;\n\t                return _this5._doAuthed(resource, method, options);\n\t              });\n\t            }\n\t\n\t            var error = new BaasError(json['error'], json['errorCode']);\n\t            error.response = response;\n\t            throw error;\n\t          });\n\t        }\n\t\n\t        var error = new Error(response.statusText);\n\t        error.response = response;\n\t        throw error;\n\t      });\n\t    }\n\t  }, {\n\t    key: '_refreshToken',\n\t    value: function _refreshToken() {\n\t      var _this6 = this;\n\t\n\t      if (this.authManager.isImpersonatingUser()) {\n\t        return this.authManager.refreshImpersonation(this);\n\t      }\n\t      return this._doAuthed('/auth/newAccessToken', 'POST', { refreshOnFailure: false, useRefreshToken: true }).then(function (response) {\n\t        return response.json().then(function (json) {\n\t          _this6.authManager.setAccessToken(json['accessToken']);\n\t          return Promise.resolve();\n\t        });\n\t      });\n\t    }\n\t  }, {\n\t    key: 'executePipeline',\n\t    value: function executePipeline(stages) {\n\t      return this._doAuthed('/pipeline', 'POST', { body: JSON.stringify(stages) }).then(function (response) {\n\t        return response.json();\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return BaasClient;\n\t}();\n\t\n\tvar DB = function () {\n\t  function DB(client, service, name) {\n\t    _classCallCheck(this, DB);\n\t\n\t    this.client = client;\n\t    this.service = service;\n\t    this.name = name;\n\t  }\n\t\n\t  _createClass(DB, [{\n\t    key: 'getCollection',\n\t    value: function getCollection(name) {\n\t      return new Collection(this, name);\n\t    }\n\t  }]);\n\t\n\t  return DB;\n\t}();\n\t\n\tvar Collection = function () {\n\t  function Collection(db, name) {\n\t    _classCallCheck(this, Collection);\n\t\n\t    this.db = db;\n\t    this.name = name;\n\t  }\n\t\n\t  _createClass(Collection, [{\n\t    key: 'getBaseArgs',\n\t    value: function getBaseArgs() {\n\t      return {\n\t        'database': this.db.name,\n\t        'collection': this.name\n\t      };\n\t    }\n\t  }, {\n\t    key: 'deleteOne',\n\t    value: function deleteOne(query) {\n\t      var args = this.getBaseArgs();\n\t      args.query = query;\n\t      args.singleDoc = true;\n\t      return this.db.client.executePipeline([{\n\t        'service': this.db.service,\n\t        'action': 'delete',\n\t        'args': args\n\t      }]);\n\t    }\n\t  }, {\n\t    key: 'deleteMany',\n\t    value: function deleteMany(query) {\n\t      var args = this.getBaseArgs();\n\t      args.query = query;\n\t      args.singleDoc = false;\n\t      return this.db.client.executePipeline([{\n\t        'service': this.db.service,\n\t        'action': 'delete',\n\t        'args': args\n\t      }]);\n\t    }\n\t  }, {\n\t    key: 'find',\n\t    value: function find(query, project) {\n\t      var args = this.getBaseArgs();\n\t      args.query = query;\n\t      args.project = project;\n\t      return this.db.client.executePipeline([{\n\t        'service': this.db.service,\n\t        'action': 'find',\n\t        'args': args\n\t      }]);\n\t    }\n\t  }, {\n\t    key: 'insert',\n\t    value: function insert(documents) {\n\t      return this.db.client.executePipeline([{ 'action': 'literal',\n\t        'args': {\n\t          'items': documents\n\t        }\n\t      }, {\n\t        'service': this.db.service,\n\t        'action': 'insert',\n\t        'args': this.getBaseArgs()\n\t      }]);\n\t    }\n\t  }, {\n\t    key: 'makeUpdateStage',\n\t    value: function makeUpdateStage(query, update, upsert, multi) {\n\t      var args = this.getBaseArgs();\n\t      args.query = query;\n\t      args.update = update;\n\t      if (upsert) {\n\t        args.upsert = true;\n\t      }\n\t      if (multi) {\n\t        args.multi = true;\n\t      }\n\t\n\t      return {\n\t        'service': this.db.service,\n\t        'action': 'update',\n\t        'args': args\n\t      };\n\t    }\n\t  }, {\n\t    key: 'updateOne',\n\t    value: function updateOne(query, update) {\n\t      return this.db.client.executePipeline([this.makeUpdateStage(query, update, false, false)]);\n\t    }\n\t  }, {\n\t    key: 'updateMany',\n\t    value: function updateMany(query, update, upsert, multi) {\n\t      return this.db.client.executePipeline([this.makeUpdateStage(query, update, false, true)]);\n\t    }\n\t  }, {\n\t    key: 'upsert',\n\t    value: function upsert(query, update) {\n\t      return this.db.client.executePipeline([this.makeUpdateStage(query, update, true, false)]);\n\t    }\n\t  }]);\n\t\n\t  return Collection;\n\t}();\n\t\n\tvar MongoClient = exports.MongoClient = function () {\n\t  function MongoClient(baasClient, serviceName) {\n\t    _classCallCheck(this, MongoClient);\n\t\n\t    this.baasClient = baasClient;\n\t    this.service = serviceName;\n\t  }\n\t\n\t  _createClass(MongoClient, [{\n\t    key: 'getDb',\n\t    value: function getDb(name) {\n\t      return new DB(this.baasClient, this.service, name);\n\t    }\n\t  }]);\n\t\n\t  return MongoClient;\n\t}();\n\t\n\tvar Admin = exports.Admin = function () {\n\t  function Admin(baseUrl) {\n\t    _classCallCheck(this, Admin);\n\t\n\t    this.client = new BaasClient('', { baseUrl: baseUrl });\n\t  }\n\t\n\t  _createClass(Admin, [{\n\t    key: '_doAuthed',\n\t    value: function _doAuthed(url, method, options) {\n\t      return this.client._doAuthed(url, method, options).then(function (response) {\n\t        return response.json();\n\t      });\n\t    }\n\t  }, {\n\t    key: '_get',\n\t    value: function _get(url, queryParams) {\n\t      return this._doAuthed(url, 'GET', { queryParams: queryParams });\n\t    }\n\t  }, {\n\t    key: '_put',\n\t    value: function _put(url, queryParams) {\n\t      return this._doAuthed(url, 'PUT', { queryParams: queryParams });\n\t    }\n\t  }, {\n\t    key: '_delete',\n\t    value: function _delete(url) {\n\t      return this._doAuthed(url, 'DELETE');\n\t    }\n\t  }, {\n\t    key: '_post',\n\t    value: function _post(url, body) {\n\t      return this._doAuthed(url, 'POST', { body: JSON.stringify(body) });\n\t    }\n\t  }, {\n\t    key: 'profile',\n\t    value: function profile() {\n\t      var _this7 = this;\n\t\n\t      var root = this;\n\t      return {\n\t        keys: function keys() {\n\t          return {\n\t            list: function list() {\n\t              return root._get('/profile/keys');\n\t            },\n\t            create: function create(key) {\n\t              return root._post('/profile/keys');\n\t            },\n\t            apiKey: function apiKey(keyId) {\n\t              return {\n\t                get: function get() {\n\t                  return root._get('/profile/keys/' + keyId);\n\t                },\n\t                remove: function remove() {\n\t                  return _this7._delete('/profile/keys/' + keyId);\n\t                },\n\t                enable: function enable() {\n\t                  return root._put('/profile/keys/' + keyId + '/enable');\n\t                },\n\t                disable: function disable() {\n\t                  return root._put('/profile/keys/' + keyId + '/disable');\n\t                }\n\t              };\n\t            }\n\t          };\n\t        }\n\t      };\n\t    }\n\t\n\t    /* Examples of how to access admin API with this client:\n\t     *\n\t     * List all apps\n\t     *    a.apps().list()\n\t     *\n\t     * Fetch app under name 'planner'\n\t     *    a.apps().app('planner').get()\n\t     *\n\t     * List services under the app 'planner'\n\t     *    a.apps().app('planner').services().list()\n\t     *\n\t     * Delete a rule by ID\n\t     *    a.apps().app('planner').services().service('mdb1').rules().rule('580e6d055b199c221fcb821d').remove()\n\t     *\n\t     */\n\t\n\t  }, {\n\t    key: 'apps',\n\t    value: function apps() {\n\t      var _this8 = this;\n\t\n\t      var root = this;\n\t      return {\n\t        list: function list() {\n\t          return root._get('/apps');\n\t        },\n\t        create: function create(data) {\n\t          return root._post('/apps', data);\n\t        },\n\t        app: function app(_app) {\n\t          return {\n\t            get: function get() {\n\t              return root._get('/apps/' + _app);\n\t            },\n\t            remove: function remove() {\n\t              return root._delete('/apps/' + _app);\n\t            },\n\t\n\t            users: function users() {\n\t              return {\n\t                list: function list(filter) {\n\t                  return _this8._get('/apps/' + _app + '/users', filter);\n\t                },\n\t                user: function user(uid) {\n\t                  return {\n\t                    get: function get() {\n\t                      return _this8._get('/apps/' + _app + '/users/' + uid);\n\t                    },\n\t                    logout: function logout() {\n\t                      return _this8._put('/apps/' + _app + '/users/' + uid + '/logout');\n\t                    }\n\t                  };\n\t                }\n\t              };\n\t            },\n\t\n\t            authProviders: function authProviders() {\n\t              return {\n\t                create: function create(data) {\n\t                  return _this8._post('/apps/' + _app + '/authProviders', data);\n\t                },\n\t                list: function list() {\n\t                  return _this8._get('/apps/' + _app + '/authProviders');\n\t                },\n\t                provider: function provider(authType, authName) {\n\t                  return {\n\t                    get: function get() {\n\t                      return _this8._get('/apps/' + _app + '/authProviders/' + authType + '/' + authName);\n\t                    },\n\t                    remove: function remove() {\n\t                      return _this8._delete('/apps/' + _app + '/authProviders/' + authType + '/' + authName);\n\t                    },\n\t                    update: function update(data) {\n\t                      return _this8._post('/apps/' + _app + '/authProviders/' + authType + '/' + authName, data);\n\t                    }\n\t                  };\n\t                }\n\t              };\n\t            },\n\t            variables: function variables() {\n\t              return {\n\t                list: function list() {\n\t                  return _this8._get('/apps/' + _app + '/vars');\n\t                },\n\t                variable: function variable(varName) {\n\t                  return {\n\t                    get: function get() {\n\t                      return _this8._get('/apps/' + _app + '/vars/' + varName);\n\t                    },\n\t                    remove: function remove() {\n\t                      return _this8._delete('/apps/' + _app + '/vars/' + varName);\n\t                    },\n\t                    create: function create(data) {\n\t                      return _this8._post('/apps/' + _app + '/vars/' + varName, data);\n\t                    },\n\t                    update: function update(data) {\n\t                      return _this8._post('/apps/' + _app + '/vars/' + varName, data);\n\t                    }\n\t                  };\n\t                }\n\t              };\n\t            },\n\t            logs: function logs() {\n\t              return {\n\t                get: function get(filter) {\n\t                  return _this8._get('/apps/' + _app + '/logs', filter);\n\t                }\n\t              };\n\t            },\n\t            apiKeys: function apiKeys() {\n\t              return {\n\t                list: function list() {\n\t                  return _this8._get('/apps/' + _app + '/keys');\n\t                },\n\t                create: function create(data) {\n\t                  return _this8._post('/apps/' + _app + '/keys', data);\n\t                },\n\t                apiKey: function apiKey(key) {\n\t                  return {\n\t                    get: function get() {\n\t                      return _this8._get('/apps/' + _app + '/keys/' + key);\n\t                    },\n\t                    remove: function remove() {\n\t                      return _this8._delete('/apps/' + _app + '/keys/' + key);\n\t                    },\n\t                    enable: function enable() {\n\t                      return _this8._put('/apps/' + _app + '/keys/' + key + '/enable');\n\t                    },\n\t                    disable: function disable() {\n\t                      return _this8._put('/apps/' + _app + '/keys/' + key + '/disable');\n\t                    }\n\t                  };\n\t                }\n\t              };\n\t            },\n\t            services: function services() {\n\t              return {\n\t                list: function list() {\n\t                  return _this8._get('/apps/' + _app + '/services');\n\t                },\n\t                create: function create(data) {\n\t                  return _this8._post('/apps/' + _app + '/services', data);\n\t                },\n\t                service: function service(svc) {\n\t                  return {\n\t                    get: function get() {\n\t                      return _this8._get('/apps/' + _app + '/services/' + svc);\n\t                    },\n\t                    update: function update(data) {\n\t                      return _this8._post('/apps/' + _app + '/services/' + svc, data);\n\t                    },\n\t                    remove: function remove() {\n\t                      return _this8._delete('/apps/' + _app + '/services/' + svc);\n\t                    },\n\t                    setConfig: function setConfig(data) {\n\t                      return _this8._post('/apps/' + _app + '/services/' + svc + '/config', data);\n\t                    },\n\t\n\t                    rules: function rules() {\n\t                      return {\n\t                        list: function list() {\n\t                          return _this8._get('/apps/' + _app + '/services/' + svc + '/rules');\n\t                        },\n\t                        create: function create(data) {\n\t                          return _this8._post('/apps/' + _app + '/services/' + svc + '/rules');\n\t                        },\n\t                        rule: function rule(ruleId) {\n\t                          return {\n\t                            get: function get() {\n\t                              return _this8._get('/apps/' + _app + '/services/' + svc + '/rules/' + ruleId);\n\t                            },\n\t                            update: function update(data) {\n\t                              return _this8._post('/apps/' + _app + '/services/' + svc + '/rules/' + ruleId, data);\n\t                            },\n\t                            remove: function remove() {\n\t                              return _this8._delete('/apps/' + _app + '/services/' + svc + '/rules/' + ruleId);\n\t                            }\n\t                          };\n\t                        }\n\t                      };\n\t                    },\n\t\n\t                    triggers: function triggers() {\n\t                      return {\n\t                        list: function list() {\n\t                          return _this8._get('/apps/' + _app + '/services/' + svc + '/triggers');\n\t                        },\n\t                        create: function create(data) {\n\t                          return _this8._post('/apps/' + _app + '/services/' + svc + '/triggers');\n\t                        },\n\t                        trigger: function trigger(triggerId) {\n\t                          return {\n\t                            get: function get() {\n\t                              return _this8._get('/apps/' + _app + '/services/' + svc + '/triggers/' + triggerId);\n\t                            },\n\t                            update: function update(data) {\n\t                              return _this8._post('/apps/' + _app + '/services/' + svc + '/triggers/' + triggerId, data);\n\t                            },\n\t                            remove: function remove() {\n\t                              return _this8._delete('/apps/' + _app + '/services/' + svc + '/triggers/' + triggerId);\n\t                            }\n\t                          };\n\t                        }\n\t                      };\n\t                    }\n\t                  };\n\t                }\n\t              };\n\t            }\n\t          };\n\t        }\n\t      };\n\t    }\n\t  }, {\n\t    key: '_admin',\n\t    value: function _admin() {\n\t      var _this9 = this;\n\t\n\t      return {\n\t        logs: function logs() {\n\t          return {\n\t            get: function get(filter) {\n\t              return _this9._doAuthed('/admin/logs', 'GET', { useRefreshToken: true, queryParams: filter });\n\t            }\n\t          };\n\t        },\n\t        users: function users() {\n\t          return {\n\t            list: function list(filter) {\n\t              return _this9._doAuthed('/admin/users', 'GET', { useRefreshToken: true, queryParams: filter });\n\t            },\n\t            user: function user(uid) {\n\t              return {\n\t                logout: function logout() {\n\t                  return _this9._doAuthed('/admin/users/' + uid + '/logout', 'PUT', { useRefreshToken: true });\n\t                }\n\t              };\n\t            }\n\t          };\n\t        }\n\t      };\n\t    }\n\t  }, {\n\t    key: '_isImpersonatingUser',\n\t    value: function _isImpersonatingUser() {\n\t      return this.client.authManager.isImpersonatingUser();\n\t    }\n\t  }, {\n\t    key: '_startImpersonation',\n\t    value: function _startImpersonation(userId) {\n\t      return this.client.authManager.startImpersonation(this.client, userId);\n\t    }\n\t  }, {\n\t    key: '_stopImpersonation',\n\t    value: function _stopImpersonation(userId) {\n\t      return this.client.authManager.stopImpersonation();\n\t    }\n\t  }]);\n\t\n\t  return Admin;\n\t}();\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t(function(self) {\n\t  'use strict';\n\t\n\t  if (self.fetch) {\n\t    return\n\t  }\n\t\n\t  var support = {\n\t    searchParams: 'URLSearchParams' in self,\n\t    iterable: 'Symbol' in self && 'iterator' in Symbol,\n\t    blob: 'FileReader' in self && 'Blob' in self && (function() {\n\t      try {\n\t        new Blob()\n\t        return true\n\t      } catch(e) {\n\t        return false\n\t      }\n\t    })(),\n\t    formData: 'FormData' in self,\n\t    arrayBuffer: 'ArrayBuffer' in self\n\t  }\n\t\n\t  if (support.arrayBuffer) {\n\t    var viewClasses = [\n\t      '[object Int8Array]',\n\t      '[object Uint8Array]',\n\t      '[object Uint8ClampedArray]',\n\t      '[object Int16Array]',\n\t      '[object Uint16Array]',\n\t      '[object Int32Array]',\n\t      '[object Uint32Array]',\n\t      '[object Float32Array]',\n\t      '[object Float64Array]'\n\t    ]\n\t\n\t    var isDataView = function(obj) {\n\t      return obj && DataView.prototype.isPrototypeOf(obj)\n\t    }\n\t\n\t    var isArrayBufferView = ArrayBuffer.isView || function(obj) {\n\t      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n\t    }\n\t  }\n\t\n\t  function normalizeName(name) {\n\t    if (typeof name !== 'string') {\n\t      name = String(name)\n\t    }\n\t    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n\t      throw new TypeError('Invalid character in header field name')\n\t    }\n\t    return name.toLowerCase()\n\t  }\n\t\n\t  function normalizeValue(value) {\n\t    if (typeof value !== 'string') {\n\t      value = String(value)\n\t    }\n\t    return value\n\t  }\n\t\n\t  // Build a destructive iterator for the value list\n\t  function iteratorFor(items) {\n\t    var iterator = {\n\t      next: function() {\n\t        var value = items.shift()\n\t        return {done: value === undefined, value: value}\n\t      }\n\t    }\n\t\n\t    if (support.iterable) {\n\t      iterator[Symbol.iterator] = function() {\n\t        return iterator\n\t      }\n\t    }\n\t\n\t    return iterator\n\t  }\n\t\n\t  function Headers(headers) {\n\t    this.map = {}\n\t\n\t    if (headers instanceof Headers) {\n\t      headers.forEach(function(value, name) {\n\t        this.append(name, value)\n\t      }, this)\n\t\n\t    } else if (headers) {\n\t      Object.getOwnPropertyNames(headers).forEach(function(name) {\n\t        this.append(name, headers[name])\n\t      }, this)\n\t    }\n\t  }\n\t\n\t  Headers.prototype.append = function(name, value) {\n\t    name = normalizeName(name)\n\t    value = normalizeValue(value)\n\t    var oldValue = this.map[name]\n\t    this.map[name] = oldValue ? oldValue+','+value : value\n\t  }\n\t\n\t  Headers.prototype['delete'] = function(name) {\n\t    delete this.map[normalizeName(name)]\n\t  }\n\t\n\t  Headers.prototype.get = function(name) {\n\t    name = normalizeName(name)\n\t    return this.has(name) ? this.map[name] : null\n\t  }\n\t\n\t  Headers.prototype.has = function(name) {\n\t    return this.map.hasOwnProperty(normalizeName(name))\n\t  }\n\t\n\t  Headers.prototype.set = function(name, value) {\n\t    this.map[normalizeName(name)] = normalizeValue(value)\n\t  }\n\t\n\t  Headers.prototype.forEach = function(callback, thisArg) {\n\t    for (var name in this.map) {\n\t      if (this.map.hasOwnProperty(name)) {\n\t        callback.call(thisArg, this.map[name], name, this)\n\t      }\n\t    }\n\t  }\n\t\n\t  Headers.prototype.keys = function() {\n\t    var items = []\n\t    this.forEach(function(value, name) { items.push(name) })\n\t    return iteratorFor(items)\n\t  }\n\t\n\t  Headers.prototype.values = function() {\n\t    var items = []\n\t    this.forEach(function(value) { items.push(value) })\n\t    return iteratorFor(items)\n\t  }\n\t\n\t  Headers.prototype.entries = function() {\n\t    var items = []\n\t    this.forEach(function(value, name) { items.push([name, value]) })\n\t    return iteratorFor(items)\n\t  }\n\t\n\t  if (support.iterable) {\n\t    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n\t  }\n\t\n\t  function consumed(body) {\n\t    if (body.bodyUsed) {\n\t      return Promise.reject(new TypeError('Already read'))\n\t    }\n\t    body.bodyUsed = true\n\t  }\n\t\n\t  function fileReaderReady(reader) {\n\t    return new Promise(function(resolve, reject) {\n\t      reader.onload = function() {\n\t        resolve(reader.result)\n\t      }\n\t      reader.onerror = function() {\n\t        reject(reader.error)\n\t      }\n\t    })\n\t  }\n\t\n\t  function readBlobAsArrayBuffer(blob) {\n\t    var reader = new FileReader()\n\t    var promise = fileReaderReady(reader)\n\t    reader.readAsArrayBuffer(blob)\n\t    return promise\n\t  }\n\t\n\t  function readBlobAsText(blob) {\n\t    var reader = new FileReader()\n\t    var promise = fileReaderReady(reader)\n\t    reader.readAsText(blob)\n\t    return promise\n\t  }\n\t\n\t  function readArrayBufferAsText(buf) {\n\t    var view = new Uint8Array(buf)\n\t    var chars = new Array(view.length)\n\t\n\t    for (var i = 0; i < view.length; i++) {\n\t      chars[i] = String.fromCharCode(view[i])\n\t    }\n\t    return chars.join('')\n\t  }\n\t\n\t  function bufferClone(buf) {\n\t    if (buf.slice) {\n\t      return buf.slice(0)\n\t    } else {\n\t      var view = new Uint8Array(buf.byteLength)\n\t      view.set(new Uint8Array(buf))\n\t      return view.buffer\n\t    }\n\t  }\n\t\n\t  function Body() {\n\t    this.bodyUsed = false\n\t\n\t    this._initBody = function(body) {\n\t      this._bodyInit = body\n\t      if (!body) {\n\t        this._bodyText = ''\n\t      } else if (typeof body === 'string') {\n\t        this._bodyText = body\n\t      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n\t        this._bodyBlob = body\n\t      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n\t        this._bodyFormData = body\n\t      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n\t        this._bodyText = body.toString()\n\t      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n\t        this._bodyArrayBuffer = bufferClone(body.buffer)\n\t        // IE 10-11 can't handle a DataView body.\n\t        this._bodyInit = new Blob([this._bodyArrayBuffer])\n\t      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n\t        this._bodyArrayBuffer = bufferClone(body)\n\t      } else {\n\t        throw new Error('unsupported BodyInit type')\n\t      }\n\t\n\t      if (!this.headers.get('content-type')) {\n\t        if (typeof body === 'string') {\n\t          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n\t        } else if (this._bodyBlob && this._bodyBlob.type) {\n\t          this.headers.set('content-type', this._bodyBlob.type)\n\t        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n\t          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n\t        }\n\t      }\n\t    }\n\t\n\t    if (support.blob) {\n\t      this.blob = function() {\n\t        var rejected = consumed(this)\n\t        if (rejected) {\n\t          return rejected\n\t        }\n\t\n\t        if (this._bodyBlob) {\n\t          return Promise.resolve(this._bodyBlob)\n\t        } else if (this._bodyArrayBuffer) {\n\t          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n\t        } else if (this._bodyFormData) {\n\t          throw new Error('could not read FormData body as blob')\n\t        } else {\n\t          return Promise.resolve(new Blob([this._bodyText]))\n\t        }\n\t      }\n\t\n\t      this.arrayBuffer = function() {\n\t        if (this._bodyArrayBuffer) {\n\t          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n\t        } else {\n\t          return this.blob().then(readBlobAsArrayBuffer)\n\t        }\n\t      }\n\t    }\n\t\n\t    this.text = function() {\n\t      var rejected = consumed(this)\n\t      if (rejected) {\n\t        return rejected\n\t      }\n\t\n\t      if (this._bodyBlob) {\n\t        return readBlobAsText(this._bodyBlob)\n\t      } else if (this._bodyArrayBuffer) {\n\t        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n\t      } else if (this._bodyFormData) {\n\t        throw new Error('could not read FormData body as text')\n\t      } else {\n\t        return Promise.resolve(this._bodyText)\n\t      }\n\t    }\n\t\n\t    if (support.formData) {\n\t      this.formData = function() {\n\t        return this.text().then(decode)\n\t      }\n\t    }\n\t\n\t    this.json = function() {\n\t      return this.text().then(JSON.parse)\n\t    }\n\t\n\t    return this\n\t  }\n\t\n\t  // HTTP methods whose capitalization should be normalized\n\t  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\t\n\t  function normalizeMethod(method) {\n\t    var upcased = method.toUpperCase()\n\t    return (methods.indexOf(upcased) > -1) ? upcased : method\n\t  }\n\t\n\t  function Request(input, options) {\n\t    options = options || {}\n\t    var body = options.body\n\t\n\t    if (input instanceof Request) {\n\t      if (input.bodyUsed) {\n\t        throw new TypeError('Already read')\n\t      }\n\t      this.url = input.url\n\t      this.credentials = input.credentials\n\t      if (!options.headers) {\n\t        this.headers = new Headers(input.headers)\n\t      }\n\t      this.method = input.method\n\t      this.mode = input.mode\n\t      if (!body && input._bodyInit != null) {\n\t        body = input._bodyInit\n\t        input.bodyUsed = true\n\t      }\n\t    } else {\n\t      this.url = String(input)\n\t    }\n\t\n\t    this.credentials = options.credentials || this.credentials || 'omit'\n\t    if (options.headers || !this.headers) {\n\t      this.headers = new Headers(options.headers)\n\t    }\n\t    this.method = normalizeMethod(options.method || this.method || 'GET')\n\t    this.mode = options.mode || this.mode || null\n\t    this.referrer = null\n\t\n\t    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n\t      throw new TypeError('Body not allowed for GET or HEAD requests')\n\t    }\n\t    this._initBody(body)\n\t  }\n\t\n\t  Request.prototype.clone = function() {\n\t    return new Request(this, { body: this._bodyInit })\n\t  }\n\t\n\t  function decode(body) {\n\t    var form = new FormData()\n\t    body.trim().split('&').forEach(function(bytes) {\n\t      if (bytes) {\n\t        var split = bytes.split('=')\n\t        var name = split.shift().replace(/\\+/g, ' ')\n\t        var value = split.join('=').replace(/\\+/g, ' ')\n\t        form.append(decodeURIComponent(name), decodeURIComponent(value))\n\t      }\n\t    })\n\t    return form\n\t  }\n\t\n\t  function parseHeaders(rawHeaders) {\n\t    var headers = new Headers()\n\t    rawHeaders.split(/\\r?\\n/).forEach(function(line) {\n\t      var parts = line.split(':')\n\t      var key = parts.shift().trim()\n\t      if (key) {\n\t        var value = parts.join(':').trim()\n\t        headers.append(key, value)\n\t      }\n\t    })\n\t    return headers\n\t  }\n\t\n\t  Body.call(Request.prototype)\n\t\n\t  function Response(bodyInit, options) {\n\t    if (!options) {\n\t      options = {}\n\t    }\n\t\n\t    this.type = 'default'\n\t    this.status = 'status' in options ? options.status : 200\n\t    this.ok = this.status >= 200 && this.status < 300\n\t    this.statusText = 'statusText' in options ? options.statusText : 'OK'\n\t    this.headers = new Headers(options.headers)\n\t    this.url = options.url || ''\n\t    this._initBody(bodyInit)\n\t  }\n\t\n\t  Body.call(Response.prototype)\n\t\n\t  Response.prototype.clone = function() {\n\t    return new Response(this._bodyInit, {\n\t      status: this.status,\n\t      statusText: this.statusText,\n\t      headers: new Headers(this.headers),\n\t      url: this.url\n\t    })\n\t  }\n\t\n\t  Response.error = function() {\n\t    var response = new Response(null, {status: 0, statusText: ''})\n\t    response.type = 'error'\n\t    return response\n\t  }\n\t\n\t  var redirectStatuses = [301, 302, 303, 307, 308]\n\t\n\t  Response.redirect = function(url, status) {\n\t    if (redirectStatuses.indexOf(status) === -1) {\n\t      throw new RangeError('Invalid status code')\n\t    }\n\t\n\t    return new Response(null, {status: status, headers: {location: url}})\n\t  }\n\t\n\t  self.Headers = Headers\n\t  self.Request = Request\n\t  self.Response = Response\n\t\n\t  self.fetch = function(input, init) {\n\t    return new Promise(function(resolve, reject) {\n\t      var request = new Request(input, init)\n\t      var xhr = new XMLHttpRequest()\n\t\n\t      xhr.onload = function() {\n\t        var options = {\n\t          status: xhr.status,\n\t          statusText: xhr.statusText,\n\t          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n\t        }\n\t        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n\t        var body = 'response' in xhr ? xhr.response : xhr.responseText\n\t        resolve(new Response(body, options))\n\t      }\n\t\n\t      xhr.onerror = function() {\n\t        reject(new TypeError('Network request failed'))\n\t      }\n\t\n\t      xhr.ontimeout = function() {\n\t        reject(new TypeError('Network request failed'))\n\t      }\n\t\n\t      xhr.open(request.method, request.url, true)\n\t\n\t      if (request.credentials === 'include') {\n\t        xhr.withCredentials = true\n\t      }\n\t\n\t      if ('responseType' in xhr && support.blob) {\n\t        xhr.responseType = 'blob'\n\t      }\n\t\n\t      request.headers.forEach(function(value, name) {\n\t        xhr.setRequestHeader(name, value)\n\t      })\n\t\n\t      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n\t    })\n\t  }\n\t  self.fetch.polyfill = true\n\t})(typeof self !== 'undefined' ? self : this);\n\n\n/***/ }\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// baas.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 304b7807bbba57e3d9c5","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Admin = exports.MongoClient = exports.BaasClient = exports.Auth = exports.BaasError = exports.parseRedirectFragment = exports.ErrInvalidSession = exports.ErrAuthProviderNotFound = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nrequire('whatwg-fetch');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /* global window, localStorage, fetch */\n/* eslint no-labels: ['error', { 'allowLoop': true }] */\n\n\n// fetch polyfill\n\nvar USER_AUTH_KEY = '_baas_ua';\nvar REFRESH_TOKEN_KEY = '_baas_rt';\nvar STATE_KEY = '_baas_state';\nvar BAAS_ERROR_KEY = '_baas_error';\nvar BAAS_LINK_KEY = '_baas_link';\nvar IMPERSONATION_ACTIVE_KEY = '_baas_impers_active';\nvar IMPERSONATION_USER_KEY = '_baas_impers_user';\nvar IMPERSONATION_REAL_USER_AUTH_KEY = '_baas_impers_real_ua';\nvar DEFAULT_BAAS_SERVER_URL = 'https://baas-dev.10gen.cc';\nvar JSONTYPE = 'application/json';\n\nvar ErrAuthProviderNotFound = exports.ErrAuthProviderNotFound = 'AuthProviderNotFound';\nvar ErrInvalidSession = exports.ErrInvalidSession = 'InvalidSession';\nvar stateLength = 64;\n\nvar toQueryString = function toQueryString(obj) {\n  var parts = [];\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      parts.push(encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]));\n    }\n  }\n  return parts.join('&');\n};\n\nvar checkStatus = function checkStatus(response) {\n  if (response.status >= 200 && response.status < 300) {\n    return response;\n  } else {\n    var error = new Error(response.statusText);\n    error.response = response;\n    throw error;\n  }\n};\n\nvar parseRedirectFragment = exports.parseRedirectFragment = function parseRedirectFragment(fragment, ourState) {\n  // After being redirected from oauth, the URL will look like:\n  // https://todo.examples.baas-dev.10gen.cc/#_baas_state=...&_baas_ua=...\n  // This function parses out baas-specific tokens from the fragment and\n  // builds an object describing the result.\n  var vars = fragment.split('&');\n  var result = { ua: null, found: false, stateValid: false, lastError: null };\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    outerloop: for (var _iterator = vars[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var pair = _step.value;\n\n      var pairParts = pair.split('=');\n      var pairKey = decodeURIComponent(pairParts[0]);\n      switch (pairKey) {\n        case BAAS_ERROR_KEY:\n          result.lastError = decodeURIComponent(pairParts[1]);\n          result.found = true;\n          break outerloop;\n        case USER_AUTH_KEY:\n          result.ua = JSON.parse(window.atob(decodeURIComponent(pairParts[1])));\n          result.found = true;\n          continue;\n        case BAAS_LINK_KEY:\n          result.found = true;\n          continue;\n        case STATE_KEY:\n          result.found = true;\n          var theirState = decodeURIComponent(pairParts[1]);\n          if (ourState && ourState === theirState) {\n            result.stateValid = true;\n          }\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return result;\n};\n\nvar BaasError = exports.BaasError = function (_Error) {\n  _inherits(BaasError, _Error);\n\n  function BaasError(message, code) {\n    _classCallCheck(this, BaasError);\n\n    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(BaasError).call(this, message));\n\n    _this.name = 'BaasError';\n    _this.message = message;\n    if (code !== undefined) {\n      _this.code = code;\n    }\n    if (typeof Error.captureStackTrace === 'function') {\n      Error.captureStackTrace(_this, _this.constructor);\n    } else {\n      _this.stack = new Error(message).stack;\n    }\n    return _this;\n  }\n\n  return BaasError;\n}(Error);\n\nvar Auth = exports.Auth = function () {\n  function Auth(rootUrl) {\n    _classCallCheck(this, Auth);\n\n    this.rootUrl = rootUrl;\n  }\n\n  _createClass(Auth, [{\n    key: 'pageRootUrl',\n    value: function pageRootUrl() {\n      return [window.location.protocol, '//', window.location.host, window.location.pathname].join('');\n    }\n\n    // The state we generate is to be used for any kind of request where we will\n    // complete an authentication flow via a redirect. We store the generate in\n    // a local storage bound to the app's origin. This ensures that any time we\n    // receive a redirect, there must be a state parameter and it must match\n    // what we ourselves have generated. This state MUST only be sent to\n    // a trusted BaaS endpoint in order to preserve its integrity. BaaS will\n    // store it in some way on its origin (currently a cookie stored on this client)\n    // and use that state at the end of an auth flow as a parameter in the redirect URI.\n\n  }, {\n    key: 'setAccessToken',\n    value: function setAccessToken(token) {\n      var currAuth = this.get();\n      currAuth['accessToken'] = token;\n      currAuth['refreshToken'] = localStorage.getItem(REFRESH_TOKEN_KEY);\n      this.set(currAuth);\n    }\n  }, {\n    key: 'error',\n    value: function error() {\n      return this._error;\n    }\n  }, {\n    key: 'handleRedirect',\n    value: function handleRedirect() {\n      var ourState = localStorage.getItem(STATE_KEY);\n      var redirectFragment = window.location.hash.substring(1);\n      var redirectState = parseRedirectFragment(redirectFragment, ourState);\n      if (redirectState.lastError) {\n        console.error('BaasClient: error from redirect: ' + redirectState.lastError);\n        this._error = redirectState.lastError;\n        window.history.replaceState(null, '', this.pageRootUrl());\n        return;\n      }\n      if (!redirectState.found) {\n        return;\n      }\n      localStorage.removeItem(STATE_KEY);\n      if (!redirectState.stateValid) {\n        console.error('BaasClient: state values did not match!');\n        window.history.replaceState(null, '', this.pageRootUrl());\n        return;\n      }\n      if (!redirectState.ua) {\n        console.error('BaasClient: no UA value was returned from redirect!');\n        return;\n      }\n      // If we get here, the state is valid - set auth appropriately.\n      this.set(redirectState.ua);\n      window.history.replaceState(null, '', this.pageRootUrl());\n    }\n  }, {\n    key: 'getOAuthLoginURL',\n    value: function getOAuthLoginURL(providerName, redirectUrl) {\n      if (redirectUrl === undefined) {\n        redirectUrl = this.pageRootUrl();\n      }\n      var state = Auth.generateState();\n      localStorage.setItem(STATE_KEY, state);\n      var result = this.rootUrl + '/oauth2/' + providerName + '?redirect=' + encodeURI(redirectUrl) + '&state=' + state;\n      return result;\n    }\n  }, {\n    key: 'localAuth',\n    value: function localAuth(username, password, cors) {\n      var _this2 = this;\n\n      var init = {\n        method: 'POST',\n        headers: {\n          'Accept': JSONTYPE,\n          'Content-Type': JSONTYPE\n        },\n        body: JSON.stringify({ 'username': username, 'password': password })\n      };\n\n      if (cors) {\n        init['cors'] = cors;\n      }\n\n      return fetch(this.rootUrl + '/local/userpass', init).then(checkStatus).then(function (response) {\n        return response.json().then(function (json) {\n          _this2.set(json);\n          Promise.resolve();\n        });\n      });\n    }\n  }, {\n    key: 'clear',\n    value: function clear() {\n      localStorage.removeItem(USER_AUTH_KEY);\n      localStorage.removeItem(REFRESH_TOKEN_KEY);\n      this.clearImpersonation();\n    }\n  }, {\n    key: 'set',\n    value: function set(json) {\n      var rt = json['refreshToken'];\n      delete json['refreshToken'];\n\n      localStorage.setItem(USER_AUTH_KEY, window.btoa(JSON.stringify(json)));\n      localStorage.setItem(REFRESH_TOKEN_KEY, rt);\n    }\n  }, {\n    key: 'get',\n    value: function get() {\n      if (localStorage.getItem(USER_AUTH_KEY) === null) {\n        return null;\n      }\n      return JSON.parse(window.atob(localStorage.getItem(USER_AUTH_KEY)));\n    }\n  }, {\n    key: 'authedId',\n    value: function authedId() {\n      var a = this.get();\n      return ((a || {}).user || {})._id;\n    }\n  }, {\n    key: 'isImpersonatingUser',\n    value: function isImpersonatingUser() {\n      return localStorage.getItem(IMPERSONATION_ACTIVE_KEY) === 'true';\n    }\n  }, {\n    key: 'refreshImpersonation',\n    value: function refreshImpersonation(client) {\n      var _this3 = this;\n\n      var userId = localStorage.getItem(IMPERSONATION_USER_KEY);\n      return client._doAuthed('/admin/users/' + userId + '/impersonate', 'POST', { refreshOnFailure: false, useRefreshToken: true }).then(function (response) {\n        return response.json().then(function (json) {\n          json['refreshToken'] = localStorage.getItem(REFRESH_TOKEN_KEY);\n          _this3.set(json);\n          return Promise.resolve();\n        });\n      }).catch(function (e) {\n        _this3.stopImpersonation();\n        throw e;\n      });\n    }\n  }, {\n    key: 'startImpersonation',\n    value: function startImpersonation(client, userId) {\n      if (this.get() === null) {\n        return Promise.reject(new BaasError('Must auth first'));\n      }\n      if (this.isImpersonatingUser()) {\n        throw new BaasError('Already impersonating a user');\n      }\n      localStorage.setItem(IMPERSONATION_ACTIVE_KEY, 'true');\n      localStorage.setItem(IMPERSONATION_USER_KEY, userId);\n\n      var realUserAuth = JSON.parse(window.atob(localStorage.getItem(USER_AUTH_KEY)));\n      realUserAuth['refreshToken'] = localStorage.getItem(REFRESH_TOKEN_KEY);\n      localStorage.setItem(IMPERSONATION_REAL_USER_AUTH_KEY, window.btoa(JSON.stringify(realUserAuth)));\n      return this.refreshImpersonation(client);\n    }\n  }, {\n    key: 'stopImpersonation',\n    value: function stopImpersonation() {\n      var root = this;\n      return new Promise(function (resolve, reject) {\n        if (!root.isImpersonatingUser()) {\n          throw new BaasError('Not impersonating a user');\n        }\n        var realUserAuth = JSON.parse(window.atob(localStorage.getItem(IMPERSONATION_REAL_USER_AUTH_KEY)));\n        root.set(realUserAuth);\n        root.clearImpersonation();\n        resolve();\n      });\n    }\n  }, {\n    key: 'clearImpersonation',\n    value: function clearImpersonation() {\n      localStorage.removeItem(IMPERSONATION_ACTIVE_KEY);\n      localStorage.removeItem(IMPERSONATION_USER_KEY);\n      localStorage.removeItem(IMPERSONATION_REAL_USER_AUTH_KEY);\n    }\n  }], [{\n    key: 'generateState',\n    value: function generateState() {\n      var alpha = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n      var state = '';\n      for (var i = 0; i < stateLength; i++) {\n        var pos = Math.floor(Math.random() * alpha.length);\n        state += alpha.substring(pos, pos + 1);\n      }\n      return state;\n    }\n  }]);\n\n  return Auth;\n}();\n\nvar BaasClient = exports.BaasClient = function () {\n  function BaasClient(app, options) {\n    _classCallCheck(this, BaasClient);\n\n    var baseUrl = DEFAULT_BAAS_SERVER_URL;\n    if (options && options.baseUrl) {\n      baseUrl = options.baseUrl;\n    }\n    this.appUrl = baseUrl + '/admin/v1';\n    this.authUrl = baseUrl + '/admin/v1/auth';\n    if (app) {\n      this.appUrl = baseUrl + '/v1/app/' + app;\n      this.authUrl = this.appUrl + '/auth';\n    }\n    this.authManager = new Auth(this.authUrl);\n    this.authManager.handleRedirect();\n  }\n\n  _createClass(BaasClient, [{\n    key: 'authWithOAuth',\n    value: function authWithOAuth(providerName, redirectUrl) {\n      window.location.replace(this.authManager.getOAuthLoginURL(providerName, redirectUrl));\n    }\n  }, {\n    key: 'authedId',\n    value: function authedId() {\n      return this.authManager.authedId();\n    }\n  }, {\n    key: 'auth',\n    value: function auth() {\n      return this.authManager.get();\n    }\n  }, {\n    key: 'authError',\n    value: function authError() {\n      return this.authManager.error();\n    }\n  }, {\n    key: 'logout',\n    value: function logout() {\n      var _this4 = this;\n\n      return this._doAuthed('/auth', 'DELETE', { refreshOnFailure: false, useRefreshToken: true }).then(function (data) {\n        _this4.authManager.clear();\n      });\n    }\n\n    // wrapper around fetch() that matches the signature of doAuthed but does not\n    // actually use any auth. This is necessary for routes that must be\n    // accessible without logging in, like listing available auth providers.\n\n  }, {\n    key: '_do',\n    value: function _do(resource, method, options) {\n      options = options || {};\n      var url = '' + this.appUrl + resource;\n      var init = {\n        method: method,\n        headers: { 'Accept': JSONTYPE, 'Content-Type': JSONTYPE }\n      };\n      if (options.body) {\n        init['body'] = options.body;\n      }\n      if (options.queryParams) {\n        url = url + '?' + toQueryString(options.queryParams);\n      }\n\n      return fetch(url, init).then(function (response) {\n        // Okay: passthrough\n        if (response.status >= 200 && response.status < 300) {\n          return Promise.resolve(response);\n        } else if (response.headers.get('Content-Type') === JSONTYPE) {\n          return response.json().then(function (json) {\n            var error = new BaasError(json['error'], json['errorCode']);\n            error.response = response;\n            throw error;\n          });\n        }\n        var error = new Error(response.statusText);\n        error.response = response;\n        throw error;\n      }).then(function (response) {\n        return response.json();\n      });\n    }\n  }, {\n    key: '_doAuthed',\n    value: function _doAuthed(resource, method, options) {\n      var _this5 = this;\n\n      if (options === undefined) {\n        options = { refreshOnFailure: true, useRefreshToken: false };\n      } else {\n        if (options.refreshOnFailure === undefined) {\n          options.refreshOnFailure = true;\n        }\n        if (options.useRefreshToken === undefined) {\n          options.useRefreshToken = false;\n        }\n      }\n\n      if (this.auth() === null) {\n        return Promise.reject(new BaasError('Must auth first'));\n      }\n\n      var url = '' + this.appUrl + resource;\n\n      var headers = {\n        'Accept': JSONTYPE,\n        'Content-Type': JSONTYPE\n      };\n      var token = options.useRefreshToken ? localStorage.getItem(REFRESH_TOKEN_KEY) : this.auth()['accessToken'];\n      headers['Authorization'] = 'Bearer ' + token;\n\n      var init = {\n        method: method,\n        headers: headers\n      };\n\n      if (options.body) {\n        init['body'] = options.body;\n      }\n\n      if (options.queryParams) {\n        url = url + '?' + toQueryString(options.queryParams);\n      }\n\n      return fetch(url, init).then(function (response) {\n        // Okay: passthrough\n        if (response.status >= 200 && response.status < 300) {\n          return Promise.resolve(response);\n        } else if (response.headers.get('Content-Type') === JSONTYPE) {\n          return response.json().then(function (json) {\n            // Only want to try refreshing token when there's an invalid session\n            if ('errorCode' in json && json['errorCode'] === ErrInvalidSession) {\n              if (!options.refreshOnFailure) {\n                _this5.authManager.clear();\n                var _error = new BaasError(json['error'], json['errorCode']);\n                _error.response = response;\n                throw _error;\n              }\n\n              return _this5._refreshToken().then(function () {\n                options.refreshOnFailure = false;\n                return _this5._doAuthed(resource, method, options);\n              });\n            }\n\n            var error = new BaasError(json['error'], json['errorCode']);\n            error.response = response;\n            throw error;\n          });\n        }\n\n        var error = new Error(response.statusText);\n        error.response = response;\n        throw error;\n      });\n    }\n  }, {\n    key: '_refreshToken',\n    value: function _refreshToken() {\n      var _this6 = this;\n\n      if (this.authManager.isImpersonatingUser()) {\n        return this.authManager.refreshImpersonation(this);\n      }\n      return this._doAuthed('/auth/newAccessToken', 'POST', { refreshOnFailure: false, useRefreshToken: true }).then(function (response) {\n        return response.json().then(function (json) {\n          _this6.authManager.setAccessToken(json['accessToken']);\n          return Promise.resolve();\n        });\n      });\n    }\n  }, {\n    key: 'executePipeline',\n    value: function executePipeline(stages) {\n      return this._doAuthed('/pipeline', 'POST', { body: JSON.stringify(stages) }).then(function (response) {\n        return response.json();\n      });\n    }\n  }]);\n\n  return BaasClient;\n}();\n\nvar DB = function () {\n  function DB(client, service, name) {\n    _classCallCheck(this, DB);\n\n    this.client = client;\n    this.service = service;\n    this.name = name;\n  }\n\n  _createClass(DB, [{\n    key: 'getCollection',\n    value: function getCollection(name) {\n      return new Collection(this, name);\n    }\n  }]);\n\n  return DB;\n}();\n\nvar Collection = function () {\n  function Collection(db, name) {\n    _classCallCheck(this, Collection);\n\n    this.db = db;\n    this.name = name;\n  }\n\n  _createClass(Collection, [{\n    key: 'getBaseArgs',\n    value: function getBaseArgs() {\n      return {\n        'database': this.db.name,\n        'collection': this.name\n      };\n    }\n  }, {\n    key: 'deleteOne',\n    value: function deleteOne(query) {\n      var args = this.getBaseArgs();\n      args.query = query;\n      args.singleDoc = true;\n      return this.db.client.executePipeline([{\n        'service': this.db.service,\n        'action': 'delete',\n        'args': args\n      }]);\n    }\n  }, {\n    key: 'deleteMany',\n    value: function deleteMany(query) {\n      var args = this.getBaseArgs();\n      args.query = query;\n      args.singleDoc = false;\n      return this.db.client.executePipeline([{\n        'service': this.db.service,\n        'action': 'delete',\n        'args': args\n      }]);\n    }\n  }, {\n    key: 'find',\n    value: function find(query, project) {\n      var args = this.getBaseArgs();\n      args.query = query;\n      args.project = project;\n      return this.db.client.executePipeline([{\n        'service': this.db.service,\n        'action': 'find',\n        'args': args\n      }]);\n    }\n  }, {\n    key: 'insert',\n    value: function insert(documents) {\n      return this.db.client.executePipeline([{ 'action': 'literal',\n        'args': {\n          'items': documents\n        }\n      }, {\n        'service': this.db.service,\n        'action': 'insert',\n        'args': this.getBaseArgs()\n      }]);\n    }\n  }, {\n    key: 'makeUpdateStage',\n    value: function makeUpdateStage(query, update, upsert, multi) {\n      var args = this.getBaseArgs();\n      args.query = query;\n      args.update = update;\n      if (upsert) {\n        args.upsert = true;\n      }\n      if (multi) {\n        args.multi = true;\n      }\n\n      return {\n        'service': this.db.service,\n        'action': 'update',\n        'args': args\n      };\n    }\n  }, {\n    key: 'updateOne',\n    value: function updateOne(query, update) {\n      return this.db.client.executePipeline([this.makeUpdateStage(query, update, false, false)]);\n    }\n  }, {\n    key: 'updateMany',\n    value: function updateMany(query, update, upsert, multi) {\n      return this.db.client.executePipeline([this.makeUpdateStage(query, update, false, true)]);\n    }\n  }, {\n    key: 'upsert',\n    value: function upsert(query, update) {\n      return this.db.client.executePipeline([this.makeUpdateStage(query, update, true, false)]);\n    }\n  }]);\n\n  return Collection;\n}();\n\nvar MongoClient = exports.MongoClient = function () {\n  function MongoClient(baasClient, serviceName) {\n    _classCallCheck(this, MongoClient);\n\n    this.baasClient = baasClient;\n    this.service = serviceName;\n  }\n\n  _createClass(MongoClient, [{\n    key: 'getDb',\n    value: function getDb(name) {\n      return new DB(this.baasClient, this.service, name);\n    }\n  }]);\n\n  return MongoClient;\n}();\n\nvar Admin = exports.Admin = function () {\n  function Admin(baseUrl) {\n    _classCallCheck(this, Admin);\n\n    this.client = new BaasClient('', { baseUrl: baseUrl });\n  }\n\n  _createClass(Admin, [{\n    key: '_doAuthed',\n    value: function _doAuthed(url, method, options) {\n      return this.client._doAuthed(url, method, options).then(function (response) {\n        return response.json();\n      });\n    }\n  }, {\n    key: '_get',\n    value: function _get(url, queryParams) {\n      return this._doAuthed(url, 'GET', { queryParams: queryParams });\n    }\n  }, {\n    key: '_put',\n    value: function _put(url, queryParams) {\n      return this._doAuthed(url, 'PUT', { queryParams: queryParams });\n    }\n  }, {\n    key: '_delete',\n    value: function _delete(url) {\n      return this._doAuthed(url, 'DELETE');\n    }\n  }, {\n    key: '_post',\n    value: function _post(url, body) {\n      return this._doAuthed(url, 'POST', { body: JSON.stringify(body) });\n    }\n  }, {\n    key: 'profile',\n    value: function profile() {\n      var _this7 = this;\n\n      var root = this;\n      return {\n        keys: function keys() {\n          return {\n            list: function list() {\n              return root._get('/profile/keys');\n            },\n            create: function create(key) {\n              return root._post('/profile/keys');\n            },\n            apiKey: function apiKey(keyId) {\n              return {\n                get: function get() {\n                  return root._get('/profile/keys/' + keyId);\n                },\n                remove: function remove() {\n                  return _this7._delete('/profile/keys/' + keyId);\n                },\n                enable: function enable() {\n                  return root._put('/profile/keys/' + keyId + '/enable');\n                },\n                disable: function disable() {\n                  return root._put('/profile/keys/' + keyId + '/disable');\n                }\n              };\n            }\n          };\n        }\n      };\n    }\n\n    /* Examples of how to access admin API with this client:\n     *\n     * List all apps\n     *    a.apps().list()\n     *\n     * Fetch app under name 'planner'\n     *    a.apps().app('planner').get()\n     *\n     * List services under the app 'planner'\n     *    a.apps().app('planner').services().list()\n     *\n     * Delete a rule by ID\n     *    a.apps().app('planner').services().service('mdb1').rules().rule('580e6d055b199c221fcb821d').remove()\n     *\n     */\n\n  }, {\n    key: 'apps',\n    value: function apps() {\n      var _this8 = this;\n\n      var root = this;\n      return {\n        list: function list() {\n          return root._get('/apps');\n        },\n        create: function create(data) {\n          return root._post('/apps', data);\n        },\n        app: function app(_app) {\n          return {\n            get: function get() {\n              return root._get('/apps/' + _app);\n            },\n            remove: function remove() {\n              return root._delete('/apps/' + _app);\n            },\n\n            users: function users() {\n              return {\n                list: function list(filter) {\n                  return _this8._get('/apps/' + _app + '/users', filter);\n                },\n                user: function user(uid) {\n                  return {\n                    get: function get() {\n                      return _this8._get('/apps/' + _app + '/users/' + uid);\n                    },\n                    logout: function logout() {\n                      return _this8._put('/apps/' + _app + '/users/' + uid + '/logout');\n                    }\n                  };\n                }\n              };\n            },\n\n            authProviders: function authProviders() {\n              return {\n                create: function create(data) {\n                  return _this8._post('/apps/' + _app + '/authProviders', data);\n                },\n                list: function list() {\n                  return _this8._get('/apps/' + _app + '/authProviders');\n                },\n                provider: function provider(authType, authName) {\n                  return {\n                    get: function get() {\n                      return _this8._get('/apps/' + _app + '/authProviders/' + authType + '/' + authName);\n                    },\n                    remove: function remove() {\n                      return _this8._delete('/apps/' + _app + '/authProviders/' + authType + '/' + authName);\n                    },\n                    update: function update(data) {\n                      return _this8._post('/apps/' + _app + '/authProviders/' + authType + '/' + authName, data);\n                    }\n                  };\n                }\n              };\n            },\n            variables: function variables() {\n              return {\n                list: function list() {\n                  return _this8._get('/apps/' + _app + '/vars');\n                },\n                variable: function variable(varName) {\n                  return {\n                    get: function get() {\n                      return _this8._get('/apps/' + _app + '/vars/' + varName);\n                    },\n                    remove: function remove() {\n                      return _this8._delete('/apps/' + _app + '/vars/' + varName);\n                    },\n                    create: function create(data) {\n                      return _this8._post('/apps/' + _app + '/vars/' + varName, data);\n                    },\n                    update: function update(data) {\n                      return _this8._post('/apps/' + _app + '/vars/' + varName, data);\n                    }\n                  };\n                }\n              };\n            },\n            logs: function logs() {\n              return {\n                get: function get(filter) {\n                  return _this8._get('/apps/' + _app + '/logs', filter);\n                }\n              };\n            },\n            apiKeys: function apiKeys() {\n              return {\n                list: function list() {\n                  return _this8._get('/apps/' + _app + '/keys');\n                },\n                create: function create(data) {\n                  return _this8._post('/apps/' + _app + '/keys', data);\n                },\n                apiKey: function apiKey(key) {\n                  return {\n                    get: function get() {\n                      return _this8._get('/apps/' + _app + '/keys/' + key);\n                    },\n                    remove: function remove() {\n                      return _this8._delete('/apps/' + _app + '/keys/' + key);\n                    },\n                    enable: function enable() {\n                      return _this8._put('/apps/' + _app + '/keys/' + key + '/enable');\n                    },\n                    disable: function disable() {\n                      return _this8._put('/apps/' + _app + '/keys/' + key + '/disable');\n                    }\n                  };\n                }\n              };\n            },\n            services: function services() {\n              return {\n                list: function list() {\n                  return _this8._get('/apps/' + _app + '/services');\n                },\n                create: function create(data) {\n                  return _this8._post('/apps/' + _app + '/services', data);\n                },\n                service: function service(svc) {\n                  return {\n                    get: function get() {\n                      return _this8._get('/apps/' + _app + '/services/' + svc);\n                    },\n                    update: function update(data) {\n                      return _this8._post('/apps/' + _app + '/services/' + svc, data);\n                    },\n                    remove: function remove() {\n                      return _this8._delete('/apps/' + _app + '/services/' + svc);\n                    },\n                    setConfig: function setConfig(data) {\n                      return _this8._post('/apps/' + _app + '/services/' + svc + '/config', data);\n                    },\n\n                    rules: function rules() {\n                      return {\n                        list: function list() {\n                          return _this8._get('/apps/' + _app + '/services/' + svc + '/rules');\n                        },\n                        create: function create(data) {\n                          return _this8._post('/apps/' + _app + '/services/' + svc + '/rules');\n                        },\n                        rule: function rule(ruleId) {\n                          return {\n                            get: function get() {\n                              return _this8._get('/apps/' + _app + '/services/' + svc + '/rules/' + ruleId);\n                            },\n                            update: function update(data) {\n                              return _this8._post('/apps/' + _app + '/services/' + svc + '/rules/' + ruleId, data);\n                            },\n                            remove: function remove() {\n                              return _this8._delete('/apps/' + _app + '/services/' + svc + '/rules/' + ruleId);\n                            }\n                          };\n                        }\n                      };\n                    },\n\n                    triggers: function triggers() {\n                      return {\n                        list: function list() {\n                          return _this8._get('/apps/' + _app + '/services/' + svc + '/triggers');\n                        },\n                        create: function create(data) {\n                          return _this8._post('/apps/' + _app + '/services/' + svc + '/triggers');\n                        },\n                        trigger: function trigger(triggerId) {\n                          return {\n                            get: function get() {\n                              return _this8._get('/apps/' + _app + '/services/' + svc + '/triggers/' + triggerId);\n                            },\n                            update: function update(data) {\n                              return _this8._post('/apps/' + _app + '/services/' + svc + '/triggers/' + triggerId, data);\n                            },\n                            remove: function remove() {\n                              return _this8._delete('/apps/' + _app + '/services/' + svc + '/triggers/' + triggerId);\n                            }\n                          };\n                        }\n                      };\n                    }\n                  };\n                }\n              };\n            }\n          };\n        }\n      };\n    }\n  }, {\n    key: '_admin',\n    value: function _admin() {\n      var _this9 = this;\n\n      return {\n        logs: function logs() {\n          return {\n            get: function get(filter) {\n              return _this9._doAuthed('/admin/logs', 'GET', { useRefreshToken: true, queryParams: filter });\n            }\n          };\n        },\n        users: function users() {\n          return {\n            list: function list(filter) {\n              return _this9._doAuthed('/admin/users', 'GET', { useRefreshToken: true, queryParams: filter });\n            },\n            user: function user(uid) {\n              return {\n                logout: function logout() {\n                  return _this9._doAuthed('/admin/users/' + uid + '/logout', 'PUT', { useRefreshToken: true });\n                }\n              };\n            }\n          };\n        }\n      };\n    }\n  }, {\n    key: '_isImpersonatingUser',\n    value: function _isImpersonatingUser() {\n      return this.client.authManager.isImpersonatingUser();\n    }\n  }, {\n    key: '_startImpersonation',\n    value: function _startImpersonation(userId) {\n      return this.client.authManager.startImpersonation(this.client, userId);\n    }\n  }, {\n    key: '_stopImpersonation',\n    value: function _stopImpersonation(userId) {\n      return this.client.authManager.stopImpersonation();\n    }\n  }]);\n\n  return Admin;\n}();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./distribution/client.js\n// module id = 0\n// module chunks = 0 1","(function(self) {\n  'use strict';\n\n  if (self.fetch) {\n    return\n  }\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob: 'FileReader' in self && 'Blob' in self && (function() {\n      try {\n        new Blob()\n        return true\n      } catch(e) {\n        return false\n      }\n    })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ]\n\n    var isDataView = function(obj) {\n      return obj && DataView.prototype.isPrototypeOf(obj)\n    }\n\n    var isArrayBufferView = ArrayBuffer.isView || function(obj) {\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n    }\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name)\n    }\n    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value)\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift()\n        return {done: value === undefined, value: value}\n      }\n    }\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      }\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {}\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value)\n      }, this)\n\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name])\n      }, this)\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name)\n    value = normalizeValue(value)\n    var oldValue = this.map[name]\n    this.map[name] = oldValue ? oldValue+','+value : value\n  }\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)]\n  }\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name)\n    return this.has(name) ? this.map[name] : null\n  }\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  }\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value)\n  }\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this)\n      }\n    }\n  }\n\n  Headers.prototype.keys = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push(name) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.values = function() {\n    var items = []\n    this.forEach(function(value) { items.push(value) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.entries = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push([name, value]) })\n    return iteratorFor(items)\n  }\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result)\n      }\n      reader.onerror = function() {\n        reject(reader.error)\n      }\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsArrayBuffer(blob)\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsText(blob)\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf)\n    var chars = new Array(view.length)\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i])\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength)\n      view.set(new Uint8Array(buf))\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false\n\n    this._initBody = function(body) {\n      this._bodyInit = body\n      if (!body) {\n        this._bodyText = ''\n      } else if (typeof body === 'string') {\n        this._bodyText = body\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString()\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer)\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer])\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body)\n      } else {\n        throw new Error('unsupported BodyInit type')\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type)\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n        }\n      }\n    }\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      }\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      }\n    }\n\n    this.text = function() {\n      var rejected = consumed(this)\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    }\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      }\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    }\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase()\n    return (methods.indexOf(upcased) > -1) ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {}\n    var body = options.body\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url\n      this.credentials = input.credentials\n      if (!options.headers) {\n        this.headers = new Headers(input.headers)\n      }\n      this.method = input.method\n      this.mode = input.mode\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit\n        input.bodyUsed = true\n      }\n    } else {\n      this.url = String(input)\n    }\n\n    this.credentials = options.credentials || this.credentials || 'omit'\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers)\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET')\n    this.mode = options.mode || this.mode || null\n    this.referrer = null\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body)\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, { body: this._bodyInit })\n  }\n\n  function decode(body) {\n    var form = new FormData()\n    body.trim().split('&').forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers()\n    rawHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':')\n      var key = parts.shift().trim()\n      if (key) {\n        var value = parts.join(':').trim()\n        headers.append(key, value)\n      }\n    })\n    return headers\n  }\n\n  Body.call(Request.prototype)\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {}\n    }\n\n    this.type = 'default'\n    this.status = 'status' in options ? options.status : 200\n    this.ok = this.status >= 200 && this.status < 300\n    this.statusText = 'statusText' in options ? options.statusText : 'OK'\n    this.headers = new Headers(options.headers)\n    this.url = options.url || ''\n    this._initBody(bodyInit)\n  }\n\n  Body.call(Response.prototype)\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  }\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''})\n    response.type = 'error'\n    return response\n  }\n\n  var redirectStatuses = [301, 302, 303, 307, 308]\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  }\n\n  self.Headers = Headers\n  self.Request = Request\n  self.Response = Response\n\n  self.fetch = function(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init)\n      var xhr = new XMLHttpRequest()\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        }\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n        var body = 'response' in xhr ? xhr.response : xhr.responseText\n        resolve(new Response(body, options))\n      }\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.open(request.method, request.url, true)\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob'\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n    })\n  }\n  self.fetch.polyfill = true\n})(typeof self !== 'undefined' ? self : this);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/whatwg-fetch/fetch.js\n// module id = 1\n// module chunks = 0 1"],"sourceRoot":""}