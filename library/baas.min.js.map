{"version":3,"sources":["webpack:///baas.min.js","webpack:///webpack/bootstrap 389c217c2f797fd2abe7?c513","webpack:///./distribution/client.js?77eb","webpack:///./~/whatwg-fetch/fetch.js?1c20"],"names":["Baas","modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","Admin","MongoClient","BaasClient","Auth","BaasError","parseRedirectFragment","ErrInvalidSession","ErrAuthProviderNotFound","undefined","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","USER_AUTH_KEY","REFRESH_TOKEN_KEY","STATE_KEY","BAAS_ERROR_KEY","BAAS_LINK_KEY","IMPERSONATION_ACTIVE_KEY","IMPERSONATION_USER_KEY","IMPERSONATION_REAL_USER_AUTH_KEY","DEFAULT_BAAS_SERVER_URL","JSONTYPE","stateLength","toQueryString","obj","parts","hasOwnProperty","push","encodeURIComponent","join","checkStatus","response","status","error","Error","statusText","fragment","ourState","vars","split","result","ua","found","stateValid","lastError","_iteratorNormalCompletion","_didIteratorError","_iteratorError","outerloop","_step","_iterator","Symbol","iterator","next","done","pair","pairParts","pairKey","decodeURIComponent","JSON","parse","window","atob","theirState","err","return","_Error","message","code","this","_this","getPrototypeOf","name","captureStackTrace","stack","rootUrl","location","protocol","host","pathname","token","currAuth","get","localStorage","getItem","set","redirectFragment","hash","substring","redirectState","console","history","replaceState","pageRootUrl","removeItem","providerName","redirectUrl","state","generateState","setItem","encodeURI","username","password","cors","_this2","init","method","headers","Accept","Content-Type","body","stringify","fetch","then","json","Promise","resolve","rt","btoa","a","user","_id","client","_this3","userId","_doAuthed","refreshOnFailure","useRefreshToken","catch","e","stopImpersonation","reject","isImpersonatingUser","realUserAuth","refreshImpersonation","root","clearImpersonation","alpha","pos","Math","floor","random","app","options","baseUrl","appUrl","authUrl","authManager","handleRedirect","replace","getOAuthLoginURL","authedId","_this4","data","clear","resource","url","queryParams","_this5","auth","_error","_refreshToken","_this6","setAccessToken","stages","DB","service","Collection","db","database","collection","query","args","getBaseArgs","singleDoc","executePipeline","action","project","documents","items","update","upsert","multi","makeUpdateStage","baasClient","serviceName","_this7","keys","list","_get","_post","apiKey","keyId","remove","_delete","enable","_put","disable","_this8","_app","users","filter","uid","authProviders","provider","authType","authName","variables","variable","varName","logs","apiKeys","services","svc","setConfig","rules","rule","ruleId","triggers","trigger","triggerId","startImpersonation","normalizeName","String","test","toLowerCase","normalizeValue","iteratorFor","shift","support","iterable","Headers","map","forEach","append","getOwnPropertyNames","consumed","bodyUsed","fileReaderReady","reader","onload","onerror","readBlobAsArrayBuffer","blob","FileReader","promise","readAsArrayBuffer","readBlobAsText","readAsText","readArrayBufferAsText","buf","view","Uint8Array","chars","Array","fromCharCode","bufferClone","slice","byteLength","buffer","Body","_initBody","_bodyInit","_bodyText","Blob","isPrototypeOf","_bodyBlob","formData","FormData","_bodyFormData","searchParams","URLSearchParams","toString","arrayBuffer","isDataView","_bodyArrayBuffer","ArrayBuffer","isArrayBufferView","type","rejected","text","decode","normalizeMethod","upcased","toUpperCase","methods","indexOf","Request","input","credentials","mode","referrer","form","trim","bytes","parseHeaders","rawHeaders","line","Response","bodyInit","ok","viewClasses","DataView","isView","oldValue","has","callback","thisArg","values","entries","clone","redirectStatuses","redirect","RangeError","request","xhr","XMLHttpRequest","getAllResponseHeaders","responseURL","responseText","ontimeout","open","withCredentials","responseType","setRequestHeader","send","polyfill"],"mappings":"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","file":"baas.min.js","sourcesContent":["var Baas =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.Admin = exports.MongoClient = exports.BaasClient = exports.Auth = exports.BaasError = exports.parseRedirectFragment = exports.ErrInvalidSession = exports.ErrAuthProviderNotFound = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\t__webpack_require__(1);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /* global window, localStorage, fetch */\n\t/* eslint no-labels: ['error', { 'allowLoop': true }] */\n\t\n\t\n\t// fetch polyfill\n\t\n\tvar USER_AUTH_KEY = '_baas_ua';\n\tvar REFRESH_TOKEN_KEY = '_baas_rt';\n\tvar STATE_KEY = '_baas_state';\n\tvar BAAS_ERROR_KEY = '_baas_error';\n\tvar BAAS_LINK_KEY = '_baas_link';\n\tvar IMPERSONATION_ACTIVE_KEY = '_baas_impers_active';\n\tvar IMPERSONATION_USER_KEY = '_baas_impers_user';\n\tvar IMPERSONATION_REAL_USER_AUTH_KEY = '_baas_impers_real_ua';\n\tvar DEFAULT_BAAS_SERVER_URL = 'https://baas-dev.10gen.cc';\n\tvar JSONTYPE = 'application/json';\n\t\n\tvar ErrAuthProviderNotFound = exports.ErrAuthProviderNotFound = 'AuthProviderNotFound';\n\tvar ErrInvalidSession = exports.ErrInvalidSession = 'InvalidSession';\n\tvar stateLength = 64;\n\t\n\tvar toQueryString = function toQueryString(obj) {\n\t  var parts = [];\n\t  for (var i in obj) {\n\t    if (obj.hasOwnProperty(i)) {\n\t      parts.push(encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]));\n\t    }\n\t  }\n\t  return parts.join('&');\n\t};\n\t\n\tvar checkStatus = function checkStatus(response) {\n\t  if (response.status >= 200 && response.status < 300) {\n\t    return response;\n\t  } else {\n\t    var error = new Error(response.statusText);\n\t    error.response = response;\n\t    throw error;\n\t  }\n\t};\n\t\n\tvar parseRedirectFragment = exports.parseRedirectFragment = function parseRedirectFragment(fragment, ourState) {\n\t  // After being redirected from oauth, the URL will look like:\n\t  // https://todo.examples.baas-dev.10gen.cc/#_baas_state=...&_baas_ua=...\n\t  // This function parses out baas-specific tokens from the fragment and\n\t  // builds an object describing the result.\n\t  var vars = fragment.split('&');\n\t  var result = { ua: null, found: false, stateValid: false, lastError: null };\n\t  var _iteratorNormalCompletion = true;\n\t  var _didIteratorError = false;\n\t  var _iteratorError = undefined;\n\t\n\t  try {\n\t    outerloop: for (var _iterator = vars[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t      var pair = _step.value;\n\t\n\t      var pairParts = pair.split('=');\n\t      var pairKey = decodeURIComponent(pairParts[0]);\n\t      switch (pairKey) {\n\t        case BAAS_ERROR_KEY:\n\t          result.lastError = decodeURIComponent(pairParts[1]);\n\t          result.found = true;\n\t          break outerloop;\n\t        case USER_AUTH_KEY:\n\t          result.ua = JSON.parse(window.atob(decodeURIComponent(pairParts[1])));\n\t          result.found = true;\n\t          continue;\n\t        case BAAS_LINK_KEY:\n\t          result.found = true;\n\t          continue;\n\t        case STATE_KEY:\n\t          result.found = true;\n\t          var theirState = decodeURIComponent(pairParts[1]);\n\t          if (ourState && ourState === theirState) {\n\t            result.stateValid = true;\n\t          }\n\t      }\n\t    }\n\t  } catch (err) {\n\t    _didIteratorError = true;\n\t    _iteratorError = err;\n\t  } finally {\n\t    try {\n\t      if (!_iteratorNormalCompletion && _iterator.return) {\n\t        _iterator.return();\n\t      }\n\t    } finally {\n\t      if (_didIteratorError) {\n\t        throw _iteratorError;\n\t      }\n\t    }\n\t  }\n\t\n\t  return result;\n\t};\n\t\n\tvar BaasError = exports.BaasError = function (_Error) {\n\t  _inherits(BaasError, _Error);\n\t\n\t  function BaasError(message, code) {\n\t    _classCallCheck(this, BaasError);\n\t\n\t    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(BaasError).call(this, message));\n\t\n\t    _this.name = 'BaasError';\n\t    _this.message = message;\n\t    if (code !== undefined) {\n\t      _this.code = code;\n\t    }\n\t    if (typeof Error.captureStackTrace === 'function') {\n\t      Error.captureStackTrace(_this, _this.constructor);\n\t    } else {\n\t      _this.stack = new Error(message).stack;\n\t    }\n\t    return _this;\n\t  }\n\t\n\t  return BaasError;\n\t}(Error);\n\t\n\tvar Auth = exports.Auth = function () {\n\t  function Auth(rootUrl) {\n\t    _classCallCheck(this, Auth);\n\t\n\t    this.rootUrl = rootUrl;\n\t  }\n\t\n\t  _createClass(Auth, [{\n\t    key: 'pageRootUrl',\n\t    value: function pageRootUrl() {\n\t      return [window.location.protocol, '//', window.location.host, window.location.pathname].join('');\n\t    }\n\t\n\t    // The state we generate is to be used for any kind of request where we will\n\t    // complete an authentication flow via a redirect. We store the generate in\n\t    // a local storage bound to the app's origin. This ensures that any time we\n\t    // receive a redirect, there must be a state parameter and it must match\n\t    // what we ourselves have generated. This state MUST only be sent to\n\t    // a trusted BaaS endpoint in order to preserve its integrity. BaaS will\n\t    // store it in some way on its origin (currently a cookie stored on this client)\n\t    // and use that state at the end of an auth flow as a parameter in the redirect URI.\n\t\n\t  }, {\n\t    key: 'setAccessToken',\n\t    value: function setAccessToken(token) {\n\t      var currAuth = this.get();\n\t      currAuth['accessToken'] = token;\n\t      currAuth['refreshToken'] = localStorage.getItem(REFRESH_TOKEN_KEY);\n\t      this.set(currAuth);\n\t    }\n\t  }, {\n\t    key: 'handleRedirect',\n\t    value: function handleRedirect() {\n\t      var ourState = localStorage.getItem(STATE_KEY);\n\t      var redirectFragment = window.location.hash.substring(1);\n\t      var redirectState = parseRedirectFragment(redirectFragment, ourState);\n\t      if (redirectState.lastError) {\n\t        console.error('BaasClient: error from redirect: ' + redirectState.lastError);\n\t        window.history.replaceState(null, '', this.pageRootUrl());\n\t        return;\n\t      }\n\t      if (!redirectState.found) {\n\t        return;\n\t      }\n\t      localStorage.removeItem(STATE_KEY);\n\t      if (!redirectState.stateValid) {\n\t        console.error('BaasClient: state values did not match!');\n\t        window.history.replaceState(null, '', this.pageRootUrl());\n\t        return;\n\t      }\n\t      if (!redirectState.ua) {\n\t        console.error('BaasClient: no UA value was returned from redirect!');\n\t        return;\n\t      }\n\t      // If we get here, the state is valid - set auth appropriately.\n\t      this.set(redirectState.ua);\n\t      window.history.replaceState(null, '', this.pageRootUrl());\n\t    }\n\t  }, {\n\t    key: 'getOAuthLoginURL',\n\t    value: function getOAuthLoginURL(providerName, redirectUrl) {\n\t      if (redirectUrl === undefined) {\n\t        redirectUrl = this.pageRootUrl();\n\t      }\n\t      var state = Auth.generateState();\n\t      localStorage.setItem(STATE_KEY, state);\n\t      var result = this.rootUrl + '/oauth2/' + providerName + '?redirect=' + encodeURI(redirectUrl) + '&state=' + state;\n\t      return result;\n\t    }\n\t  }, {\n\t    key: 'localAuth',\n\t    value: function localAuth(username, password, cors) {\n\t      var _this2 = this;\n\t\n\t      var init = {\n\t        method: 'POST',\n\t        headers: {\n\t          'Accept': JSONTYPE,\n\t          'Content-Type': JSONTYPE\n\t        },\n\t        body: JSON.stringify({ 'username': username, 'password': password })\n\t      };\n\t\n\t      if (cors) {\n\t        init['cors'] = cors;\n\t      }\n\t\n\t      return fetch(this.rootUrl + '/local/userpass', init).then(checkStatus).then(function (response) {\n\t        return response.json().then(function (json) {\n\t          _this2.set(json);\n\t          Promise.resolve();\n\t        });\n\t      });\n\t    }\n\t  }, {\n\t    key: 'clear',\n\t    value: function clear() {\n\t      localStorage.removeItem(USER_AUTH_KEY);\n\t      localStorage.removeItem(REFRESH_TOKEN_KEY);\n\t    }\n\t  }, {\n\t    key: 'set',\n\t    value: function set(json) {\n\t      var rt = json['refreshToken'];\n\t      delete json['refreshToken'];\n\t\n\t      localStorage.setItem(USER_AUTH_KEY, window.btoa(JSON.stringify(json)));\n\t      localStorage.setItem(REFRESH_TOKEN_KEY, rt);\n\t    }\n\t  }, {\n\t    key: 'get',\n\t    value: function get() {\n\t      if (localStorage.getItem(USER_AUTH_KEY) === null) {\n\t        return null;\n\t      }\n\t      return JSON.parse(window.atob(localStorage.getItem(USER_AUTH_KEY)));\n\t    }\n\t  }, {\n\t    key: 'authedId',\n\t    value: function authedId() {\n\t      var a = this.get();\n\t      return ((a || {}).user || {})._id;\n\t    }\n\t  }, {\n\t    key: 'isImpersonatingUser',\n\t    value: function isImpersonatingUser() {\n\t      return localStorage.getItem(IMPERSONATION_ACTIVE_KEY) === 'true';\n\t    }\n\t  }, {\n\t    key: 'refreshImpersonation',\n\t    value: function refreshImpersonation(client) {\n\t      var _this3 = this;\n\t\n\t      var userId = localStorage.getItem(IMPERSONATION_USER_KEY);\n\t      return client._doAuthed('/admin/impersonate/' + userId, 'POST', { refreshOnFailure: false, useRefreshToken: true }).then(function (response) {\n\t        return response.json().then(function (json) {\n\t          json['refreshToken'] = localStorage.getItem(REFRESH_TOKEN_KEY);\n\t          _this3.set(json);\n\t          return Promise.resolve();\n\t        });\n\t      }).catch(function (e) {\n\t        _this3.stopImpersonation();\n\t        throw e;\n\t      });\n\t    }\n\t  }, {\n\t    key: 'startImpersonation',\n\t    value: function startImpersonation(client, userId) {\n\t      if (this.get() === null) {\n\t        return Promise.reject(new BaasError('Must auth first'));\n\t      }\n\t      if (this.isImpersonatingUser()) {\n\t        throw new BaasError('Already impersonating a user');\n\t      }\n\t      localStorage.setItem(IMPERSONATION_ACTIVE_KEY, 'true');\n\t      localStorage.setItem(IMPERSONATION_USER_KEY, userId);\n\t\n\t      var realUserAuth = JSON.parse(window.atob(localStorage.getItem(USER_AUTH_KEY)));\n\t      realUserAuth['refreshToken'] = localStorage.getItem(REFRESH_TOKEN_KEY);\n\t      localStorage.setItem(IMPERSONATION_REAL_USER_AUTH_KEY, window.btoa(JSON.stringify(realUserAuth)));\n\t      return this.refreshImpersonation(client);\n\t    }\n\t  }, {\n\t    key: 'stopImpersonation',\n\t    value: function stopImpersonation() {\n\t      var root = this;\n\t      return new Promise(function (resolve, reject) {\n\t        if (!root.isImpersonatingUser()) {\n\t          throw new BaasError('Not impersonating a user');\n\t        }\n\t        var realUserAuth = JSON.parse(window.atob(localStorage.getItem(IMPERSONATION_REAL_USER_AUTH_KEY)));\n\t        root.set(realUserAuth);\n\t        root.clearImpersonation();\n\t        resolve();\n\t      });\n\t    }\n\t  }, {\n\t    key: 'clearImpersonation',\n\t    value: function clearImpersonation() {\n\t      localStorage.removeItem(IMPERSONATION_ACTIVE_KEY);\n\t      localStorage.removeItem(IMPERSONATION_USER_KEY);\n\t      localStorage.removeItem(IMPERSONATION_REAL_USER_AUTH_KEY);\n\t    }\n\t  }], [{\n\t    key: 'generateState',\n\t    value: function generateState() {\n\t      var alpha = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\t      var state = '';\n\t      for (var i = 0; i < stateLength; i++) {\n\t        var pos = Math.floor(Math.random() * alpha.length);\n\t        state += alpha.substring(pos, pos + 1);\n\t      }\n\t      return state;\n\t    }\n\t  }]);\n\t\n\t  return Auth;\n\t}();\n\t\n\tvar BaasClient = exports.BaasClient = function () {\n\t  function BaasClient(app, options) {\n\t    _classCallCheck(this, BaasClient);\n\t\n\t    var baseUrl = DEFAULT_BAAS_SERVER_URL;\n\t    if (options && options.baseUrl) {\n\t      baseUrl = options.baseUrl;\n\t    }\n\t    this.appUrl = baseUrl + '/admin/v1';\n\t    this.authUrl = baseUrl + '/admin/v1/auth';\n\t    if (app) {\n\t      this.appUrl = baseUrl + '/v1/app/' + app;\n\t      this.authUrl = this.appUrl + '/auth';\n\t    }\n\t    this.authManager = new Auth(this.authUrl);\n\t    this.authManager.handleRedirect();\n\t  }\n\t\n\t  _createClass(BaasClient, [{\n\t    key: 'authWithOAuth',\n\t    value: function authWithOAuth(providerName, redirectUrl) {\n\t      window.location.replace(this.authManager.getOAuthLoginURL(providerName, redirectUrl));\n\t    }\n\t  }, {\n\t    key: 'authedId',\n\t    value: function authedId() {\n\t      return this.authManager.authedId();\n\t    }\n\t  }, {\n\t    key: 'auth',\n\t    value: function auth() {\n\t      return this.authManager.get();\n\t    }\n\t  }, {\n\t    key: 'logout',\n\t    value: function logout() {\n\t      var _this4 = this;\n\t\n\t      return this._doAuthed('/auth', 'DELETE', { refreshOnFailure: false, useRefreshToken: true }).then(function (data) {\n\t        _this4.authManager.clear();\n\t        if (_this4.authManager.isImpersonatingUser()) {\n\t          return _this4.authManager.clearImpersonation();\n\t        }\n\t      });\n\t    }\n\t\n\t    // wrapper around fetch() that matches the signature of doAuthed but does not\n\t    // actually use any auth. This is necessary for routes that must be\n\t    // accessible without logging in, like listing available auth providers.\n\t\n\t  }, {\n\t    key: '_do',\n\t    value: function _do(resource, method, options) {\n\t      options = options || {};\n\t      var url = '' + this.appUrl + resource;\n\t      var init = {\n\t        method: method,\n\t        headers: { 'Accept': JSONTYPE, 'Content-Type': JSONTYPE }\n\t      };\n\t      if (options.body) {\n\t        init['body'] = options.body;\n\t      }\n\t      if (options.queryParams) {\n\t        url = url + '?' + toQueryString(options.queryParams);\n\t      }\n\t\n\t      return fetch(url, init).then(function (response) {\n\t        // Okay: passthrough\n\t        if (response.status >= 200 && response.status < 300) {\n\t          return Promise.resolve(response);\n\t        } else if (response.headers.get('Content-Type') === JSONTYPE) {\n\t          return response.json().then(function (json) {\n\t            var error = new BaasError(json['error'], json['errorCode']);\n\t            error.response = response;\n\t            throw error;\n\t          });\n\t        }\n\t        var error = new Error(response.statusText);\n\t        error.response = response;\n\t        throw error;\n\t      }).then(function (response) {\n\t        return response.json();\n\t      });\n\t    }\n\t  }, {\n\t    key: '_doAuthed',\n\t    value: function _doAuthed(resource, method, options) {\n\t      var _this5 = this;\n\t\n\t      if (options === undefined) {\n\t        options = { refreshOnFailure: true, useRefreshToken: false };\n\t      } else {\n\t        if (options.refreshOnFailure === undefined) {\n\t          options.refreshOnFailure = true;\n\t        }\n\t        if (options.useRefreshToken === undefined) {\n\t          options.useRefreshToken = false;\n\t        }\n\t      }\n\t\n\t      if (this.auth() === null) {\n\t        return Promise.reject(new BaasError('Must auth first'));\n\t      }\n\t\n\t      var url = '' + this.appUrl + resource;\n\t\n\t      var headers = {\n\t        'Accept': JSONTYPE,\n\t        'Content-Type': JSONTYPE\n\t      };\n\t      var token = options.useRefreshToken ? localStorage.getItem(REFRESH_TOKEN_KEY) : this.auth()['accessToken'];\n\t      headers['Authorization'] = 'Bearer ' + token;\n\t\n\t      var init = {\n\t        method: method,\n\t        headers: headers\n\t      };\n\t\n\t      if (options.body) {\n\t        init['body'] = options.body;\n\t      }\n\t\n\t      if (options.queryParams) {\n\t        url = url + '?' + toQueryString(options.queryParams);\n\t      }\n\t\n\t      return fetch(url, init).then(function (response) {\n\t        // Okay: passthrough\n\t        if (response.status >= 200 && response.status < 300) {\n\t          return Promise.resolve(response);\n\t        } else if (response.headers.get('Content-Type') === JSONTYPE) {\n\t          return response.json().then(function (json) {\n\t            // Only want to try refreshing token when there's an invalid session\n\t            if ('errorCode' in json && json['errorCode'] === ErrInvalidSession) {\n\t              if (!options.refreshOnFailure) {\n\t                _this5.authManager.clear();\n\t                var _error = new BaasError(json['error'], json['errorCode']);\n\t                _error.response = response;\n\t                throw _error;\n\t              }\n\t\n\t              return _this5._refreshToken().then(function () {\n\t                options.refreshOnFailure = false;\n\t                return _this5._doAuthed(resource, method, options);\n\t              });\n\t            }\n\t\n\t            var error = new BaasError(json['error'], json['errorCode']);\n\t            error.response = response;\n\t            throw error;\n\t          });\n\t        }\n\t\n\t        var error = new Error(response.statusText);\n\t        error.response = response;\n\t        throw error;\n\t      });\n\t    }\n\t  }, {\n\t    key: '_refreshToken',\n\t    value: function _refreshToken() {\n\t      var _this6 = this;\n\t\n\t      if (this.authManager.isImpersonatingUser()) {\n\t        return this.authManager.refreshImpersonation(this);\n\t      }\n\t      return this._doAuthed('/auth/newAccessToken', 'POST', { refreshOnFailure: false, useRefreshToken: true }).then(function (response) {\n\t        return response.json().then(function (json) {\n\t          _this6.authManager.setAccessToken(json['accessToken']);\n\t          return Promise.resolve();\n\t        });\n\t      });\n\t    }\n\t  }, {\n\t    key: 'executePipeline',\n\t    value: function executePipeline(stages) {\n\t      return this._doAuthed('/pipeline', 'POST', { body: JSON.stringify(stages) }).then(function (response) {\n\t        return response.json();\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return BaasClient;\n\t}();\n\t\n\tvar DB = function () {\n\t  function DB(client, service, name) {\n\t    _classCallCheck(this, DB);\n\t\n\t    this.client = client;\n\t    this.service = service;\n\t    this.name = name;\n\t  }\n\t\n\t  _createClass(DB, [{\n\t    key: 'getCollection',\n\t    value: function getCollection(name) {\n\t      return new Collection(this, name);\n\t    }\n\t  }]);\n\t\n\t  return DB;\n\t}();\n\t\n\tvar Collection = function () {\n\t  function Collection(db, name) {\n\t    _classCallCheck(this, Collection);\n\t\n\t    this.db = db;\n\t    this.name = name;\n\t  }\n\t\n\t  _createClass(Collection, [{\n\t    key: 'getBaseArgs',\n\t    value: function getBaseArgs() {\n\t      return {\n\t        'database': this.db.name,\n\t        'collection': this.name\n\t      };\n\t    }\n\t  }, {\n\t    key: 'deleteOne',\n\t    value: function deleteOne(query) {\n\t      var args = this.getBaseArgs();\n\t      args.query = query;\n\t      args.singleDoc = true;\n\t      return this.db.client.executePipeline([{\n\t        'service': this.db.service,\n\t        'action': 'delete',\n\t        'args': args\n\t      }]);\n\t    }\n\t  }, {\n\t    key: 'deleteMany',\n\t    value: function deleteMany(query) {\n\t      var args = this.getBaseArgs();\n\t      args.query = query;\n\t      args.singleDoc = false;\n\t      return this.db.client.executePipeline([{\n\t        'service': this.db.service,\n\t        'action': 'delete',\n\t        'args': args\n\t      }]);\n\t    }\n\t  }, {\n\t    key: 'find',\n\t    value: function find(query, project) {\n\t      var args = this.getBaseArgs();\n\t      args.query = query;\n\t      args.project = project;\n\t      return this.db.client.executePipeline([{\n\t        'service': this.db.service,\n\t        'action': 'find',\n\t        'args': args\n\t      }]);\n\t    }\n\t  }, {\n\t    key: 'insert',\n\t    value: function insert(documents) {\n\t      return this.db.client.executePipeline([{ 'action': 'literal',\n\t        'args': {\n\t          'items': documents\n\t        }\n\t      }, {\n\t        'service': this.db.service,\n\t        'action': 'insert',\n\t        'args': this.getBaseArgs()\n\t      }]);\n\t    }\n\t  }, {\n\t    key: 'makeUpdateStage',\n\t    value: function makeUpdateStage(query, update, upsert, multi) {\n\t      var args = this.getBaseArgs();\n\t      args.query = query;\n\t      args.update = update;\n\t      if (upsert) {\n\t        args.upsert = true;\n\t      }\n\t      if (multi) {\n\t        args.multi = true;\n\t      }\n\t\n\t      return {\n\t        'service': this.db.service,\n\t        'action': 'update',\n\t        'args': args\n\t      };\n\t    }\n\t  }, {\n\t    key: 'updateOne',\n\t    value: function updateOne(query, update) {\n\t      return this.db.client.executePipeline([this.makeUpdateStage(query, update, false, false)]);\n\t    }\n\t  }, {\n\t    key: 'updateMany',\n\t    value: function updateMany(query, update, upsert, multi) {\n\t      return this.db.client.executePipeline([this.makeUpdateStage(query, update, false, true)]);\n\t    }\n\t  }, {\n\t    key: 'upsert',\n\t    value: function upsert(query, update) {\n\t      return this.db.client.executePipeline([this.makeUpdateStage(query, update, true, false)]);\n\t    }\n\t  }]);\n\t\n\t  return Collection;\n\t}();\n\t\n\tvar MongoClient = exports.MongoClient = function () {\n\t  function MongoClient(baasClient, serviceName) {\n\t    _classCallCheck(this, MongoClient);\n\t\n\t    this.baasClient = baasClient;\n\t    this.service = serviceName;\n\t  }\n\t\n\t  _createClass(MongoClient, [{\n\t    key: 'getDb',\n\t    value: function getDb(name) {\n\t      return new DB(this.baasClient, this.service, name);\n\t    }\n\t  }]);\n\t\n\t  return MongoClient;\n\t}();\n\t\n\tvar Admin = exports.Admin = function () {\n\t  function Admin(baseUrl) {\n\t    _classCallCheck(this, Admin);\n\t\n\t    this.client = new BaasClient('', { baseUrl: baseUrl });\n\t  }\n\t\n\t  _createClass(Admin, [{\n\t    key: '_doAuthed',\n\t    value: function _doAuthed(url, method, options) {\n\t      return this.client._doAuthed(url, method, options).then(function (response) {\n\t        return response.json();\n\t      });\n\t    }\n\t  }, {\n\t    key: '_get',\n\t    value: function _get(url, queryParams) {\n\t      return this._doAuthed(url, 'GET', { queryParams: queryParams });\n\t    }\n\t  }, {\n\t    key: '_put',\n\t    value: function _put(url, queryParams) {\n\t      return this._doAuthed(url, 'PUT', { queryParams: queryParams });\n\t    }\n\t  }, {\n\t    key: '_delete',\n\t    value: function _delete(url) {\n\t      return this._doAuthed(url, 'DELETE');\n\t    }\n\t  }, {\n\t    key: '_post',\n\t    value: function _post(url, body) {\n\t      return this._doAuthed(url, 'POST', { body: JSON.stringify(body) });\n\t    }\n\t  }, {\n\t    key: 'profile',\n\t    value: function profile() {\n\t      var _this7 = this;\n\t\n\t      var root = this;\n\t      return {\n\t        keys: function keys() {\n\t          return {\n\t            list: function list() {\n\t              return root._get('/profile/keys');\n\t            },\n\t            create: function create(key) {\n\t              return root._post('/profile/keys');\n\t            },\n\t            apiKey: function apiKey(keyId) {\n\t              return {\n\t                get: function get() {\n\t                  return root._get('/profile/keys/' + keyId);\n\t                },\n\t                remove: function remove() {\n\t                  return _this7._delete('/profile/keys/' + keyId);\n\t                },\n\t                enable: function enable() {\n\t                  return root._put('/profile/keys/' + keyId + '/enable');\n\t                },\n\t                disable: function disable() {\n\t                  return root._put('/profile/keys/' + keyId + '/disable');\n\t                }\n\t              };\n\t            }\n\t          };\n\t        }\n\t      };\n\t    }\n\t\n\t    /* Examples of how to access admin API with this client:\n\t     *\n\t     * List all apps\n\t     *    a.apps().list()\n\t     *\n\t     * Fetch app under name 'planner'\n\t     *    a.apps().app('planner').get()\n\t     *\n\t     * List services under the app 'planner'\n\t     *    a.apps().app('planner').services().list()\n\t     *\n\t     * Delete a rule by ID\n\t     *    a.apps().app('planner').services().service('mdb1').rules().rule('580e6d055b199c221fcb821d').remove()\n\t     *\n\t     */\n\t\n\t  }, {\n\t    key: 'apps',\n\t    value: function apps() {\n\t      var _this8 = this;\n\t\n\t      var root = this;\n\t      return {\n\t        list: function list() {\n\t          return root._get('/apps');\n\t        },\n\t        create: function create(data) {\n\t          return root._post('/apps', data);\n\t        },\n\t        app: function app(_app) {\n\t          return {\n\t            get: function get() {\n\t              return root._get('/apps/' + _app);\n\t            },\n\t            remove: function remove() {\n\t              return root._delete('/apps/' + _app);\n\t            },\n\t\n\t            users: function users() {\n\t              return {\n\t                list: function list(filter) {\n\t                  return _this8._get('/apps/' + _app + '/users', filter);\n\t                },\n\t                user: function user(uid) {\n\t                  return {\n\t                    get: function get() {\n\t                      return _this8._get('/apps/' + _app + '/users/' + uid);\n\t                    }\n\t                  };\n\t                }\n\t              };\n\t            },\n\t\n\t            authProviders: function authProviders() {\n\t              return {\n\t                create: function create(data) {\n\t                  return _this8._post('/apps/' + _app + '/authProviders', data);\n\t                },\n\t                list: function list() {\n\t                  return _this8._get('/apps/' + _app + '/authProviders');\n\t                },\n\t                provider: function provider(authType, authName) {\n\t                  return {\n\t                    get: function get() {\n\t                      return _this8._get('/apps/' + _app + '/authProviders/' + authType + '/' + authName);\n\t                    },\n\t                    remove: function remove() {\n\t                      return _this8._delete('/apps/' + _app + '/authProviders/' + authType + '/' + authName);\n\t                    },\n\t                    update: function update(data) {\n\t                      return _this8._post('/apps/' + _app + '/authProviders/' + authType + '/' + authName, data);\n\t                    }\n\t                  };\n\t                }\n\t              };\n\t            },\n\t            variables: function variables() {\n\t              return {\n\t                list: function list() {\n\t                  return _this8._get('/apps/' + _app + '/vars');\n\t                },\n\t                variable: function variable(varName) {\n\t                  return {\n\t                    get: function get() {\n\t                      return _this8._get('/apps/' + _app + '/vars/' + varName);\n\t                    },\n\t                    remove: function remove() {\n\t                      return _this8._delete('/apps/' + _app + '/vars/' + varName);\n\t                    },\n\t                    create: function create(data) {\n\t                      return _this8._post('/apps/' + _app + '/vars/' + varName, data);\n\t                    },\n\t                    update: function update(data) {\n\t                      return _this8._post('/apps/' + _app + '/vars/' + varName, data);\n\t                    }\n\t                  };\n\t                }\n\t              };\n\t            },\n\t            logs: function logs() {\n\t              return {\n\t                get: function get(filter) {\n\t                  return _this8._get('/apps/' + _app + '/logs', filter);\n\t                }\n\t              };\n\t            },\n\t            apiKeys: function apiKeys() {\n\t              return {\n\t                list: function list() {\n\t                  return _this8._get('/apps/' + _app + '/keys');\n\t                },\n\t                create: function create(data) {\n\t                  return _this8._post('/apps/' + _app + '/keys', data);\n\t                },\n\t                apiKey: function apiKey(key) {\n\t                  return {\n\t                    get: function get() {\n\t                      return _this8._get('/apps/' + _app + '/keys/' + key);\n\t                    },\n\t                    remove: function remove() {\n\t                      return _this8._delete('/apps/' + _app + '/keys/' + key);\n\t                    },\n\t                    enable: function enable() {\n\t                      return _this8._put('/apps/' + _app + '/keys/' + key + '/enable');\n\t                    },\n\t                    disable: function disable() {\n\t                      return _this8._put('/apps/' + _app + '/keys/' + key + '/disable');\n\t                    }\n\t                  };\n\t                }\n\t              };\n\t            },\n\t            services: function services() {\n\t              return {\n\t                list: function list() {\n\t                  return _this8._get('/apps/' + _app + '/services');\n\t                },\n\t                create: function create(data) {\n\t                  return _this8._post('/apps/' + _app + '/services', data);\n\t                },\n\t                service: function service(svc) {\n\t                  return {\n\t                    get: function get() {\n\t                      return _this8._get('/apps/' + _app + '/services/' + svc);\n\t                    },\n\t                    update: function update(data) {\n\t                      return _this8._post('/apps/' + _app + '/services/' + svc, data);\n\t                    },\n\t                    remove: function remove() {\n\t                      return _this8._delete('/apps/' + _app + '/services/' + svc);\n\t                    },\n\t                    setConfig: function setConfig(data) {\n\t                      return _this8._post('/apps/' + _app + '/services/' + svc + '/config', data);\n\t                    },\n\t\n\t                    rules: function rules() {\n\t                      return {\n\t                        list: function list() {\n\t                          return _this8._get('/apps/' + _app + '/services/' + svc + '/rules');\n\t                        },\n\t                        create: function create(data) {\n\t                          return _this8._post('/apps/' + _app + '/services/' + svc + '/rules');\n\t                        },\n\t                        rule: function rule(ruleId) {\n\t                          return {\n\t                            get: function get() {\n\t                              return _this8._get('/apps/' + _app + '/services/' + svc + '/rules/' + ruleId);\n\t                            },\n\t                            update: function update(data) {\n\t                              return _this8._post('/apps/' + _app + '/services/' + svc + '/rules/' + ruleId, data);\n\t                            },\n\t                            remove: function remove() {\n\t                              return _this8._delete('/apps/' + _app + '/services/' + svc + '/rules/' + ruleId);\n\t                            }\n\t                          };\n\t                        }\n\t                      };\n\t                    },\n\t\n\t                    triggers: function triggers() {\n\t                      return {\n\t                        list: function list() {\n\t                          return _this8._get('/apps/' + _app + '/services/' + svc + '/triggers');\n\t                        },\n\t                        create: function create(data) {\n\t                          return _this8._post('/apps/' + _app + '/services/' + svc + '/triggers');\n\t                        },\n\t                        trigger: function trigger(triggerId) {\n\t                          return {\n\t                            get: function get() {\n\t                              return _this8._get('/apps/' + _app + '/services/' + svc + '/triggers/' + triggerId);\n\t                            },\n\t                            update: function update(data) {\n\t                              return _this8._post('/apps/' + _app + '/services/' + svc + '/triggers/' + triggerId, data);\n\t                            },\n\t                            remove: function remove() {\n\t                              return _this8._delete('/apps/' + _app + '/services/' + svc + '/triggers/' + triggerId);\n\t                            }\n\t                          };\n\t                        }\n\t                      };\n\t                    }\n\t                  };\n\t                }\n\t              };\n\t            }\n\t          };\n\t        }\n\t      };\n\t    }\n\t  }, {\n\t    key: '_isImpersonatingUser',\n\t    value: function _isImpersonatingUser() {\n\t      return this.client.authManager.isImpersonatingUser();\n\t    }\n\t  }, {\n\t    key: '_startImpersonation',\n\t    value: function _startImpersonation(userId) {\n\t      return this.client.authManager.startImpersonation(this.client, userId);\n\t    }\n\t  }, {\n\t    key: '_stopImpersonation',\n\t    value: function _stopImpersonation(userId) {\n\t      return this.client.authManager.stopImpersonation();\n\t    }\n\t  }]);\n\t\n\t  return Admin;\n\t}();\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t(function(self) {\n\t  'use strict';\n\t\n\t  if (self.fetch) {\n\t    return\n\t  }\n\t\n\t  var support = {\n\t    searchParams: 'URLSearchParams' in self,\n\t    iterable: 'Symbol' in self && 'iterator' in Symbol,\n\t    blob: 'FileReader' in self && 'Blob' in self && (function() {\n\t      try {\n\t        new Blob()\n\t        return true\n\t      } catch(e) {\n\t        return false\n\t      }\n\t    })(),\n\t    formData: 'FormData' in self,\n\t    arrayBuffer: 'ArrayBuffer' in self\n\t  }\n\t\n\t  if (support.arrayBuffer) {\n\t    var viewClasses = [\n\t      '[object Int8Array]',\n\t      '[object Uint8Array]',\n\t      '[object Uint8ClampedArray]',\n\t      '[object Int16Array]',\n\t      '[object Uint16Array]',\n\t      '[object Int32Array]',\n\t      '[object Uint32Array]',\n\t      '[object Float32Array]',\n\t      '[object Float64Array]'\n\t    ]\n\t\n\t    var isDataView = function(obj) {\n\t      return obj && DataView.prototype.isPrototypeOf(obj)\n\t    }\n\t\n\t    var isArrayBufferView = ArrayBuffer.isView || function(obj) {\n\t      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n\t    }\n\t  }\n\t\n\t  function normalizeName(name) {\n\t    if (typeof name !== 'string') {\n\t      name = String(name)\n\t    }\n\t    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n\t      throw new TypeError('Invalid character in header field name')\n\t    }\n\t    return name.toLowerCase()\n\t  }\n\t\n\t  function normalizeValue(value) {\n\t    if (typeof value !== 'string') {\n\t      value = String(value)\n\t    }\n\t    return value\n\t  }\n\t\n\t  // Build a destructive iterator for the value list\n\t  function iteratorFor(items) {\n\t    var iterator = {\n\t      next: function() {\n\t        var value = items.shift()\n\t        return {done: value === undefined, value: value}\n\t      }\n\t    }\n\t\n\t    if (support.iterable) {\n\t      iterator[Symbol.iterator] = function() {\n\t        return iterator\n\t      }\n\t    }\n\t\n\t    return iterator\n\t  }\n\t\n\t  function Headers(headers) {\n\t    this.map = {}\n\t\n\t    if (headers instanceof Headers) {\n\t      headers.forEach(function(value, name) {\n\t        this.append(name, value)\n\t      }, this)\n\t\n\t    } else if (headers) {\n\t      Object.getOwnPropertyNames(headers).forEach(function(name) {\n\t        this.append(name, headers[name])\n\t      }, this)\n\t    }\n\t  }\n\t\n\t  Headers.prototype.append = function(name, value) {\n\t    name = normalizeName(name)\n\t    value = normalizeValue(value)\n\t    var oldValue = this.map[name]\n\t    this.map[name] = oldValue ? oldValue+','+value : value\n\t  }\n\t\n\t  Headers.prototype['delete'] = function(name) {\n\t    delete this.map[normalizeName(name)]\n\t  }\n\t\n\t  Headers.prototype.get = function(name) {\n\t    name = normalizeName(name)\n\t    return this.has(name) ? this.map[name] : null\n\t  }\n\t\n\t  Headers.prototype.has = function(name) {\n\t    return this.map.hasOwnProperty(normalizeName(name))\n\t  }\n\t\n\t  Headers.prototype.set = function(name, value) {\n\t    this.map[normalizeName(name)] = normalizeValue(value)\n\t  }\n\t\n\t  Headers.prototype.forEach = function(callback, thisArg) {\n\t    for (var name in this.map) {\n\t      if (this.map.hasOwnProperty(name)) {\n\t        callback.call(thisArg, this.map[name], name, this)\n\t      }\n\t    }\n\t  }\n\t\n\t  Headers.prototype.keys = function() {\n\t    var items = []\n\t    this.forEach(function(value, name) { items.push(name) })\n\t    return iteratorFor(items)\n\t  }\n\t\n\t  Headers.prototype.values = function() {\n\t    var items = []\n\t    this.forEach(function(value) { items.push(value) })\n\t    return iteratorFor(items)\n\t  }\n\t\n\t  Headers.prototype.entries = function() {\n\t    var items = []\n\t    this.forEach(function(value, name) { items.push([name, value]) })\n\t    return iteratorFor(items)\n\t  }\n\t\n\t  if (support.iterable) {\n\t    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n\t  }\n\t\n\t  function consumed(body) {\n\t    if (body.bodyUsed) {\n\t      return Promise.reject(new TypeError('Already read'))\n\t    }\n\t    body.bodyUsed = true\n\t  }\n\t\n\t  function fileReaderReady(reader) {\n\t    return new Promise(function(resolve, reject) {\n\t      reader.onload = function() {\n\t        resolve(reader.result)\n\t      }\n\t      reader.onerror = function() {\n\t        reject(reader.error)\n\t      }\n\t    })\n\t  }\n\t\n\t  function readBlobAsArrayBuffer(blob) {\n\t    var reader = new FileReader()\n\t    var promise = fileReaderReady(reader)\n\t    reader.readAsArrayBuffer(blob)\n\t    return promise\n\t  }\n\t\n\t  function readBlobAsText(blob) {\n\t    var reader = new FileReader()\n\t    var promise = fileReaderReady(reader)\n\t    reader.readAsText(blob)\n\t    return promise\n\t  }\n\t\n\t  function readArrayBufferAsText(buf) {\n\t    var view = new Uint8Array(buf)\n\t    var chars = new Array(view.length)\n\t\n\t    for (var i = 0; i < view.length; i++) {\n\t      chars[i] = String.fromCharCode(view[i])\n\t    }\n\t    return chars.join('')\n\t  }\n\t\n\t  function bufferClone(buf) {\n\t    if (buf.slice) {\n\t      return buf.slice(0)\n\t    } else {\n\t      var view = new Uint8Array(buf.byteLength)\n\t      view.set(new Uint8Array(buf))\n\t      return view.buffer\n\t    }\n\t  }\n\t\n\t  function Body() {\n\t    this.bodyUsed = false\n\t\n\t    this._initBody = function(body) {\n\t      this._bodyInit = body\n\t      if (!body) {\n\t        this._bodyText = ''\n\t      } else if (typeof body === 'string') {\n\t        this._bodyText = body\n\t      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n\t        this._bodyBlob = body\n\t      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n\t        this._bodyFormData = body\n\t      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n\t        this._bodyText = body.toString()\n\t      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n\t        this._bodyArrayBuffer = bufferClone(body.buffer)\n\t        // IE 10-11 can't handle a DataView body.\n\t        this._bodyInit = new Blob([this._bodyArrayBuffer])\n\t      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n\t        this._bodyArrayBuffer = bufferClone(body)\n\t      } else {\n\t        throw new Error('unsupported BodyInit type')\n\t      }\n\t\n\t      if (!this.headers.get('content-type')) {\n\t        if (typeof body === 'string') {\n\t          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n\t        } else if (this._bodyBlob && this._bodyBlob.type) {\n\t          this.headers.set('content-type', this._bodyBlob.type)\n\t        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n\t          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n\t        }\n\t      }\n\t    }\n\t\n\t    if (support.blob) {\n\t      this.blob = function() {\n\t        var rejected = consumed(this)\n\t        if (rejected) {\n\t          return rejected\n\t        }\n\t\n\t        if (this._bodyBlob) {\n\t          return Promise.resolve(this._bodyBlob)\n\t        } else if (this._bodyArrayBuffer) {\n\t          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n\t        } else if (this._bodyFormData) {\n\t          throw new Error('could not read FormData body as blob')\n\t        } else {\n\t          return Promise.resolve(new Blob([this._bodyText]))\n\t        }\n\t      }\n\t\n\t      this.arrayBuffer = function() {\n\t        if (this._bodyArrayBuffer) {\n\t          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n\t        } else {\n\t          return this.blob().then(readBlobAsArrayBuffer)\n\t        }\n\t      }\n\t    }\n\t\n\t    this.text = function() {\n\t      var rejected = consumed(this)\n\t      if (rejected) {\n\t        return rejected\n\t      }\n\t\n\t      if (this._bodyBlob) {\n\t        return readBlobAsText(this._bodyBlob)\n\t      } else if (this._bodyArrayBuffer) {\n\t        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n\t      } else if (this._bodyFormData) {\n\t        throw new Error('could not read FormData body as text')\n\t      } else {\n\t        return Promise.resolve(this._bodyText)\n\t      }\n\t    }\n\t\n\t    if (support.formData) {\n\t      this.formData = function() {\n\t        return this.text().then(decode)\n\t      }\n\t    }\n\t\n\t    this.json = function() {\n\t      return this.text().then(JSON.parse)\n\t    }\n\t\n\t    return this\n\t  }\n\t\n\t  // HTTP methods whose capitalization should be normalized\n\t  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\t\n\t  function normalizeMethod(method) {\n\t    var upcased = method.toUpperCase()\n\t    return (methods.indexOf(upcased) > -1) ? upcased : method\n\t  }\n\t\n\t  function Request(input, options) {\n\t    options = options || {}\n\t    var body = options.body\n\t\n\t    if (input instanceof Request) {\n\t      if (input.bodyUsed) {\n\t        throw new TypeError('Already read')\n\t      }\n\t      this.url = input.url\n\t      this.credentials = input.credentials\n\t      if (!options.headers) {\n\t        this.headers = new Headers(input.headers)\n\t      }\n\t      this.method = input.method\n\t      this.mode = input.mode\n\t      if (!body && input._bodyInit != null) {\n\t        body = input._bodyInit\n\t        input.bodyUsed = true\n\t      }\n\t    } else {\n\t      this.url = String(input)\n\t    }\n\t\n\t    this.credentials = options.credentials || this.credentials || 'omit'\n\t    if (options.headers || !this.headers) {\n\t      this.headers = new Headers(options.headers)\n\t    }\n\t    this.method = normalizeMethod(options.method || this.method || 'GET')\n\t    this.mode = options.mode || this.mode || null\n\t    this.referrer = null\n\t\n\t    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n\t      throw new TypeError('Body not allowed for GET or HEAD requests')\n\t    }\n\t    this._initBody(body)\n\t  }\n\t\n\t  Request.prototype.clone = function() {\n\t    return new Request(this, { body: this._bodyInit })\n\t  }\n\t\n\t  function decode(body) {\n\t    var form = new FormData()\n\t    body.trim().split('&').forEach(function(bytes) {\n\t      if (bytes) {\n\t        var split = bytes.split('=')\n\t        var name = split.shift().replace(/\\+/g, ' ')\n\t        var value = split.join('=').replace(/\\+/g, ' ')\n\t        form.append(decodeURIComponent(name), decodeURIComponent(value))\n\t      }\n\t    })\n\t    return form\n\t  }\n\t\n\t  function parseHeaders(rawHeaders) {\n\t    var headers = new Headers()\n\t    rawHeaders.split(/\\r?\\n/).forEach(function(line) {\n\t      var parts = line.split(':')\n\t      var key = parts.shift().trim()\n\t      if (key) {\n\t        var value = parts.join(':').trim()\n\t        headers.append(key, value)\n\t      }\n\t    })\n\t    return headers\n\t  }\n\t\n\t  Body.call(Request.prototype)\n\t\n\t  function Response(bodyInit, options) {\n\t    if (!options) {\n\t      options = {}\n\t    }\n\t\n\t    this.type = 'default'\n\t    this.status = 'status' in options ? options.status : 200\n\t    this.ok = this.status >= 200 && this.status < 300\n\t    this.statusText = 'statusText' in options ? options.statusText : 'OK'\n\t    this.headers = new Headers(options.headers)\n\t    this.url = options.url || ''\n\t    this._initBody(bodyInit)\n\t  }\n\t\n\t  Body.call(Response.prototype)\n\t\n\t  Response.prototype.clone = function() {\n\t    return new Response(this._bodyInit, {\n\t      status: this.status,\n\t      statusText: this.statusText,\n\t      headers: new Headers(this.headers),\n\t      url: this.url\n\t    })\n\t  }\n\t\n\t  Response.error = function() {\n\t    var response = new Response(null, {status: 0, statusText: ''})\n\t    response.type = 'error'\n\t    return response\n\t  }\n\t\n\t  var redirectStatuses = [301, 302, 303, 307, 308]\n\t\n\t  Response.redirect = function(url, status) {\n\t    if (redirectStatuses.indexOf(status) === -1) {\n\t      throw new RangeError('Invalid status code')\n\t    }\n\t\n\t    return new Response(null, {status: status, headers: {location: url}})\n\t  }\n\t\n\t  self.Headers = Headers\n\t  self.Request = Request\n\t  self.Response = Response\n\t\n\t  self.fetch = function(input, init) {\n\t    return new Promise(function(resolve, reject) {\n\t      var request = new Request(input, init)\n\t      var xhr = new XMLHttpRequest()\n\t\n\t      xhr.onload = function() {\n\t        var options = {\n\t          status: xhr.status,\n\t          statusText: xhr.statusText,\n\t          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n\t        }\n\t        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n\t        var body = 'response' in xhr ? xhr.response : xhr.responseText\n\t        resolve(new Response(body, options))\n\t      }\n\t\n\t      xhr.onerror = function() {\n\t        reject(new TypeError('Network request failed'))\n\t      }\n\t\n\t      xhr.ontimeout = function() {\n\t        reject(new TypeError('Network request failed'))\n\t      }\n\t\n\t      xhr.open(request.method, request.url, true)\n\t\n\t      if (request.credentials === 'include') {\n\t        xhr.withCredentials = true\n\t      }\n\t\n\t      if ('responseType' in xhr && support.blob) {\n\t        xhr.responseType = 'blob'\n\t      }\n\t\n\t      request.headers.forEach(function(value, name) {\n\t        xhr.setRequestHeader(name, value)\n\t      })\n\t\n\t      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n\t    })\n\t  }\n\t  self.fetch.polyfill = true\n\t})(typeof self !== 'undefined' ? self : this);\n\n\n/***/ }\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// baas.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 389c217c2f797fd2abe7","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Admin = exports.MongoClient = exports.BaasClient = exports.Auth = exports.BaasError = exports.parseRedirectFragment = exports.ErrInvalidSession = exports.ErrAuthProviderNotFound = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nrequire('whatwg-fetch');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /* global window, localStorage, fetch */\n/* eslint no-labels: ['error', { 'allowLoop': true }] */\n\n\n// fetch polyfill\n\nvar USER_AUTH_KEY = '_baas_ua';\nvar REFRESH_TOKEN_KEY = '_baas_rt';\nvar STATE_KEY = '_baas_state';\nvar BAAS_ERROR_KEY = '_baas_error';\nvar BAAS_LINK_KEY = '_baas_link';\nvar IMPERSONATION_ACTIVE_KEY = '_baas_impers_active';\nvar IMPERSONATION_USER_KEY = '_baas_impers_user';\nvar IMPERSONATION_REAL_USER_AUTH_KEY = '_baas_impers_real_ua';\nvar DEFAULT_BAAS_SERVER_URL = 'https://baas-dev.10gen.cc';\nvar JSONTYPE = 'application/json';\n\nvar ErrAuthProviderNotFound = exports.ErrAuthProviderNotFound = 'AuthProviderNotFound';\nvar ErrInvalidSession = exports.ErrInvalidSession = 'InvalidSession';\nvar stateLength = 64;\n\nvar toQueryString = function toQueryString(obj) {\n  var parts = [];\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      parts.push(encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]));\n    }\n  }\n  return parts.join('&');\n};\n\nvar checkStatus = function checkStatus(response) {\n  if (response.status >= 200 && response.status < 300) {\n    return response;\n  } else {\n    var error = new Error(response.statusText);\n    error.response = response;\n    throw error;\n  }\n};\n\nvar parseRedirectFragment = exports.parseRedirectFragment = function parseRedirectFragment(fragment, ourState) {\n  // After being redirected from oauth, the URL will look like:\n  // https://todo.examples.baas-dev.10gen.cc/#_baas_state=...&_baas_ua=...\n  // This function parses out baas-specific tokens from the fragment and\n  // builds an object describing the result.\n  var vars = fragment.split('&');\n  var result = { ua: null, found: false, stateValid: false, lastError: null };\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    outerloop: for (var _iterator = vars[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var pair = _step.value;\n\n      var pairParts = pair.split('=');\n      var pairKey = decodeURIComponent(pairParts[0]);\n      switch (pairKey) {\n        case BAAS_ERROR_KEY:\n          result.lastError = decodeURIComponent(pairParts[1]);\n          result.found = true;\n          break outerloop;\n        case USER_AUTH_KEY:\n          result.ua = JSON.parse(window.atob(decodeURIComponent(pairParts[1])));\n          result.found = true;\n          continue;\n        case BAAS_LINK_KEY:\n          result.found = true;\n          continue;\n        case STATE_KEY:\n          result.found = true;\n          var theirState = decodeURIComponent(pairParts[1]);\n          if (ourState && ourState === theirState) {\n            result.stateValid = true;\n          }\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return result;\n};\n\nvar BaasError = exports.BaasError = function (_Error) {\n  _inherits(BaasError, _Error);\n\n  function BaasError(message, code) {\n    _classCallCheck(this, BaasError);\n\n    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(BaasError).call(this, message));\n\n    _this.name = 'BaasError';\n    _this.message = message;\n    if (code !== undefined) {\n      _this.code = code;\n    }\n    if (typeof Error.captureStackTrace === 'function') {\n      Error.captureStackTrace(_this, _this.constructor);\n    } else {\n      _this.stack = new Error(message).stack;\n    }\n    return _this;\n  }\n\n  return BaasError;\n}(Error);\n\nvar Auth = exports.Auth = function () {\n  function Auth(rootUrl) {\n    _classCallCheck(this, Auth);\n\n    this.rootUrl = rootUrl;\n  }\n\n  _createClass(Auth, [{\n    key: 'pageRootUrl',\n    value: function pageRootUrl() {\n      return [window.location.protocol, '//', window.location.host, window.location.pathname].join('');\n    }\n\n    // The state we generate is to be used for any kind of request where we will\n    // complete an authentication flow via a redirect. We store the generate in\n    // a local storage bound to the app's origin. This ensures that any time we\n    // receive a redirect, there must be a state parameter and it must match\n    // what we ourselves have generated. This state MUST only be sent to\n    // a trusted BaaS endpoint in order to preserve its integrity. BaaS will\n    // store it in some way on its origin (currently a cookie stored on this client)\n    // and use that state at the end of an auth flow as a parameter in the redirect URI.\n\n  }, {\n    key: 'setAccessToken',\n    value: function setAccessToken(token) {\n      var currAuth = this.get();\n      currAuth['accessToken'] = token;\n      currAuth['refreshToken'] = localStorage.getItem(REFRESH_TOKEN_KEY);\n      this.set(currAuth);\n    }\n  }, {\n    key: 'handleRedirect',\n    value: function handleRedirect() {\n      var ourState = localStorage.getItem(STATE_KEY);\n      var redirectFragment = window.location.hash.substring(1);\n      var redirectState = parseRedirectFragment(redirectFragment, ourState);\n      if (redirectState.lastError) {\n        console.error('BaasClient: error from redirect: ' + redirectState.lastError);\n        window.history.replaceState(null, '', this.pageRootUrl());\n        return;\n      }\n      if (!redirectState.found) {\n        return;\n      }\n      localStorage.removeItem(STATE_KEY);\n      if (!redirectState.stateValid) {\n        console.error('BaasClient: state values did not match!');\n        window.history.replaceState(null, '', this.pageRootUrl());\n        return;\n      }\n      if (!redirectState.ua) {\n        console.error('BaasClient: no UA value was returned from redirect!');\n        return;\n      }\n      // If we get here, the state is valid - set auth appropriately.\n      this.set(redirectState.ua);\n      window.history.replaceState(null, '', this.pageRootUrl());\n    }\n  }, {\n    key: 'getOAuthLoginURL',\n    value: function getOAuthLoginURL(providerName, redirectUrl) {\n      if (redirectUrl === undefined) {\n        redirectUrl = this.pageRootUrl();\n      }\n      var state = Auth.generateState();\n      localStorage.setItem(STATE_KEY, state);\n      var result = this.rootUrl + '/oauth2/' + providerName + '?redirect=' + encodeURI(redirectUrl) + '&state=' + state;\n      return result;\n    }\n  }, {\n    key: 'localAuth',\n    value: function localAuth(username, password, cors) {\n      var _this2 = this;\n\n      var init = {\n        method: 'POST',\n        headers: {\n          'Accept': JSONTYPE,\n          'Content-Type': JSONTYPE\n        },\n        body: JSON.stringify({ 'username': username, 'password': password })\n      };\n\n      if (cors) {\n        init['cors'] = cors;\n      }\n\n      return fetch(this.rootUrl + '/local/userpass', init).then(checkStatus).then(function (response) {\n        return response.json().then(function (json) {\n          _this2.set(json);\n          Promise.resolve();\n        });\n      });\n    }\n  }, {\n    key: 'clear',\n    value: function clear() {\n      localStorage.removeItem(USER_AUTH_KEY);\n      localStorage.removeItem(REFRESH_TOKEN_KEY);\n    }\n  }, {\n    key: 'set',\n    value: function set(json) {\n      var rt = json['refreshToken'];\n      delete json['refreshToken'];\n\n      localStorage.setItem(USER_AUTH_KEY, window.btoa(JSON.stringify(json)));\n      localStorage.setItem(REFRESH_TOKEN_KEY, rt);\n    }\n  }, {\n    key: 'get',\n    value: function get() {\n      if (localStorage.getItem(USER_AUTH_KEY) === null) {\n        return null;\n      }\n      return JSON.parse(window.atob(localStorage.getItem(USER_AUTH_KEY)));\n    }\n  }, {\n    key: 'authedId',\n    value: function authedId() {\n      var a = this.get();\n      return ((a || {}).user || {})._id;\n    }\n  }, {\n    key: 'isImpersonatingUser',\n    value: function isImpersonatingUser() {\n      return localStorage.getItem(IMPERSONATION_ACTIVE_KEY) === 'true';\n    }\n  }, {\n    key: 'refreshImpersonation',\n    value: function refreshImpersonation(client) {\n      var _this3 = this;\n\n      var userId = localStorage.getItem(IMPERSONATION_USER_KEY);\n      return client._doAuthed('/admin/impersonate/' + userId, 'POST', { refreshOnFailure: false, useRefreshToken: true }).then(function (response) {\n        return response.json().then(function (json) {\n          json['refreshToken'] = localStorage.getItem(REFRESH_TOKEN_KEY);\n          _this3.set(json);\n          return Promise.resolve();\n        });\n      }).catch(function (e) {\n        _this3.stopImpersonation();\n        throw e;\n      });\n    }\n  }, {\n    key: 'startImpersonation',\n    value: function startImpersonation(client, userId) {\n      if (this.get() === null) {\n        return Promise.reject(new BaasError('Must auth first'));\n      }\n      if (this.isImpersonatingUser()) {\n        throw new BaasError('Already impersonating a user');\n      }\n      localStorage.setItem(IMPERSONATION_ACTIVE_KEY, 'true');\n      localStorage.setItem(IMPERSONATION_USER_KEY, userId);\n\n      var realUserAuth = JSON.parse(window.atob(localStorage.getItem(USER_AUTH_KEY)));\n      realUserAuth['refreshToken'] = localStorage.getItem(REFRESH_TOKEN_KEY);\n      localStorage.setItem(IMPERSONATION_REAL_USER_AUTH_KEY, window.btoa(JSON.stringify(realUserAuth)));\n      return this.refreshImpersonation(client);\n    }\n  }, {\n    key: 'stopImpersonation',\n    value: function stopImpersonation() {\n      var root = this;\n      return new Promise(function (resolve, reject) {\n        if (!root.isImpersonatingUser()) {\n          throw new BaasError('Not impersonating a user');\n        }\n        var realUserAuth = JSON.parse(window.atob(localStorage.getItem(IMPERSONATION_REAL_USER_AUTH_KEY)));\n        root.set(realUserAuth);\n        root.clearImpersonation();\n        resolve();\n      });\n    }\n  }, {\n    key: 'clearImpersonation',\n    value: function clearImpersonation() {\n      localStorage.removeItem(IMPERSONATION_ACTIVE_KEY);\n      localStorage.removeItem(IMPERSONATION_USER_KEY);\n      localStorage.removeItem(IMPERSONATION_REAL_USER_AUTH_KEY);\n    }\n  }], [{\n    key: 'generateState',\n    value: function generateState() {\n      var alpha = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n      var state = '';\n      for (var i = 0; i < stateLength; i++) {\n        var pos = Math.floor(Math.random() * alpha.length);\n        state += alpha.substring(pos, pos + 1);\n      }\n      return state;\n    }\n  }]);\n\n  return Auth;\n}();\n\nvar BaasClient = exports.BaasClient = function () {\n  function BaasClient(app, options) {\n    _classCallCheck(this, BaasClient);\n\n    var baseUrl = DEFAULT_BAAS_SERVER_URL;\n    if (options && options.baseUrl) {\n      baseUrl = options.baseUrl;\n    }\n    this.appUrl = baseUrl + '/admin/v1';\n    this.authUrl = baseUrl + '/admin/v1/auth';\n    if (app) {\n      this.appUrl = baseUrl + '/v1/app/' + app;\n      this.authUrl = this.appUrl + '/auth';\n    }\n    this.authManager = new Auth(this.authUrl);\n    this.authManager.handleRedirect();\n  }\n\n  _createClass(BaasClient, [{\n    key: 'authWithOAuth',\n    value: function authWithOAuth(providerName, redirectUrl) {\n      window.location.replace(this.authManager.getOAuthLoginURL(providerName, redirectUrl));\n    }\n  }, {\n    key: 'authedId',\n    value: function authedId() {\n      return this.authManager.authedId();\n    }\n  }, {\n    key: 'auth',\n    value: function auth() {\n      return this.authManager.get();\n    }\n  }, {\n    key: 'logout',\n    value: function logout() {\n      var _this4 = this;\n\n      return this._doAuthed('/auth', 'DELETE', { refreshOnFailure: false, useRefreshToken: true }).then(function (data) {\n        _this4.authManager.clear();\n        if (_this4.authManager.isImpersonatingUser()) {\n          return _this4.authManager.clearImpersonation();\n        }\n      });\n    }\n\n    // wrapper around fetch() that matches the signature of doAuthed but does not\n    // actually use any auth. This is necessary for routes that must be\n    // accessible without logging in, like listing available auth providers.\n\n  }, {\n    key: '_do',\n    value: function _do(resource, method, options) {\n      options = options || {};\n      var url = '' + this.appUrl + resource;\n      var init = {\n        method: method,\n        headers: { 'Accept': JSONTYPE, 'Content-Type': JSONTYPE }\n      };\n      if (options.body) {\n        init['body'] = options.body;\n      }\n      if (options.queryParams) {\n        url = url + '?' + toQueryString(options.queryParams);\n      }\n\n      return fetch(url, init).then(function (response) {\n        // Okay: passthrough\n        if (response.status >= 200 && response.status < 300) {\n          return Promise.resolve(response);\n        } else if (response.headers.get('Content-Type') === JSONTYPE) {\n          return response.json().then(function (json) {\n            var error = new BaasError(json['error'], json['errorCode']);\n            error.response = response;\n            throw error;\n          });\n        }\n        var error = new Error(response.statusText);\n        error.response = response;\n        throw error;\n      }).then(function (response) {\n        return response.json();\n      });\n    }\n  }, {\n    key: '_doAuthed',\n    value: function _doAuthed(resource, method, options) {\n      var _this5 = this;\n\n      if (options === undefined) {\n        options = { refreshOnFailure: true, useRefreshToken: false };\n      } else {\n        if (options.refreshOnFailure === undefined) {\n          options.refreshOnFailure = true;\n        }\n        if (options.useRefreshToken === undefined) {\n          options.useRefreshToken = false;\n        }\n      }\n\n      if (this.auth() === null) {\n        return Promise.reject(new BaasError('Must auth first'));\n      }\n\n      var url = '' + this.appUrl + resource;\n\n      var headers = {\n        'Accept': JSONTYPE,\n        'Content-Type': JSONTYPE\n      };\n      var token = options.useRefreshToken ? localStorage.getItem(REFRESH_TOKEN_KEY) : this.auth()['accessToken'];\n      headers['Authorization'] = 'Bearer ' + token;\n\n      var init = {\n        method: method,\n        headers: headers\n      };\n\n      if (options.body) {\n        init['body'] = options.body;\n      }\n\n      if (options.queryParams) {\n        url = url + '?' + toQueryString(options.queryParams);\n      }\n\n      return fetch(url, init).then(function (response) {\n        // Okay: passthrough\n        if (response.status >= 200 && response.status < 300) {\n          return Promise.resolve(response);\n        } else if (response.headers.get('Content-Type') === JSONTYPE) {\n          return response.json().then(function (json) {\n            // Only want to try refreshing token when there's an invalid session\n            if ('errorCode' in json && json['errorCode'] === ErrInvalidSession) {\n              if (!options.refreshOnFailure) {\n                _this5.authManager.clear();\n                var _error = new BaasError(json['error'], json['errorCode']);\n                _error.response = response;\n                throw _error;\n              }\n\n              return _this5._refreshToken().then(function () {\n                options.refreshOnFailure = false;\n                return _this5._doAuthed(resource, method, options);\n              });\n            }\n\n            var error = new BaasError(json['error'], json['errorCode']);\n            error.response = response;\n            throw error;\n          });\n        }\n\n        var error = new Error(response.statusText);\n        error.response = response;\n        throw error;\n      });\n    }\n  }, {\n    key: '_refreshToken',\n    value: function _refreshToken() {\n      var _this6 = this;\n\n      if (this.authManager.isImpersonatingUser()) {\n        return this.authManager.refreshImpersonation(this);\n      }\n      return this._doAuthed('/auth/newAccessToken', 'POST', { refreshOnFailure: false, useRefreshToken: true }).then(function (response) {\n        return response.json().then(function (json) {\n          _this6.authManager.setAccessToken(json['accessToken']);\n          return Promise.resolve();\n        });\n      });\n    }\n  }, {\n    key: 'executePipeline',\n    value: function executePipeline(stages) {\n      return this._doAuthed('/pipeline', 'POST', { body: JSON.stringify(stages) }).then(function (response) {\n        return response.json();\n      });\n    }\n  }]);\n\n  return BaasClient;\n}();\n\nvar DB = function () {\n  function DB(client, service, name) {\n    _classCallCheck(this, DB);\n\n    this.client = client;\n    this.service = service;\n    this.name = name;\n  }\n\n  _createClass(DB, [{\n    key: 'getCollection',\n    value: function getCollection(name) {\n      return new Collection(this, name);\n    }\n  }]);\n\n  return DB;\n}();\n\nvar Collection = function () {\n  function Collection(db, name) {\n    _classCallCheck(this, Collection);\n\n    this.db = db;\n    this.name = name;\n  }\n\n  _createClass(Collection, [{\n    key: 'getBaseArgs',\n    value: function getBaseArgs() {\n      return {\n        'database': this.db.name,\n        'collection': this.name\n      };\n    }\n  }, {\n    key: 'deleteOne',\n    value: function deleteOne(query) {\n      var args = this.getBaseArgs();\n      args.query = query;\n      args.singleDoc = true;\n      return this.db.client.executePipeline([{\n        'service': this.db.service,\n        'action': 'delete',\n        'args': args\n      }]);\n    }\n  }, {\n    key: 'deleteMany',\n    value: function deleteMany(query) {\n      var args = this.getBaseArgs();\n      args.query = query;\n      args.singleDoc = false;\n      return this.db.client.executePipeline([{\n        'service': this.db.service,\n        'action': 'delete',\n        'args': args\n      }]);\n    }\n  }, {\n    key: 'find',\n    value: function find(query, project) {\n      var args = this.getBaseArgs();\n      args.query = query;\n      args.project = project;\n      return this.db.client.executePipeline([{\n        'service': this.db.service,\n        'action': 'find',\n        'args': args\n      }]);\n    }\n  }, {\n    key: 'insert',\n    value: function insert(documents) {\n      return this.db.client.executePipeline([{ 'action': 'literal',\n        'args': {\n          'items': documents\n        }\n      }, {\n        'service': this.db.service,\n        'action': 'insert',\n        'args': this.getBaseArgs()\n      }]);\n    }\n  }, {\n    key: 'makeUpdateStage',\n    value: function makeUpdateStage(query, update, upsert, multi) {\n      var args = this.getBaseArgs();\n      args.query = query;\n      args.update = update;\n      if (upsert) {\n        args.upsert = true;\n      }\n      if (multi) {\n        args.multi = true;\n      }\n\n      return {\n        'service': this.db.service,\n        'action': 'update',\n        'args': args\n      };\n    }\n  }, {\n    key: 'updateOne',\n    value: function updateOne(query, update) {\n      return this.db.client.executePipeline([this.makeUpdateStage(query, update, false, false)]);\n    }\n  }, {\n    key: 'updateMany',\n    value: function updateMany(query, update, upsert, multi) {\n      return this.db.client.executePipeline([this.makeUpdateStage(query, update, false, true)]);\n    }\n  }, {\n    key: 'upsert',\n    value: function upsert(query, update) {\n      return this.db.client.executePipeline([this.makeUpdateStage(query, update, true, false)]);\n    }\n  }]);\n\n  return Collection;\n}();\n\nvar MongoClient = exports.MongoClient = function () {\n  function MongoClient(baasClient, serviceName) {\n    _classCallCheck(this, MongoClient);\n\n    this.baasClient = baasClient;\n    this.service = serviceName;\n  }\n\n  _createClass(MongoClient, [{\n    key: 'getDb',\n    value: function getDb(name) {\n      return new DB(this.baasClient, this.service, name);\n    }\n  }]);\n\n  return MongoClient;\n}();\n\nvar Admin = exports.Admin = function () {\n  function Admin(baseUrl) {\n    _classCallCheck(this, Admin);\n\n    this.client = new BaasClient('', { baseUrl: baseUrl });\n  }\n\n  _createClass(Admin, [{\n    key: '_doAuthed',\n    value: function _doAuthed(url, method, options) {\n      return this.client._doAuthed(url, method, options).then(function (response) {\n        return response.json();\n      });\n    }\n  }, {\n    key: '_get',\n    value: function _get(url, queryParams) {\n      return this._doAuthed(url, 'GET', { queryParams: queryParams });\n    }\n  }, {\n    key: '_put',\n    value: function _put(url, queryParams) {\n      return this._doAuthed(url, 'PUT', { queryParams: queryParams });\n    }\n  }, {\n    key: '_delete',\n    value: function _delete(url) {\n      return this._doAuthed(url, 'DELETE');\n    }\n  }, {\n    key: '_post',\n    value: function _post(url, body) {\n      return this._doAuthed(url, 'POST', { body: JSON.stringify(body) });\n    }\n  }, {\n    key: 'profile',\n    value: function profile() {\n      var _this7 = this;\n\n      var root = this;\n      return {\n        keys: function keys() {\n          return {\n            list: function list() {\n              return root._get('/profile/keys');\n            },\n            create: function create(key) {\n              return root._post('/profile/keys');\n            },\n            apiKey: function apiKey(keyId) {\n              return {\n                get: function get() {\n                  return root._get('/profile/keys/' + keyId);\n                },\n                remove: function remove() {\n                  return _this7._delete('/profile/keys/' + keyId);\n                },\n                enable: function enable() {\n                  return root._put('/profile/keys/' + keyId + '/enable');\n                },\n                disable: function disable() {\n                  return root._put('/profile/keys/' + keyId + '/disable');\n                }\n              };\n            }\n          };\n        }\n      };\n    }\n\n    /* Examples of how to access admin API with this client:\n     *\n     * List all apps\n     *    a.apps().list()\n     *\n     * Fetch app under name 'planner'\n     *    a.apps().app('planner').get()\n     *\n     * List services under the app 'planner'\n     *    a.apps().app('planner').services().list()\n     *\n     * Delete a rule by ID\n     *    a.apps().app('planner').services().service('mdb1').rules().rule('580e6d055b199c221fcb821d').remove()\n     *\n     */\n\n  }, {\n    key: 'apps',\n    value: function apps() {\n      var _this8 = this;\n\n      var root = this;\n      return {\n        list: function list() {\n          return root._get('/apps');\n        },\n        create: function create(data) {\n          return root._post('/apps', data);\n        },\n        app: function app(_app) {\n          return {\n            get: function get() {\n              return root._get('/apps/' + _app);\n            },\n            remove: function remove() {\n              return root._delete('/apps/' + _app);\n            },\n\n            users: function users() {\n              return {\n                list: function list(filter) {\n                  return _this8._get('/apps/' + _app + '/users', filter);\n                },\n                user: function user(uid) {\n                  return {\n                    get: function get() {\n                      return _this8._get('/apps/' + _app + '/users/' + uid);\n                    }\n                  };\n                }\n              };\n            },\n\n            authProviders: function authProviders() {\n              return {\n                create: function create(data) {\n                  return _this8._post('/apps/' + _app + '/authProviders', data);\n                },\n                list: function list() {\n                  return _this8._get('/apps/' + _app + '/authProviders');\n                },\n                provider: function provider(authType, authName) {\n                  return {\n                    get: function get() {\n                      return _this8._get('/apps/' + _app + '/authProviders/' + authType + '/' + authName);\n                    },\n                    remove: function remove() {\n                      return _this8._delete('/apps/' + _app + '/authProviders/' + authType + '/' + authName);\n                    },\n                    update: function update(data) {\n                      return _this8._post('/apps/' + _app + '/authProviders/' + authType + '/' + authName, data);\n                    }\n                  };\n                }\n              };\n            },\n            variables: function variables() {\n              return {\n                list: function list() {\n                  return _this8._get('/apps/' + _app + '/vars');\n                },\n                variable: function variable(varName) {\n                  return {\n                    get: function get() {\n                      return _this8._get('/apps/' + _app + '/vars/' + varName);\n                    },\n                    remove: function remove() {\n                      return _this8._delete('/apps/' + _app + '/vars/' + varName);\n                    },\n                    create: function create(data) {\n                      return _this8._post('/apps/' + _app + '/vars/' + varName, data);\n                    },\n                    update: function update(data) {\n                      return _this8._post('/apps/' + _app + '/vars/' + varName, data);\n                    }\n                  };\n                }\n              };\n            },\n            logs: function logs() {\n              return {\n                get: function get(filter) {\n                  return _this8._get('/apps/' + _app + '/logs', filter);\n                }\n              };\n            },\n            apiKeys: function apiKeys() {\n              return {\n                list: function list() {\n                  return _this8._get('/apps/' + _app + '/keys');\n                },\n                create: function create(data) {\n                  return _this8._post('/apps/' + _app + '/keys', data);\n                },\n                apiKey: function apiKey(key) {\n                  return {\n                    get: function get() {\n                      return _this8._get('/apps/' + _app + '/keys/' + key);\n                    },\n                    remove: function remove() {\n                      return _this8._delete('/apps/' + _app + '/keys/' + key);\n                    },\n                    enable: function enable() {\n                      return _this8._put('/apps/' + _app + '/keys/' + key + '/enable');\n                    },\n                    disable: function disable() {\n                      return _this8._put('/apps/' + _app + '/keys/' + key + '/disable');\n                    }\n                  };\n                }\n              };\n            },\n            services: function services() {\n              return {\n                list: function list() {\n                  return _this8._get('/apps/' + _app + '/services');\n                },\n                create: function create(data) {\n                  return _this8._post('/apps/' + _app + '/services', data);\n                },\n                service: function service(svc) {\n                  return {\n                    get: function get() {\n                      return _this8._get('/apps/' + _app + '/services/' + svc);\n                    },\n                    update: function update(data) {\n                      return _this8._post('/apps/' + _app + '/services/' + svc, data);\n                    },\n                    remove: function remove() {\n                      return _this8._delete('/apps/' + _app + '/services/' + svc);\n                    },\n                    setConfig: function setConfig(data) {\n                      return _this8._post('/apps/' + _app + '/services/' + svc + '/config', data);\n                    },\n\n                    rules: function rules() {\n                      return {\n                        list: function list() {\n                          return _this8._get('/apps/' + _app + '/services/' + svc + '/rules');\n                        },\n                        create: function create(data) {\n                          return _this8._post('/apps/' + _app + '/services/' + svc + '/rules');\n                        },\n                        rule: function rule(ruleId) {\n                          return {\n                            get: function get() {\n                              return _this8._get('/apps/' + _app + '/services/' + svc + '/rules/' + ruleId);\n                            },\n                            update: function update(data) {\n                              return _this8._post('/apps/' + _app + '/services/' + svc + '/rules/' + ruleId, data);\n                            },\n                            remove: function remove() {\n                              return _this8._delete('/apps/' + _app + '/services/' + svc + '/rules/' + ruleId);\n                            }\n                          };\n                        }\n                      };\n                    },\n\n                    triggers: function triggers() {\n                      return {\n                        list: function list() {\n                          return _this8._get('/apps/' + _app + '/services/' + svc + '/triggers');\n                        },\n                        create: function create(data) {\n                          return _this8._post('/apps/' + _app + '/services/' + svc + '/triggers');\n                        },\n                        trigger: function trigger(triggerId) {\n                          return {\n                            get: function get() {\n                              return _this8._get('/apps/' + _app + '/services/' + svc + '/triggers/' + triggerId);\n                            },\n                            update: function update(data) {\n                              return _this8._post('/apps/' + _app + '/services/' + svc + '/triggers/' + triggerId, data);\n                            },\n                            remove: function remove() {\n                              return _this8._delete('/apps/' + _app + '/services/' + svc + '/triggers/' + triggerId);\n                            }\n                          };\n                        }\n                      };\n                    }\n                  };\n                }\n              };\n            }\n          };\n        }\n      };\n    }\n  }, {\n    key: '_isImpersonatingUser',\n    value: function _isImpersonatingUser() {\n      return this.client.authManager.isImpersonatingUser();\n    }\n  }, {\n    key: '_startImpersonation',\n    value: function _startImpersonation(userId) {\n      return this.client.authManager.startImpersonation(this.client, userId);\n    }\n  }, {\n    key: '_stopImpersonation',\n    value: function _stopImpersonation(userId) {\n      return this.client.authManager.stopImpersonation();\n    }\n  }]);\n\n  return Admin;\n}();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./distribution/client.js\n// module id = 0\n// module chunks = 0 1","(function(self) {\n  'use strict';\n\n  if (self.fetch) {\n    return\n  }\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob: 'FileReader' in self && 'Blob' in self && (function() {\n      try {\n        new Blob()\n        return true\n      } catch(e) {\n        return false\n      }\n    })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ]\n\n    var isDataView = function(obj) {\n      return obj && DataView.prototype.isPrototypeOf(obj)\n    }\n\n    var isArrayBufferView = ArrayBuffer.isView || function(obj) {\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n    }\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name)\n    }\n    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value)\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift()\n        return {done: value === undefined, value: value}\n      }\n    }\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      }\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {}\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value)\n      }, this)\n\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name])\n      }, this)\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name)\n    value = normalizeValue(value)\n    var oldValue = this.map[name]\n    this.map[name] = oldValue ? oldValue+','+value : value\n  }\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)]\n  }\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name)\n    return this.has(name) ? this.map[name] : null\n  }\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  }\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value)\n  }\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this)\n      }\n    }\n  }\n\n  Headers.prototype.keys = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push(name) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.values = function() {\n    var items = []\n    this.forEach(function(value) { items.push(value) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.entries = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push([name, value]) })\n    return iteratorFor(items)\n  }\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result)\n      }\n      reader.onerror = function() {\n        reject(reader.error)\n      }\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsArrayBuffer(blob)\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader()\n    var promise = fileReaderReady(reader)\n    reader.readAsText(blob)\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf)\n    var chars = new Array(view.length)\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i])\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength)\n      view.set(new Uint8Array(buf))\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false\n\n    this._initBody = function(body) {\n      this._bodyInit = body\n      if (!body) {\n        this._bodyText = ''\n      } else if (typeof body === 'string') {\n        this._bodyText = body\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString()\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer)\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer])\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body)\n      } else {\n        throw new Error('unsupported BodyInit type')\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type)\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n        }\n      }\n    }\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      }\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      }\n    }\n\n    this.text = function() {\n      var rejected = consumed(this)\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    }\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      }\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    }\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase()\n    return (methods.indexOf(upcased) > -1) ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {}\n    var body = options.body\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url\n      this.credentials = input.credentials\n      if (!options.headers) {\n        this.headers = new Headers(input.headers)\n      }\n      this.method = input.method\n      this.mode = input.mode\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit\n        input.bodyUsed = true\n      }\n    } else {\n      this.url = String(input)\n    }\n\n    this.credentials = options.credentials || this.credentials || 'omit'\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers)\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET')\n    this.mode = options.mode || this.mode || null\n    this.referrer = null\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body)\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, { body: this._bodyInit })\n  }\n\n  function decode(body) {\n    var form = new FormData()\n    body.trim().split('&').forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers()\n    rawHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':')\n      var key = parts.shift().trim()\n      if (key) {\n        var value = parts.join(':').trim()\n        headers.append(key, value)\n      }\n    })\n    return headers\n  }\n\n  Body.call(Request.prototype)\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {}\n    }\n\n    this.type = 'default'\n    this.status = 'status' in options ? options.status : 200\n    this.ok = this.status >= 200 && this.status < 300\n    this.statusText = 'statusText' in options ? options.statusText : 'OK'\n    this.headers = new Headers(options.headers)\n    this.url = options.url || ''\n    this._initBody(bodyInit)\n  }\n\n  Body.call(Response.prototype)\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  }\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''})\n    response.type = 'error'\n    return response\n  }\n\n  var redirectStatuses = [301, 302, 303, 307, 308]\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  }\n\n  self.Headers = Headers\n  self.Request = Request\n  self.Response = Response\n\n  self.fetch = function(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init)\n      var xhr = new XMLHttpRequest()\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        }\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n        var body = 'response' in xhr ? xhr.response : xhr.responseText\n        resolve(new Response(body, options))\n      }\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.open(request.method, request.url, true)\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob'\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n    })\n  }\n  self.fetch.polyfill = true\n})(typeof self !== 'undefined' ? self : this);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/whatwg-fetch/fetch.js\n// module id = 1\n// module chunks = 0 1"],"sourceRoot":""}